<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>Hello World</title>
    <link href="/2021/03/08/hello-world/"/>
    <url>/2021/03/08/hello-world/</url>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo new <span class="hljs-string">&quot;My New Post&quot;</span><br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo server<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo generate<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo deploy<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p><p><img src="/2021/03/08/hello-world/image-20210308134551956.png" alt="主题Fluid"></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>Kali2.0中MSF无法启动问题解决方法</title>
    <link href="/2021/02/15/%E6%96%B0%E7%89%88Kali%E7%B3%BB%E7%BB%9FMSF%E6%97%A0%E6%B3%95%E5%90%AF%E5%8A%A8%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/"/>
    <url>/2021/02/15/%E6%96%B0%E7%89%88Kali%E7%B3%BB%E7%BB%9FMSF%E6%97%A0%E6%B3%95%E5%90%AF%E5%8A%A8%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/</url>
    
    <content type="html"><![CDATA[<h1 id="问题现象"><a href="#问题现象" class="headerlink" title="问题现象"></a>问题现象</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><br></code></pre></td></tr></table></figure><h1 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo gem install bundler:1.17.3<br>sudo gem update<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>杂记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>kali</tag>
      
      <tag>msf6</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>使用Git从上游更新fork的代码</title>
    <link href="/2021/01/25/%E4%BD%BF%E7%94%A8Git%E4%BB%8E%E4%B8%8A%E6%B8%B8%E6%9B%B4%E6%96%B0fork%E7%9A%84%E4%BB%A3%E7%A0%81/"/>
    <url>/2021/01/25/%E4%BD%BF%E7%94%A8Git%E4%BB%8E%E4%B8%8A%E6%B8%B8%E6%9B%B4%E6%96%B0fork%E7%9A%84%E4%BB%A3%E7%A0%81/</url>
    
    <content type="html"><![CDATA[<blockquote><p>原文：<a href="https://blog.csdn.net/jaywcjlove/article/details/80122684">https://blog.csdn.net/jaywcjlove/article/details/80122684</a></p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> 列出远程仓库 URL</span><br><span class="hljs-meta">$</span><span class="bash"> git remote -v</span><br><span class="hljs-meta">#</span><span class="bash"> List the current remotes （列出当前远程仓库）</span><br><span class="hljs-meta">#</span><span class="bash"> origin  https://github.com/user/repo.git (fetch)</span><br><span class="hljs-meta">#</span><span class="bash"> origin  https://github.com/user/repo.git (push)</span><br><br><span class="hljs-meta">#</span><span class="bash"> 添加上游仓库URL</span><br><span class="hljs-meta">$</span><span class="bash"> git remote add upstream https://github.com/otheruser/repo.git</span><br><span class="hljs-meta">#</span><span class="bash"> Set a new remote (设置一个新的远程仓库)</span><br><br><span class="hljs-meta">#</span><span class="bash"> 再次列出远程仓库 URL</span><br><span class="hljs-meta">$</span><span class="bash"> git remote -v</span><br><span class="hljs-meta">#</span><span class="bash"> Verify new remote (验证新的原唱仓库)</span><br><span class="hljs-meta">#</span><span class="bash"> origin    https://github.com/user/repo.git (fetch)</span><br><span class="hljs-meta">#</span><span class="bash"> origin    https://github.com/user/repo.git (push)</span><br><span class="hljs-meta">#</span><span class="bash"> upstream  https://github.com/otheruser/repo.git (fetch)</span><br><span class="hljs-meta">#</span><span class="bash"> upstream  https://github.com/otheruser/repo.git (push)</span><br><br><span class="hljs-meta">#</span><span class="bash"> 获取上游代码</span><br><span class="hljs-meta">$</span><span class="bash"> git fetch upstream</span><br><br><span class="hljs-meta">#</span><span class="bash"> 检查你的 fork’s 本地 master 分支，如果不在master 分支就切换到该分支</span><br><span class="hljs-meta">$</span><span class="bash"> git checkout master</span><br><span class="hljs-meta">#</span><span class="bash"> Switched to branch <span class="hljs-string">&#x27;master&#x27;</span></span><br><br><span class="hljs-meta">#</span><span class="bash"> 合并来自 upstream/master 的更改到本地 master 分支上。</span><br><span class="hljs-meta">$</span><span class="bash"> git merge upstream/master</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>杂记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>GitHub</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>tcpdump使用手册</title>
    <link href="/2021/01/07/tcpdump%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C/"/>
    <url>/2021/01/07/tcpdump%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C/</url>
    
    <content type="html"><![CDATA[<h1 id="一、tcpdump介绍"><a href="#一、tcpdump介绍" class="headerlink" title="一、tcpdump介绍"></a>一、tcpdump介绍</h1><p>tcpdump是一个强大的命令行数据包分析器。</p><blockquote><p>详细的使用帮助，请参考：man tcpdump<br>参考链接：<br><a href="https://www.tcpdump.org/tcpdump_man.html">https://www.tcpdump.org/tcpdump_man.html</a></p></blockquote><h1 id="二、查看tcpdump使用帮助"><a href="#二、查看tcpdump使用帮助" class="headerlink" title="二、查看tcpdump使用帮助"></a>二、查看tcpdump使用帮助</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs shell">kali@kali:~$ tcpdump --help<br>tcpdump version 4.9.3<br>libpcap version 1.9.1 (with TPACKET_V3)<br>OpenSSL 1.1.1h  22 Sep 2020<br>Usage: tcpdump [-aAbdDefhHIJKlLnNOpqStuUvxX#] [ -B size ] [ -c count ]<br>                [ -C file_size ] [ -E algo:secret ] [ -F file ] [ -G seconds ]<br>                [ -i interface ] [ -j tstamptype ] [ -M secret ] [ --number ]<br>                [ -Q in|out|inout ]<br>                [ -r file ] [ -s snaplen ] [ --time-stamp-precision precision ]<br>                [ --immediate-mode ] [ -T type ] [ --version ] [ -V file ]<br>                [ -w file ] [ -W filecount ] [ -y datalinktype ] [ -z postrotate-command ]<br>                [ -Z user ] [ expression ]<br></code></pre></td></tr></table></figure><h1 id="三、选项解释"><a href="#三、选项解释" class="headerlink" title="三、选项解释"></a>三、选项解释</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs shell">-a    尝试将网络和广播地址转换成名称；<br>-c    &lt;数据包数目&gt;：收到指定的数据包数目后，就停止进行倾倒操作；<br>-d    把编译过的数据包编码转换成可阅读的格式，并倾倒到标准输出；<br>-dd   把编译过的数据包编码转换成C语言的格式，并倾倒到标准输出；<br>-ddd  把编译过的数据包编码转换成十进制数字的格式，并倾倒到标准输出；<br>-e    在每列倾倒资料上显示连接层级的文件头；<br>-f    用数字显示网际网络地址；<br>-F    &lt;表达文件&gt;：指定内含表达方式的文件；<br>-i    &lt;网络接口&gt;：使用指定的网络接口监听数据包；<br>-l    使用标准输出列的缓冲区；<br>-n    不把主机的网络地址转换成名字；<br>-N    不列出域名；<br>-O    不将数据包编码最佳化；<br>-p    不让网络界面进入混杂模式；<br>-q    快速输出，仅列出少数的传输协议信息；<br>-r    &lt;数据包文件&gt;：从指定的文件读取数据包数据；<br>-s    &lt;数据包大小&gt;：设置每个数据包的大小；<br>-S    用绝对而非相对数值列出TCP关联数；<br>-t    在每列倾倒资料上不显示时间戳记；<br>-tt   在每列倾倒资料上显示未经格式化的时间戳记；<br>-T    &lt;数据包类型&gt;：强制将表达方式所指定的数据包转译成设置的数据包类型；<br>-v    详细显示指令执行过程；<br>-vv   更详细显示指令执行过程；<br>-x    用十六进制字码列出数据包资料；<br>-w    &lt;数据包文件&gt;：把数据包数据写入指定的文件。<br></code></pre></td></tr></table></figure><h1 id="四、基本用法"><a href="#四、基本用法" class="headerlink" title="四、基本用法"></a>四、基本用法</h1><h2 id="4-1、启动tcpdump"><a href="#4-1、启动tcpdump" class="headerlink" title="4.1、启动tcpdump"></a>4.1、启动tcpdump</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@localhost ~]# tcpdump<br>tcpdump: verbose output suppressed, use -v or -vv for full protocol decode<br>listening on bluetooth0, link-type BLUETOOTH_HCI_H4_WITH_PHDR (Bluetooth HCI UART transport layer plus pseudo-header), capture size 262144 bytes<br></code></pre></td></tr></table></figure><blockquote><p>注意：tcpdump默认在系统接口列表中搜索编号最小的接口，配置为监听接口（不包括环回接口）</p></blockquote><h2 id="4-2、使用参数-i-指定监听接口"><a href="#4-2、使用参数-i-指定监听接口" class="headerlink" title="4.2、使用参数 -i 指定监听接口"></a>4.2、使用参数 -i 指定监听接口</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@localhost ~]# tcpdump -i ens33<br>tcpdump: verbose output suppressed, use -v or -vv for full protocol decode<br>listening on ens33, link-type EN10MB (Ethernet), capture size 262144 bytes<br></code></pre></td></tr></table></figure><h2 id="4-3、输出格式"><a href="#4-3、输出格式" class="headerlink" title="4.3、输出格式"></a>4.3、输出格式</h2><blockquote><p>tcpdump的输出取决于协议。以下给出了大多数格式的简要说明和示例。</p></blockquote><h3 id="4-3-1、时间戳-Timestamps"><a href="#4-3-1、时间戳-Timestamps" class="headerlink" title="4.3.1、时间戳-Timestamps"></a>4.3.1、时间戳-Timestamps</h3><p>默认情况下，所有输出行均带有时间戳。时间戳是当前时钟时间，格式为</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">hh:mm:ss.frac<br></code></pre></td></tr></table></figure><h3 id="4-3-2、链路层报头-Link-Level-Headers"><a href="#4-3-2、链路层报头-Link-Level-Headers" class="headerlink" title="4.3.2、链路层报头-Link Level Headers"></a>4.3.2、链路层报头-Link Level Headers</h3><p>如果给出’-e’选项，则打印出链路层报头。在以太网上，将打印源地址、目标地址、协议和数据包长度。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@localhost ~]# tcpdump -v -i ens33 -e arp<br>tcpdump: listening on ens33, link-type EN10MB (Ethernet), capture size 262144 bytes<br>22:23:49.349007 5c:27:d4:5c:fa:86 (oui Unknown) &gt; Broadcast, ethertype ARP (0x0806), length 60: Ethernet (len 6), IPv4 (len 4), Request who-has Openwrt.lan (Broadcast) tell Openwrt.lan, length 46<br>22:23:50.270604 5c:27:d4:5c:fa:86 (oui Unknown) &gt; Broadcast, ethertype ARP (0x0806), length 60: Ethernet (len 6), IPv4 (len 4), Request who-has Openwrt.lan (Broadcast) tell Openwrt.lan, length 46<br>22:23:51.294783 5c:27:d4:5c:fa:86 (oui Unknown) &gt; Broadcast, ethertype ARP (0x0806), length 60: Ethernet (len 6), IPv4 (len 4), Request who-has Openwrt.lan (Broadcast) tell Openwrt.lan, length 46<br>22:23:52.318585 5c:27:d4:5c:fa:86 (oui Unknown) &gt; Broadcast, ethertype ARP (0x0806), length 60: Ethernet (len 6), IPv4 (len 4), Request who-has Openwrt.lan (Broadcast) tell Openwrt.lan, length 46<br>22:23:53.342593 5c:27:d4:5c:fa:86 (oui Unknown) &gt; Broadcast, ethertype ARP (0x0806), length 60: Ethernet (len 6), IPv4 (len 4), Request who-has Openwrt.lan (Broadcast) tell Openwrt.lan, length 46<br></code></pre></td></tr></table></figure><h3 id="4-3-3、ARP-RARP-数据报文"><a href="#4-3-3、ARP-RARP-数据报文" class="headerlink" title="4.3.3、ARP/RARP 数据报文"></a>4.3.3、ARP/RARP 数据报文</h3><p>ARP/RARP: 输出显示请求的类型及其参数。该格式旨在进行自我说明。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> 这是从主机rtsg到主机csam的`rlogin<span class="hljs-string">&#x27;开头的简短示例：</span></span><br><span class="hljs-meta">#</span><span class="bash"> arp who-has csam tell rtsg</span><br><span class="hljs-meta">#</span><span class="bash"> arp reply csam is-at CSAM</span><br><br>[root@localhost ~]# tcpdump -v -i ens33 arp<br>tcpdump: listening on ens33, link-type EN10MB (Ethernet), capture size 262144 bytes<br>22:25:29.498307 ARP, Ethernet (len 6), IPv4 (len 4), Request who-has Openwrt.lan (Broadcast) tell Openwrt.lan, length 46<br>22:25:44.548996 ARP, Ethernet (len 6), IPv4 (len 4), Request who-has Openwrt.lan (Broadcast) tell Openwrt.lan, length 46<br>22:25:45.573203 ARP, Ethernet (len 6), IPv4 (len 4), Request who-has Openwrt.lan (Broadcast) tell Openwrt.lan, length 46<br>22:25:46.034715 ARP, Ethernet (len 6), IPv4 (len 4), Request who-has kali.lan tell Openwrt.lan, length 46<br>22:25:46.034736 ARP, Ethernet (len 6), IPv4 (len 4), Reply kali.lan is-at 00:0c:29:c6:cf:e2 (oui Unknown), length 46<br>22:25:49.566781 ARP, Ethernet (len 6), IPv4 (len 4), Request who-has Openwrt.lan (Broadcast) tell Openwrt.lan, length 46<br>22:25:49.750414 ARP, Ethernet (len 6), IPv4 (len 4), Request who-has localhost.localdomain tell kali.lan, length 46<br></code></pre></td></tr></table></figure><h3 id="4-3-4、IPv4-数据报文"><a href="#4-3-4、IPv4-数据报文" class="headerlink" title="4.3.4、IPv4 数据报文"></a>4.3.4、IPv4 数据报文</h3><p>如果未给出’-e’选项打印链路层报头，则对于IPv4数据包，将在时间戳之后打印IP。<br>如果指定了**’-v’**标志，则来自IPV4头的信息将显示在IP或链路层头之后的括号中。该信息的一般格式为：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">tos tos, ttl ttl, id id, offset offset, flags [flags], proto proto, length length, options (options)<br></code></pre></td></tr></table></figure><p>Next，对于TCP和UDP数据包，将打印源IP地址和目标IP地址及其对应监听端口，两者之间以点号’.’分隔，并用’&gt;’分隔源地址和目标地址。对于其他协议，将打印地址，并用&gt;分隔源地址和目标地址。此后将打印更高级别的协议信息（如果有）。</p><h3 id="4-3-5、TCP-数据报文"><a href="#4-3-5、TCP-数据报文" class="headerlink" title="4.3.5、TCP 数据报文"></a>4.3.5、TCP 数据报文</h3><p>TCP协议行的一般格式为：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs shell">src &gt; dst: Flags [tcpflags], seq data-seqno, ack ackno, win window, urg urgent, options [opts], length len<br><br><span class="hljs-meta">#</span><span class="bash"> Tcpflags are some combination of S (SYN), F (FIN), P (PUSH), R (RST), U (URG), W (ECN CWR), E (ECN-Echo) or `.<span class="hljs-string">&#x27; (ACK), or `none&#x27;</span> <span class="hljs-keyword">if</span> no flags are <span class="hljs-built_in">set</span>.</span><br><span class="hljs-meta">#</span><span class="bash"> iptype，src，dst和flags始终存在。其他字段取决于数据包的TCP协议报头的内容，仅在适当时才输出。</span><br><br><span class="hljs-meta">#</span><span class="bash">例如</span><br>[root@localhost ~]# tcpdump -i ens33 tcp and not port 22<br>tcpdump: verbose output suppressed, use -v or -vv for full protocol decode<br>listening on ens33, link-type EN10MB (Ethernet), capture size 262144 bytes<br>23:44:04.915024 IP kali.lan.60182 &gt; server-13-35-125-18.sfo5.r.cloudfront.net.https: Flags [.], ack 4229599765, win 501, options [nop,nop,TS val 2703981067 ecr 2338591303], length 0<br>23:44:05.099218 IP server-13-35-125-18.sfo5.r.cloudfront.net.https &gt; kali.lan.60182: Flags [.], ack 1, win 265, options [nop,nop,TS val 2338601543 ecr 2703886928], length 0<br>23:44:15.153260 IP kali.lan.60182 &gt; server-13-35-125-18.sfo5.r.cloudfront.net.https: Flags [.], ack 1, win 501, options [nop,nop,TS val 2703991305 ecr 2338601543], length 0<br>23:44:15.339531 IP server-13-35-125-18.sfo5.r.cloudfront.net.https &gt; kali.lan.60182: Flags [.], ack 1, win 265, options [nop,nop,TS val 2338611784 ecr 2703886928], length 0<br></code></pre></td></tr></table></figure><h3 id="4-3-6、UDP-数据报文"><a href="#4-3-6、UDP-数据报文" class="headerlink" title="4.3.6、UDP 数据报文"></a>4.3.6、UDP 数据报文</h3><p>此rwho数据报文说明了UDP格式：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> 这表示主机actinide上的端口向主机broadcast上的端口（Internet广播地址）发送了UDP数据报。该数据报文包含84字节的用户数据。</span><br><span class="hljs-meta">#</span><span class="bash"> actinide.who &gt; broadcast.who: udp 84</span><br><br><span class="hljs-meta">#</span><span class="bash"> UDP Name Server Requests</span><br><span class="hljs-meta">#</span><span class="bash"> Name server requests are formatted as</span><br><span class="hljs-meta">#</span><span class="bash"> src &gt; dst: id op? flags qtype qclass name (len)</span><br><br>h2opolo.1538 &gt; helios.domain: 3+ A? ucbvax.berkeley.edu. (37)<br><span class="hljs-meta">#</span><span class="bash"> Host h2opolo asked the domain server on helios <span class="hljs-keyword">for</span> an address record (qtype=A) associated with the name ucbvax.berkeley.edu.</span><br><span class="hljs-meta">#</span><span class="bash"> The query id was `3<span class="hljs-string">&#x27;. The `+&#x27;</span> indicates the recursion desired flag was <span class="hljs-built_in">set</span>. The query length was 37 bytes, not including the UDP and IP protocol headers.</span><br><span class="hljs-meta">#</span><span class="bash"> The query operation was the normal one, Query, so the op field was omitted. If the op had been anything <span class="hljs-keyword">else</span>, it would have been printed between the `3<span class="hljs-string">&#x27; and the `+&#x27;</span>.</span><br><span class="hljs-meta">#</span><span class="bash"> Similarly, the qclass was the normal one, C_IN, and omitted. Any other qclass would have been printed immediately after the `A<span class="hljs-string">&#x27;.</span></span><br><br><span class="hljs-meta">#</span><span class="bash"> UDP Name Server Responses</span><br><span class="hljs-meta">#</span><span class="bash"> Name server responses are formatted as</span><br><span class="hljs-meta">#</span><span class="bash"> src &gt; dst:  id op rcode flags a/n/au <span class="hljs-built_in">type</span> class data (len)</span><br><br>helios.domain &gt; h2opolo.1538: 3 3/3/7 A 128.32.137.3 (273)<br>helios.domain &gt; h2opolo.1537: 2 NXDomain* 0/1/0 (97)<br><span class="hljs-meta">#</span><span class="bash"> In the first example, helios responds to query id 3 from h2opolo with 3 answer records, 3 name server records and 7 additional records.</span><br><span class="hljs-meta">#</span><span class="bash"> The first answer record is <span class="hljs-built_in">type</span> A (address) and its data is internet address 128.32.137.3. The total size of the response was 273 bytes, excluding UDP and IP headers. The op (Query) and response code (NoError) were omitted, as was the class (C_IN) of the A record.</span><br><span class="hljs-meta">#</span><br><span class="bash"><span class="hljs-comment"># In the second example, helios responds to query 2 with a response code of non-existent domain (NXDomain) with no answers, one name server and no authority records.</span></span><br><span class="hljs-meta">#</span><span class="bash"> The `*<span class="hljs-string">&#x27; indicates that the authoritative answer bit was set. Since there were no answers, no type, class or data were printed.</span></span><br></code></pre></td></tr></table></figure><h3 id="4-3-7、SMB-CIFS-解码"><a href="#4-3-7、SMB-CIFS-解码" class="headerlink" title="4.3.7、SMB/CIFS 解码"></a>4.3.7、SMB/CIFS 解码</h3><p>tcpdump现在用于UDP/137，UDP/138和TCP/139上的SMB/CIFS/NBT解码相当广泛。还完成了IPX和NetBEUI SMB 数据的一些原始解码。<br>缺省情况下，会完成相当少的解码，而如果使用-v，则会完成更详细的解码。请注意，使用-v时，单个SMB数据包可能会占用一页或更多页，因此，请仅在您确实想要所有详细信息时使用-v。</p><h3 id="4-3-8、NFS请求和答复"><a href="#4-3-8、NFS请求和答复" class="headerlink" title="4.3.8、NFS请求和答复"></a>4.3.8、NFS请求和答复</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> Sun NFS (Network File System) requests and replies are printed as:</span><br>src.sport &gt; dst.nfs: NFS request xid xid len op args<br>src.nfs &gt; dst.dport: NFS reply xid xid reply stat len op results<br><br><br>sushi.1023 &gt; wrl.nfs: NFS request xid 26377<br>        112 readlink fh 21,24/10.73165<br>wrl.nfs &gt; sushi.1023: NFS reply xid 26377<br>        reply ok 40 readlink &quot;../var&quot;<br>sushi.1022 &gt; wrl.nfs: NFS request xid 8219<br>        144 lookup fh 9,74/4096.6878 &quot;xcolors&quot;<br>wrl.nfs &gt; sushi.1022: NFS reply xid 8219<br>        reply ok 128 lookup fh 9,74/4134.3150<br><br><span class="hljs-meta">#</span><span class="bash"> In the first line, host sushi sends a transaction with id 26377 to wrl. The request was 112 bytes, excluding the UDP and IP headers. The operation was a readlink (<span class="hljs-built_in">read</span> symbolic link) on file handle (fh) 21,24/10.731657119. (If one is lucky, as <span class="hljs-keyword">in</span> this <span class="hljs-keyword">case</span>, the file handle can be interpreted as a major,minor device number pair, followed by the inode number and generation number.) In the second line, wrl replies `ok<span class="hljs-string">&#x27; with the same transaction id and the contents of the link.</span></span><br><span class="hljs-meta">#</span><span class="bash"> In the third line, sushi asks (using a new transaction id) wrl to lookup the name `xcolors<span class="hljs-string">&#x27; in directory file 9,74/4096.6878. In the fourth line, wrl sends a reply with the respective transaction id.</span></span><br><span class="hljs-meta">#</span><br><span class="bash"><span class="hljs-comment"># Note that the data printed depends on the operation type. The format is intended to be self explanatory if read in conjunction with an NFS protocol spec. Also note that older versions of tcpdump printed NFS packets in a slightly different format: the transaction id (xid) would be printed instead of the non-NFS port number of the packet.</span></span><br></code></pre></td></tr></table></figure><h2 id="4-4、基本过滤"><a href="#4-4、基本过滤" class="headerlink" title="4.4、基本过滤"></a>4.4、基本过滤</h2><h3 id="4-4-1、过滤主机-host"><a href="#4-4-1、过滤主机-host" class="headerlink" title="4.4.1、过滤主机( host )"></a>4.4.1、过滤主机( host )</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@localhost ~]# tcpdump -i ens33 host 192.168.0.230<br>tcpdump: verbose output suppressed, use -v or -vv for full protocol decode<br>listening on ens33, link-type EN10MB (Ethernet), capture size 262144 bytes<br>23:32:23.114358 IP kali.lan.44270 &gt; localhost.localdomain.ssh: Flags [.], ack 580444, win 9920, options [nop,nop,TS val 1498569367 ecr 4232902], length 0<br>23:32:23.114381 IP localhost.localdomain.ssh &gt; kali.lan.44270: Flags [P.], seq 580808:581020, ack 361, win 273, options [nop,nop,TS val 4232904 ecr 1498569367], length 212<br>23:32:23.114632 IP localhost.localdomain.ssh &gt; kali.lan.44270: Flags [P.], seq 581020:581384, ack 361, win 273, options [nop,nop,TS val 4232905 ecr 1498569367], length 364<br>23:32:23.114922 IP kali.lan.44270 &gt; localhost.localdomain.ssh: Flags [.], ack 581020, win 9920, options [nop,nop,TS val 1498569368 ecr 4232904], length 0<br></code></pre></td></tr></table></figure><h3 id="4-4-2、过滤端口-port"><a href="#4-4-2、过滤端口-port" class="headerlink" title="4.4.2、过滤端口( port )"></a>4.4.2、过滤端口( port )</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@localhost ~]# tcpdump -v -i ens33 port 22<br>tcpdump: listening on ens33, link-type EN10MB (Ethernet), capture size 262144 bytes<br>01:55:29.873446 IP (tos 0x10, ttl 64, id 64224, offset 0, flags [DF], proto TCP (6), length 904)<br>    localhost.localdomain.ssh &gt; kali.lan.44270: Flags [P.], cksum 0x867a (incorrect -&gt; 0x7994), seq 547632:548484, ack 361, win 273, options [nop,nop,TS val 12819663 ecr 1507156330], length 852<br>01:55:29.876962 IP (tos 0x10, ttl 64, id 64225, offset 0, flags [DF], proto TCP (6), length 384)<br>    localhost.localdomain.ssh &gt; kali.lan.44270: Flags [P.], cksum 0x8472 (incorrect -&gt; 0xae09), seq 548484:548816, ack 361, win 273, options [nop,nop,TS val 12819667 ecr 1507156330], length 332<br>01:55:29.880858 IP (tos 0x10, ttl 64, id 64226, offset 0, flags [DF], proto TCP (6), length 384)<br>    localhost.localdomain.ssh &gt; kali.lan.44270: Flags [P.], cksum 0x8472 (incorrect -&gt; 0x3783), seq 548816:549148, ack 361, win 273, options [nop,nop,TS val 12819671 ecr 1507156330], length 332<br></code></pre></td></tr></table></figure><h3 id="4-4-3、源区域-src"><a href="#4-4-3、源区域-src" class="headerlink" title="4.4.3、源区域( src )"></a>4.4.3、源区域( src )</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> 过滤源端口：src port 22</span><br>[root@localhost ~]# tcpdump -v -i ens33 src port 22<br><br><span class="hljs-meta">#</span><span class="bash"> 过滤源主机：src host 192.168.0.230</span><br>[root@localhost ~]# tcpdump -v -i ens33 src host 192.168.0.230<br><br></code></pre></td></tr></table></figure><h3 id="4-4-4、目标区域-dst"><a href="#4-4-4、目标区域-dst" class="headerlink" title="4.4.4、目标区域( dst )"></a>4.4.4、目标区域( dst )</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> 过滤源端口：dst port 22</span><br>[root@localhost ~]# tcpdump -v -i ens33 dst port 22<br><br><span class="hljs-meta">#</span><span class="bash"> 过滤源主机：dst host 192.168.0.230</span><br>[root@localhost ~]# tcpdump -v -i ens33 dst host 192.168.0.230<br><br></code></pre></td></tr></table></figure><h3 id="4-4-5、逻辑操作符"><a href="#4-4-5、逻辑操作符" class="headerlink" title="4.4.5、逻辑操作符"></a>4.4.5、逻辑操作符</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell">and<br>or<br>not<br><br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">####################################3</span></span><br>||<br>&amp;&amp;<br>!<br></code></pre></td></tr></table></figure><h3 id="4-4-6、网络过滤"><a href="#4-4-6、网络过滤" class="headerlink" title="4.4.6、网络过滤"></a>4.4.6、网络过滤</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">tcpdump -v -i ens33 net 192.168<br>tcpdump -v -i ens33 src net 192.168<br>tcpdump -v -i ens33 dst net 192.168<br></code></pre></td></tr></table></figure><h3 id="4-4-7、协议过滤"><a href="#4-4-7、协议过滤" class="headerlink" title="4.4.7、协议过滤"></a>4.4.7、协议过滤</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">tcpdump -v -i ens33 arp<br>tcpdump -v -i ens33 ip<br>tcpdump -v -i ens33 tcp<br>tcpdump -v -i ens33 udp<br>tcpdump -v -i ens33 icmp<br></code></pre></td></tr></table></figure><h3 id="4-4-8、MAC地址过滤"><a href="#4-4-8、MAC地址过滤" class="headerlink" title="4.4.8、MAC地址过滤"></a>4.4.8、MAC地址过滤</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> 抓取目标MAC地址是00:01:02:03:04:05的ICMP数据</span><br>tcpdump -v -i ens33 &#x27;((icmp) and ((ether dst host 00:01:02:03:04:05)))&#x27;<br></code></pre></td></tr></table></figure><h3 id="4-4-9、常用过滤表达式"><a href="#4-4-9、常用过滤表达式" class="headerlink" title="4.4.9、常用过滤表达式"></a>4.4.9、常用过滤表达式</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> 1、抓取目的地址是192.168.1.254或192.168.1.200，端口是80的TCP数据</span><br>&#x27;((tcp) and (port 80) and ((dst host 192.168.1.254) or (dst host 192.168.1.200)))&#x27;<br><span class="hljs-meta">#</span><span class="bash"> 2、抓取目的网络是192.168，但目的主机不是192.168.1.200的TCP数据</span><br>&#x27;((tcp) and ((dst net 192.168) and (not dst host 192.168.1.200)))&#x27;<br><span class="hljs-meta">#</span><span class="bash"> 3、抓取所有源或目的端口是80, 网络层协议为IPv4, 并且含有数据,而不是SYN,FIN以及ACK-only等不含数据的数据包.</span><br>&#x27;tcp port 80 and (((ip[2:2] - ((ip[0]&amp;0xf)&lt;&lt;2)) - ((tcp[12]&amp;0xf0)&gt;&gt;2)) != 0)&#x27;<br></code></pre></td></tr></table></figure><h1 id="五、高级用法"><a href="#五、高级用法" class="headerlink" title="五、高级用法"></a>五、高级用法</h1><h2 id="5-1、过滤包头"><a href="#5-1、过滤包头" class="headerlink" title="5.1、过滤包头"></a>5.1、过滤包头</h2><h3 id="5-1-1、表达式：proto-x-y"><a href="#5-1-1、表达式：proto-x-y" class="headerlink" title="5.1.1、表达式：proto[x:y]"></a>5.1.1、表达式：proto[x:y]</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> proto 代表对应协议，如：ICMP, IP, TCP, UDP 等</span><br>proto[x:y]          : 过滤从x字节开始的y字节数。比如ip[2:2]过滤出3、4字节（第一字节从0开始排）<br>proto[x:y] &amp; z = 0  : proto[x:y]和z的与操作为0<br>proto[x:y] &amp; z !=0  : proto[x:y]和z的与操作不为0<br>proto[x:y] &amp; z = z  : proto[x:y]和z的与操作为z<br>proto[x:y] = z      : proto[x:y]等于z<br></code></pre></td></tr></table></figure><h3 id="5-1-2、比较操作符"><a href="#5-1-2、比较操作符" class="headerlink" title="5.1.2、比较操作符"></a>5.1.2、比较操作符</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">&gt;</span><span class="bash">  : greater 大于</span><br>&lt;  : lower 小于<br><span class="hljs-meta">&gt;</span><span class="bash">= : greater or equal 大于或者等于</span><br>&lt;= : lower or equal 小于或者等于<br>=  : equal  等于<br>!= : different  不等于<br></code></pre></td></tr></table></figure><h3 id="5-1-3、位操作方式判断是否带有选项"><a href="#5-1-3、位操作方式判断是否带有选项" class="headerlink" title="5.1.3、位操作方式判断是否带有选项"></a>5.1.3、位操作方式判断是否带有选项</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> “一般”的IP头是20字节，但IP头有选项设置，不能直接从偏移21字节处读取数据。</span><br><span class="hljs-meta">#</span><span class="bash"> IP头有个长度字段可以知道头长度是否大于20字节。</span><br><span class="hljs-meta">#</span><span class="bash"> 通常第一个字节的二进制值是：01000101，分成两个部分：</span><br><span class="hljs-meta">#</span><span class="bash"> 0100 = 4 表示IP版本、0101 = 5 表示IP头32 bit的块数，5 x 32 bits = 160 bits or 20 bytes</span><br><span class="hljs-meta">#</span><span class="bash"> 如果第一字节第二部分的值大于5，那么表示头有IP选项。</span><br><span class="hljs-meta">#</span><br><span class="bash">0100 0101 : 第一字节的二进制</span><br>0000 1111 : 与操作<br>&lt;=========<br>0000 0101 : 结果<br>正确的过滤方法<br>tcpdump  &#x27;ip[0] &amp; 15 &gt; 5&#x27;<br>或者<br>tcpdump  &#x27;ip[0] &amp; 0x0f &gt; 5&#x27;<br><br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">############################################################</span></span><br>tcpdump 提供了常用的字段偏移名字：<br>icmptype (ICMP类型字段)<br>icmpcode (ICMP符号字段)<br>tcpflags (TCP标记字段)<br><br>ICMP类型值有：<br>icmp-echoreply, icmp-unreach, icmp-sourcequench, icmp-redirect, icmp-echo, icmp-routeradvert, icmp-routersolicit,<br>icmp-timxceed, icmp-paramprob, icmp-tstamp, icmp-tstampreply, icmp-ireq, icmp-ireqreply, icmp-maskreq, icmp-maskreply<br></code></pre></td></tr></table></figure><h3 id="5-1-4、使用特定标志组合捕获TCP数据包（SYN-ACK，URG-ACK等）"><a href="#5-1-4、使用特定标志组合捕获TCP数据包（SYN-ACK，URG-ACK等）" class="headerlink" title="5.1.4、使用特定标志组合捕获TCP数据包（SYN-ACK，URG-ACK等）"></a>5.1.4、使用特定标志组合捕获TCP数据包（SYN-ACK，URG-ACK等）</h3><p>TCP报头的控制位部分有8位：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">CWR | ECE | URG | ACK | PSH | RST | SYN | FIN<br></code></pre></td></tr></table></figure><h3 id="5-1-x、用法示例"><a href="#5-1-x、用法示例" class="headerlink" title="5.1.x、用法示例"></a>5.1.x、用法示例</h3><h4 id="抓取-SYN-ACK-（00010010-or-18）"><a href="#抓取-SYN-ACK-（00010010-or-18）" class="headerlink" title="抓取 SYN,ACK （00010010 or 18）"></a>抓取 SYN,ACK （00010010 or 18）</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@localhost ~]# tcpdump -v -i ens33  tcp[13]=18<br>tcpdump: listening on ens33, link-type EN10MB (Ethernet), capture size 262144 bytes<br>00:00:24.146671 IP (tos 0x0, ttl 64, id 0, offset 0, flags [DF], proto TCP (6), length 44)<br>    localhost.localdomain.ssh &gt; kali.lan.58165: Flags [S.], cksum 0x831e (incorrect -&gt; 0x294c), seq 203667921, ack 1948998734, win 29200, options [mss 1460], length 0<br>00:00:28.131325 IP (tos 0x0, ttl 64, id 0, offset 0, flags [DF], proto TCP (6), length 60)<br>    localhost.localdomain.ssh &gt; kali.lan.44360: Flags [S.], cksum 0x832e (incorrect -&gt; 0x7c1c), seq 4009200598, ack 2255974799, win 28960, options [mss 1460,sackOK,TS val 5917921 ecr 1500254424,nop,wscale 7], length 0<br>00:00:28.252954 IP (tos 0x0, ttl 64, id 0, offset 0, flags [DF], proto TCP (6), length 60)<br>    localhost.localdomain.ssh &gt; kali.lan.63739: Flags [S.], cksum 0x832e (incorrect -&gt; 0x67df), seq 2689813142, ack 513645474, win 28960, options [mss 1460,sackOK,TS val 5918043 ecr 4294967295,nop,wscale 7], length 0<br></code></pre></td></tr></table></figure><hr><blockquote><p><strong>参考文章</strong>：<br><a href="https://www.cnblogs.com/jiujuan/p/9017495.html">https://www.cnblogs.com/jiujuan/p/9017495.html</a><br><a href="https://blog.csdn.net/m0_37710388/article/details/89400302">https://blog.csdn.net/m0_37710388/article/details/89400302</a><br><a href="https://www.tcpdump.org/tcpdump_man.html">https://www.tcpdump.org/tcpdump_man.html</a></p></blockquote>]]></content>
    
    
    <categories>
      
      <category>杂记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>tcpdump</tag>
      
      <tag>抓包</tag>
      
      <tag>记录</tag>
      
      <tag>网络分析</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>七、报告输出</title>
    <link href="/2020/12/29/%E4%B8%83%E3%80%81%E6%8A%A5%E5%91%8A%E8%BE%93%E5%87%BA/"/>
    <url>/2020/12/29/%E4%B8%83%E3%80%81%E6%8A%A5%E5%91%8A%E8%BE%93%E5%87%BA/</url>
    
    <content type="html"><![CDATA[<h1 id="报告输出"><a href="#报告输出" class="headerlink" title="报告输出"></a>报告输出</h1><h1 id="0x00-综述"><a href="#0x00-综述" class="headerlink" title="0x00 综述"></a>0x00 综述</h1><p>本文档旨在定义渗透测试报告的基本标准。强烈建议您使用自己的自定义和品牌格式，但以下内容应提供对报告中所需项目的高级理解，以及为读者提供有价值的报告结构。</p><h1 id="0x01-报告结构"><a href="#0x01-报告结构" class="headerlink" title="0x01 报告结构"></a>0x01 报告结构</h1><p>该报告分为两个主要部分，以便向不同的受众传达测试的目标，方法和结果。</p><h1 id="0x02-执行摘要"><a href="#0x02-执行摘要" class="headerlink" title="0x02 执行摘要"></a>0x02 执行摘要</h1><p>本部分将向读者传达渗透测试的具体目标和测试训练的高级发现(the high level findings of the testing exercise)。目标受众是负责安全计划的监督和战略构想的人员，以及可能受到已识别或已确认的威胁影响的组织中的任何成员。执行摘要应包含以下大部分（如果不是全部的话）：</p><h2 id="0x0200-背景"><a href="#0x0200-背景" class="headerlink" title="0x0200 背景:"></a>0x0200 <strong>背景:</strong></h2><p>The background section should explain to the reader the overall purpose of the test. Details on the terms identified within the Pre Engagement section relating to risk, countermeasures, and testing goals should be present to connect the reader to the overall test objectives and the relative results.</p><p>(Example: (CLIENT) tasked <Pentester> with performing an internal/external vulnerability assessment and penetration testing of specific systems located in (logical area or physical location). These systems have been identified as (risk ranking) and contain (data classification level) data which, if accessed inappropriately, could cause material harm to (Client). In an effort to test (CLIENT’s) ability to defend against direct and indirect attack, <Pentester> executed a comprehensive network vulnerability scan, Vulnerability conformation( &lt;-insert attack types agreed upon-&gt;) exploitation of weakened services, client side attacks, browser side attacks (etc) The purpose of this assessment was to verify the effectiveness of the security controls put in place by (CLIENT) to secure business-critical information. This report represents the findings from the assessment and the associated remediation recommendations to help CLIENT strengthen its security posture.</Pentester></Pentester></p><ul><li>If objectives were changed during the course of the testing then all changes must be listed in this section of the report. Additionally, the letter of amendment should be included in the appendix of the report and linked to from this section.</li></ul><h2 id="0x0201-Overall-Posture"><a href="#0x0201-Overall-Posture" class="headerlink" title="0x0201 Overall Posture:"></a>0x0201 <strong>Overall Posture:</strong></h2><p>该领域将描述测试的整体有效性以及渗透测试者实现参与前会议中设定的目标的能力。测试过程中发现的系统性问题(ex. Systemic issue= Lacking Effective Patch Management Process vs. Symptomatic= Found MS08-067 missing on xyz box) 的简要说明以及实现对目标信息的访问和识别的能力对业务的潜在影响。</p><h2 id="0x0202-Risk-Ranking-Profile"><a href="#0x0202-Risk-Ranking-Profile" class="headerlink" title="0x0202 Risk Ranking/Profile:"></a>0x0202 <strong>Risk Ranking/Profile:</strong></h2><p>The overall risk ranking/profile/score will be identified and explained in this area. In the pre engagement section the Pentester will identify the scoring mechanism and the individual mechanism for tracking/grading risk. Various methods from FAIR, DREAD, and other custom rankings will be consolidated into environmental scores and defined.</p><p><img src="/2020/12/29/%E4%B8%83%E3%80%81%E6%8A%A5%E5%91%8A%E8%BE%93%E5%87%BA/Reporting-risk-scale.png" alt="Reporting-risk-scale.png"></p><p>The “Overall Risk Score” for the (CLIENT) is currently a Seven (7). This rating implies an ELEVATED risk of security controls being compromised with the potential for material financial losses. The consultant determined this risk score based on one high risk and several medium risk vulnerabilities, along with the success of directed attack. The most severe vulnerability identified was the presence of default passwords in the corporate public facing website which allowed access to a number of sensitive documents and the ability to control content on the device. This vulnerability could lead to theft of user accounts, leakage of sensitive information, or full system compromise. Several lesser severe vulnerabilities could lead to theft of valid account credentials and leakage of information.</p><h2 id="0x0203-General-Findings"><a href="#0x0203-General-Findings" class="headerlink" title="0x0203 General Findings:"></a>0x0203 <strong>General Findings:</strong></h2><p>The general findings will provide a synopsis of the issues found during the penetration test in a basic and statistical format. Graphic representations of the targets tested, testing results, processes, attack scenarios, success rates, and other trendable metrics as defined within the pre engagement meeting should be present. In addition, the cause of the issues should be presented in an easy to read format. (ex. A graph showing the root cause of issues exploited)</p><p><img src="/2020/12/29/%E4%B8%83%E3%80%81%E6%8A%A5%E5%91%8A%E8%BE%93%E5%87%BA/Risk-origin.png" alt="Risk-origin.png"></p><p>If defined within the Pre engagement exercise, this area should also include metrics which depict the effectiveness of the countermeasures within the environment. (ex.. we ran x attacks and IPS blocked y. Other countermeasures should also have similar metrics of design vs. effectiveness.)</p><h2 id="0x0204-Recommendation-Summary"><a href="#0x0204-Recommendation-Summary" class="headerlink" title="0x0204 Recommendation Summary:"></a>0x0204 <strong>Recommendation Summary:</strong></h2><p>The recommendation section of the report should provide the reader with a high level understanding of the tasks needed to resolve the risks identified and the general level of effort required to implement the resolution path suggested. This section will also identify the weighting mechanisms used to prioritize the order of the road map following.</p><h2 id="0x0205-Strategic-Roadmap"><a href="#0x0205-Strategic-Roadmap" class="headerlink" title="0x0205 Strategic Roadmap:"></a>0x0205 <strong>Strategic Roadmap:</strong></h2><p>Roadmaps should include a prioritized plan for remediation of the insecure items found and should be weighed against the business objectives/ level of potential impact. This section should map directly to the goals identified as well as the threat matrix created in the PTES-Threat modeling section. By breaking up into predefined time/objective based goals, this section will create a path of action to follow in various increments. Example:</p><p><img src="/2020/12/29/%E4%B8%83%E3%80%81%E6%8A%A5%E5%91%8A%E8%BE%93%E5%87%BA/Roadmap1.png" alt="Roadmap1.png"></p><p><img src="/2020/12/29/%E4%B8%83%E3%80%81%E6%8A%A5%E5%91%8A%E8%BE%93%E5%87%BA/Roadmap2.png" alt="Roadmap2.png"></p><p><img src="/2020/12/29/%E4%B8%83%E3%80%81%E6%8A%A5%E5%91%8A%E8%BE%93%E5%87%BA/Roadmap3.png" alt="Roadmap3.png"></p><h1 id="0x03-技术报告"><a href="#0x03-技术报告" class="headerlink" title="0x03 技术报告"></a>0x03 技术报告</h1><p>This section will communicate to the reader the technical details of the test and all of the aspects/components agreed upon as key success indicators within the pre engagement exercise. The technical report section will describe in detail the scope, information, attack path, impact and remediation suggestions of the test.</p><h2 id="0x0300-Introduction"><a href="#0x0300-Introduction" class="headerlink" title="0x0300 Introduction:"></a>0x0300 <strong>Introduction:</strong></h2><p>The introduction section of the technical report is intended to be an initial inventory of:</p><ul><li>Personnel involved in the testing from both the Client and Penetration Testing Team</li><li>Contact information</li><li>Assets involved in testing</li><li>Objectives of Test</li><li>Scope of Test</li><li>Strength of Test</li><li>Approach</li><li>Threat/Grading Structure</li></ul><p>This section should be a reference for the specific resources involved in the testing and the overall technical scope of the test.</p><h2 id="0x0301-Information-Gathering"><a href="#0x0301-Information-Gathering" class="headerlink" title="0x0301 Information Gathering:"></a>0x0301 <strong>Information Gathering:</strong></h2><p>Intelligence gathering and information assessment are the foundations of a good penetration test. The more informed the tester is about the environment, the better the results of the test will be. In this section, a number of items should be written up to show the CLIENT the extent of public and private information available through the execution of the Intelligence gathering phase of PTES. At a minimum, the results identified should be presented in 4 basic categories:</p><h2 id="0x0302-Passive-Intelligence"><a href="#0x0302-Passive-Intelligence" class="headerlink" title="0x0302 Passive Intelligence:"></a>0x0302 <strong>Passive Intelligence:</strong></h2><p>Intelligence gathered from indirect analysis such as DNS,Google dorking for IP/infrastructure related information. This section will focus on the techniques used to profile the technology in the CLIENT environment WITHOUT sending any traffic directly to the assets.</p><h2 id="0x0303-Active-Intelligence"><a href="#0x0303-Active-Intelligence" class="headerlink" title="0x0303 Active Intelligence:"></a>0x0303 <strong>Active Intelligence:</strong></h2><p>This section will show the methods and results of tasks such as infrastructure mapping, port scanning, and architecture assessment and other foot printing activities. This section will focus on the techniques used to profile the technology in the CLIENT environment by sending traffic DIRECTLY to the assets.</p><h2 id="0x0304-Corporate-Intelligence"><a href="#0x0304-Corporate-Intelligence" class="headerlink" title="0x0304 Corporate Intelligence:"></a>0x0304 <strong>Corporate Intelligence:</strong></h2><p>Information about the structure of the organization, business units, market share, vertical, and other corporate functions should be mapped to both business process and the previously identified physical assets being tested.</p><h2 id="0x0305-Personnel-Intelligence"><a href="#0x0305-Personnel-Intelligence" class="headerlink" title="0x0305 Personnel Intelligence:"></a>0x0305 <strong>Personnel Intelligence:</strong></h2><p>Any and all information found during the intelligence collection phase which maps users to the CLIENT organization. This section should show the techniques used to harvest intelligence such as public/private employee depots, mail repositories, org charts and other items leading to the connection of employee/company.</p><h2 id="0x0306-Vulnerability-Assessment"><a href="#0x0306-Vulnerability-Assessment" class="headerlink" title="0x0306 Vulnerability Assessment:"></a>0x0306 <strong>Vulnerability Assessment:</strong></h2><p>Vulnerability assessment is the act of identifying the POTENTIAL vulnerabilities which exist in a TEST and the threat classification of each threat. In this section, a definition of the methods used to identify the vulnerability as well as the evidence/classification of the vulnerability should be present. In addition this section should include:</p><ul><li>Vulnerability Classification Levels</li><li>Technical Vulnerabilities<ul><li>OSI Layer Vulns</li><li>Scanner Found</li><li>Manually identified</li><li>Overall Exposure</li></ul></li><li>Logical Vulnerabilities<ul><li>NON OSI Vuln</li><li>Type of vuln</li><li>How/Where it is found</li><li>Exposure</li></ul></li><li>Summary of Results</li></ul><h2 id="0x0307-Exploitation-Vulnerability-Confirmation"><a href="#0x0307-Exploitation-Vulnerability-Confirmation" class="headerlink" title="0x0307 Exploitation/ Vulnerability Confirmation:"></a>0x0307 <strong>Exploitation/ Vulnerability Confirmation:</strong></h2><p>Exploitation or Vulnerability confirmation is the act of triggering the vulnerabilities identified in the previous sections to gain a specified level of access to the target asset. This section should review, in detail, all of the steps taken to confirm the defined vulnerability as well as the following:</p><ul><li>Exploitation Timeline</li><li>Targets selected for Exploitation</li><li>Exploitation Activities<ul><li>Directed Attack<ul><li>Target Hosts unable to be Exploited</li><li>Target Hosts able to be Exploited<ul><li>Individual Host Information</li><li>Attacks conducted</li><li>Attacks Successful</li><li>Level of access Granted +escalation path</li><li>Remediation<ul><li>Link to Vuln section reference</li><li>Additional Mitigating technique</li><li>Compensating control suggestion</li></ul></li></ul></li></ul></li></ul></li><li>Indirect Attack<ul><li>Phishing<ul><li>Timeline/details of attack</li><li>Targets identified</li><li>Success/Fail ratio</li><li>Level of access granted</li></ul></li><li>Clientside<ul><li>Timeline/details of attack</li><li>Targets identified</li><li>Success/Fail ratio</li><li>Level of access granted</li></ul></li><li>Browser Side<ul><li>Timeline/details of attack</li><li>Targets identified</li><li>Success/Fail ratio</li><li>Level of access granted</li></ul></li></ul></li></ul><h2 id="0x0308-Post-Exploitation"><a href="#0x0308-Post-Exploitation" class="headerlink" title="0x0308 Post Exploitation:"></a>0x0308 <strong>Post Exploitation:</strong></h2><p>One of the most critical items in all testing is the connection to ACTUAL impact on the CLIENT being tested. While the sections above relay the technical nature of the vulnerability and the ability to successfully take advantage of the flaw, the Post Exploitation section should tie the ability of exploitation to the actual risk to the business. In this area the following items should be evidenced through the use of screenshots, rich content retrieval, and examples of real world privileged user access:</p><ul><li><p>Privilege Escalation path</p><ul><li>Technique used</li></ul></li><li><p>Acquisition of Critical Information Defined by client</p></li><li><p>Value of information</p></li><li><p>Access to core business systems</p></li><li><p>Access to compliance protected data sets</p></li><li><p>Additional Information/Systems Accessed</p></li><li><p>Ability of persistence</p></li><li><p>Ability for exfiltration</p></li><li><p>Countermeasure Effectiveness</p></li></ul><ul><li>Detection Capability<ul><li>FW/WAF/IDS/IPS</li><li>Human</li><li>DLP</li><li>Log</li></ul></li><li>Response &amp; effectiveness</li></ul><h2 id="0x0309-Risk-Exposure"><a href="#0x0309-Risk-Exposure" class="headerlink" title="0x0309 Risk/Exposure:"></a>0x0309 <strong>Risk/Exposure:</strong></h2><p>Once the direct impact to the business is qualified through the evidence existing in the vulnerability, exploitation and post exploitation sections, the risk quantification can be conducted. In this section the results above are combined with the risk values, information criticality, corporate valuation, and derived business impact from the pre engagement section. This will give the CLIENT the ability to identify, visualize and monetize the vulnerabilities found throughout the testing and effectively weight their resolution against the CLIENTS business objectives. This section will cover the business risk in the following subsections:</p><ul><li>Evaluate incident frequency<ul><li>probable event frequency</li><li>estimate threat capability (from 3 - threat modeling)</li><li>Estimate controls strength (6)</li><li>Compound vulnerability (5)</li><li>Level of skill required</li><li>Level of access required</li></ul></li><li>Estimate loss magnitude per incident<ul><li>Primary loss</li><li>Secondary loss</li><li>Identify risk root cause analysis<ul><li>Root Cause is never a patch</li><li>Identify Failed Processes</li></ul></li></ul></li><li>Derive Risk<ul><li>Threat</li><li>Vulnerability</li><li>Overlap</li></ul></li></ul><h2 id="0x030A-Conclusion"><a href="#0x030A-Conclusion" class="headerlink" title="0x030A Conclusion:"></a>0x030A <strong>Conclusion:</strong></h2><p>Final overview of the test. It is suggested that this section echo portions of the overall test as well as support the growth of the CLIENT security posture. It should end on a positive note with the support and guidance to enable progress in the security program and a regimen of testing/security activity in the future to come.</p>]]></content>
    
    
    <categories>
      
      <category>渗透测试</category>
      
    </categories>
    
    
    <tags>
      
      <tag>渗透测试</tag>
      
      <tag>标准</tag>
      
      <tag>Google翻译</tag>
      
      <tag>报告输出</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>六、后利用</title>
    <link href="/2020/12/29/%E5%85%AD%E3%80%81%E5%90%8E%E5%88%A9%E7%94%A8/"/>
    <url>/2020/12/29/%E5%85%AD%E3%80%81%E5%90%8E%E5%88%A9%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<h1 id="后利用"><a href="#后利用" class="headerlink" title="后利用"></a>后利用</h1><h1 id="0x00-目的"><a href="#0x00-目的" class="headerlink" title="0x00 目的"></a>0x00 目的</h1><p>The purpose of the Post-Exploitation phase is to determine the value of the machine compromised and to maintain control of the machine for later use. The value of the machine is determined by the sensitivity of the data stored on it and the machines usefulness in further compromising the network. The methods described in this phase are meant to help the tester identify and document sensitive data, identify configuration settings, communication channels, and relationships with other network devices that can be used to gain further access to the network, and setup one or more methods of accessing the machine at a later time. In cases where these methods differ from the agreed upon Rules of Engagement, the Rules of Engagement must be followed.</p><p>剥削后阶段的目的是确定受损机器的价值，并保持对机器的控制以备后用。 机器的价值取决于存储在其上的数据的敏感性以及机器在进一步危害网络方面的有用性。 此阶段中描述的方法旨在帮助测试人员识别和记录敏感数据，识别配置设置，通信通道以及与其他网络设备的关系，这些设备可用于获得对网络的进一步访问，并设置一种或多种 稍后再访问机器。 如果这些方法与商定的《接触规则》不同，则必须遵守《接触规则》。</p><h1 id="0x01-Rules-of-Engagement"><a href="#0x01-Rules-of-Engagement" class="headerlink" title="0x01 Rules of Engagement"></a>0x01 Rules of Engagement</h1><p>The following Rules of Engagement are specific to the Post-Exploitation phase of a penetration test and are intended to ensure that the client’s systems are not subjected to unnecessary risk by the (direct or indirect) actions of the testers and to ensure a mutually agreed procedure to follow during the post-exploitation phase of the project.</p><p>以下交战规则是针对渗透测试的后开发阶段的，旨在确保客户端系统不会因测试人员的(直接或间接)行动而受到不必要的风险。</p><h2 id="0x0100-Protect-the-Client"><a href="#0x0100-Protect-the-Client" class="headerlink" title="0x0100 Protect the Client"></a>0x0100 Protect the Client</h2><p>The following rules are to be used as a guideline of rules to establish with a client to ensure that the day to day operations and data of the client are not exposed to risk:</p><p>以下规则将作为与客户建立规则的指导原则，以确保客户的日常操作和数据不会暴露于风险之下:</p><ul><li><p>Unless previously agreed upon, there will be no modification of services which the client deems “critical” to their infrastructure. The purpose of modifying such services would be to demonstrate to the client how an attacker may:</p><p>除非事先约定，否则不得对客户认为对其基础设施“至关重要”的服务进行修改。修改这些服务的目的是向客户端演示攻击者如何可能:</p><ul><li>Escalate privileges</li><li>Gain access to specific data</li><li>Cause denial of service</li></ul></li><li><p>All modifications, including configuration changes, executed against a system must be documented. After finishing the intended purpose of the modification, all settings should be returned to their original positions if possible. The list of changes should be given to the client after the engagement to allow them to ensure all changes were properly undone. Changes that could not be returned to their original positions should be clearly differentiated from changes that were successfully reversed.</p><p>必须记录对系统执行的所有修改，包括配置更改。完成修改的预期目的后，所有设置应尽可能返回其原始位置。订婚后，应将变更清单提供给客户，以确保他们正确撤消所有变更。不能返回到原始位置的更改应与成功撤销的更改区分开来。</p></li><li><p>A detailed list of actions taken against compromised systems must be kept. The list should include the action taken and the time period in which it occurred. Upon completion, this list should be included as an appendix to the final report.</p><p>必须保留针对受到破坏的系统采取的措施的详细列表。该列表应包括所采取的措施及其发生的时间段。完成后，该清单应作为最终报告的附录。</p></li><li><p>Any and all private and/or personal user data (including passwords and system history) uncovered during the course of the penetration test may be used as leverage to gain further permissions or to execute other actions related to the test only if the following conditions are met:</p><p>仅在满足以下条件的情况下，才能将渗透测试过程中发现的所有私人和/或个人用户数据（包括密码和系统历史记录）用作获得进一步许可或执行与该测试有关的其他操作的杠杆：</p><ul><li>The client’s Acceptable Use Policy states all systems are owned by the client and all data stored on those systems are the property of the client.</li><li>The Acceptable Use Policy states connection to the client’s network is considered consent for the connected machine to be searched and analyzed (including all present data and configurations).</li><li>The client has confirmation that all employees have read and understand the Acceptable Use Policy.</li></ul></li><li><p>Passwords (including those in encrypted form) will not be included in the final report, or must be masked enough to ensure recipients of the report cannot recreate or guess the password. This is done to safeguard the confidentiality of the users the passwords belong to, as well as to maintain the integrity of the systems they protect.</p><p>密码（包括加密形式的密码）将不包含在最终报告中，或者必须充分屏蔽以确保报告的接收者无法重新创建或猜测密码。这样做是为了保护密码所属用户的机密性，并维护其保护的系统的完整性。</p></li><li><p>Any method or device used to maintain access to compromised systems and that could affect the proper operation of the system or whose removal may cause downtime may not be implemented without the prior written consent of the client.</p><p>未经客户事先书面同意，不得实施任何用于维持对受感染系统的访问的方法或设备，这些方法或设备可能会影响系统的正常运行，或者可能被删除而可能导致停机。</p></li><li><p>Any method or device which is used to maintain access to compromised systems must employ some form of user authentication such as digital certificates or login prompts. A reverse connection to a known controlled system is also acceptable.</p><p>用于维持对受感染系统的访问的任何方法或设备都必须采用某种形式的用户身份验证，例如数字证书或登录提示。与已知受控系统的反向连接也是可以接受的。</p></li><li><p>All data gathered by the testers must be encrypted on the systems used by the testers.</p><p>测试人员收集的所有数据必须在测试人员使用的系统上进行加密。</p></li><li><p>Any information included in the report that could contain sensitive data (screenshots, tables, figures) must be sanitized or masked using techniques that render the data permanently unrecoverable by recipients of the report.</p><p>报告中包含的任何可能包含敏感数据（屏幕截图，表格，图形）的信息，都必须使用使报告接收者永久无法恢复的技术进行清理或屏蔽。</p></li><li><p>All data gathered will be destroyed once the client has accepted the final report. Method used and proof of destruction will be provided to the client.</p><p>客户接受最终报告后，收集到的所有数据将被销毁。使用的方法和销毁证据将提供给客户。</p></li><li><p>If data gathered is regulated by any law, the systems used and their locations will be provided by the client to ensure that the data collected and processed does not violate any applicable laws. If the systems will be those of the penetration testing team the data may not be downloaded and stored on to their systems and only proof of access will be shown (File Permissions, Record Count, file names..etc).</p><p>如果收集的数据受到任何法律的管制，则客户将提供所使用的系统及其位置，以确保收集和处理的数据不违反任何适用的法律。如果系统是渗透测试团队的系统，则可能不会下载数据并将其存储在他们的系统上，并且只会显示访问权限证明（文件许可，记录计数，文件名等）。</p></li><li><p>Third party services for password cracking will not be used, nor will there be sharing of any other type of data with third parties without the clients prior consent.</p><p>未经客户事先同意，将不会使用用于密码破解的第三方服务，也不会与第三方共享任何其他类型的数据。</p></li><li><p>If evidence of a prior compromise if found in the assessed environment all logs with actions and times recorded during the assessment by the penetration team will be saved, hashed and provided to the client. The client can then determine how best to respond to and handle the incident response.</p><p>如果在被评估的环境中发现有先发妥协的证据，则渗透团队在评估期间记录的所有日志以及操作和时间记录都将被保存，散列并提供给客户。然后，客户可以确定如何最好地响应和处理事件响应。</p></li><li><p>No logs should be removed, cleared or modified unless specifically authorized to do so by the client in the engagement contract/statement of work. If authorized, the logs must be backed up prior to any changes.</p><p>除非客户在聘用合同/工作说明中有特别授权，否则不得删除，清除或修改日志。如果获得授权，则必须在进行任何更改之前备份日志。</p></li></ul><h2 id="0x0101-Protecting-Yourself"><a href="#0x0101-Protecting-Yourself" class="headerlink" title="0x0101 Protecting Yourself"></a>0x0101 Protecting Yourself</h2><p>Due to the nature of a penetration test, you must ensure that you cover all your bases when dealing with the client and the tasks you will be performing. Discuss the following with the client to ensure a clear understanding of the roles and responsibilities of both client and provider prior to beginning any work.</p><p>由于渗透测试的性质，在与客户打交道和要执行的任务时，必须确保覆盖所有基础。在开始任何工作之前，与客户讨论以下内容，以确保对客户和提供者的角色和职责有清晰的了解。</p><ul><li><p>Ensure that the contract and/or statement of work signed by both the client and provider that the actions taken on the systems being tested are on behalf and in representation of the client.</p><p>确保由客户和提供者双方签署的合同和/或工作说明书，确保对被测系统采取的措施是代表客户并代表客户的。</p></li><li><p>Obtain a copy of the security policies that govern user use of company systems and infrastructure (often referred to as “Acceptable Use” policies) prior to starting the engagement. Verify that policy covers:</p><p>开始参与之前，请获取一份控制用户使用公司系统和基础结构的安全策略的副本（通常称为“可接受的使用”策略）。验证政策是否涵盖：</p><ul><li>Personal use of equipment and storage of personal employee data on the client systems and ownership and rights on that data.</li><li>Ownership of data stored on company equipment.</li></ul></li><li><p>Confirm regulations and laws that govern the data that is managed and used by the client on their systems and the restrictions imposed on such data.</p><p>确认用于管理客户在其系统上管理和使用的数据的法规和法律，以及对此类数据施加的限制。</p></li><li><p>Use full drive encryption for those systems and removable media that will receive and store client data.</p><p>对将接收和存储客户端数据的系统和可移动介质使用完全驱动器加密。</p></li><li><p>Discuss and establish with the client the procedures to follow in the case that a compromise from a third party is found.</p><p>与客户讨论并建立与第三方建立妥协的程序。</p></li><li><p>Check for laws concerning the capture and/or storage of audio and video since the use of this methods in post-exploitation may be considered a violation of local or country wiretap laws.</p><p>检查有关音频和视频的捕获和/或存储的法律，因为在后期开发中使用此方法可能被视为违反了本地或国家的窃听法律。</p></li></ul><h1 id="0x02-Infrastructure-Analysis"><a href="#0x02-Infrastructure-Analysis" class="headerlink" title="0x02 Infrastructure Analysis"></a>0x02 Infrastructure Analysis</h1><h2 id="0x0200-Network-Configuration"><a href="#0x0200-Network-Configuration" class="headerlink" title="0x0200 Network Configuration"></a>0x0200 Network Configuration</h2><p>The network configuration of a compromised machine can be used to identify additional subnets, network routers, critical servers, name servers and relationships between machine. This information can be used to identify additional targets to further penetrate the client’s network.</p><h3 id="0x020000-Interfaces"><a href="#0x020000-Interfaces" class="headerlink" title="0x020000 Interfaces"></a>0x020000 Interfaces</h3><p>Identify all of the network interfaces on the machine along with their IP addresses, subnet masks, and gateways. By identifying the interfaces and settings, networks and services can be prioritized for targeting.</p><h3 id="0x020001-Routing"><a href="#0x020001-Routing" class="headerlink" title="0x020001 Routing"></a>0x020001 Routing</h3><p>Knowledge of other subnets, filtering or addressing schemes could be leveraged to escape a segmented network, leading to additional hosts and/or networks to probe and enumerate. This data could come from a variety of sources on a particluar host or network including:</p><ul><li>Interfaces</li><li>Routing tables, including static and dynamic routes</li><li>ARP Tables, NetBios or other network protocols used for service and host discovery.</li><li>For multi-homed hosts, determine if they are acting as a router.</li></ul><h3 id="0x020002-DNS-Servers"><a href="#0x020002-DNS-Servers" class="headerlink" title="0x020002 DNS Servers"></a>0x020002 DNS Servers</h3><p>Identify all DNS servers in use, by assessing host settings. DNS servers and information could then be used to develop and execute a plan for discovering additional hosts and services on the target network. In the case that a DNS Server is compromised, the DNS database will provide valueable information about hosts and services that can be used to prioritize targets for the remainder of the assessment. The modification and addition of new records could be used to intercept the data of services depending on DNS.</p><h3 id="0x020003-Cached-DNS-Entries"><a href="#0x020003-Cached-DNS-Entries" class="headerlink" title="0x020003 Cached DNS Entries"></a>0x020003 Cached DNS Entries</h3><p>Identify high value DNS entries in the cache, which may include login pages for Intranet sites, management interfaces, or external sites. Cached interfaces provide information of the most recent and most used host used by the compromised host providing a view of the relations and interactions of the hosts providing information that could be used to prioritization of targets for further penetration of the target network and infrastructure. Modification of cached entries if permitted can be used to capture authentication credential, authentication tokens or to gain further information on services used by the compromised hosts leading to further penetration of the target network.</p><h3 id="0x020004-Proxy-Servers"><a href="#0x020004-Proxy-Servers" class="headerlink" title="0x020004 Proxy Servers"></a>0x020004 Proxy Servers</h3><p>Identify network and application level proxy servers. Proxy servers make good targets when in enterprise-wide use by the client. In the case of application proxies, it may be possible to identify, modify and/or monitor the flow of traffic, or the traffic itself. Proxy attacks are often an effective means to show impact and risk to the customer.</p><h3 id="0x020005-ARP-Entries"><a href="#0x020005-ARP-Entries" class="headerlink" title="0x020005 ARP Entries"></a>0x020005 ARP Entries</h3><p>Enumerate cached and static ARP table entries, which can reveal other hosts that interact with the compromised machine. Static ARP entries may represent critical machines. If the scope of the assessment allows for intercepting and modifying ARP entries, it is simple to show the possibility of disrupting, monitoring, or compromising a service in a manner that is usually not detected or protected against.</p><h2 id="0x0201-Network-Services"><a href="#0x0201-Network-Services" class="headerlink" title="0x0201 Network Services"></a>0x0201 Network Services</h2><h3 id="0x020100-Listening-Services"><a href="#0x020100-Listening-Services" class="headerlink" title="0x020100 Listening Services"></a>0x020100 Listening Services</h3><p>Identify all the network services offered by the target machine. This may lead to the discovery of services not identified by initial scanning as well as the discovery of other machines and networks. The identification of services not shown in scanning can also provide information on possible filtering and control systems implemented in the network and/or host. In addition, the tester may be able to leverage these services to compromise other machines. Most operating system include a method of identifying TCP and UDP connections made to and from the machine. By checking both connections to and from a compromised machine it is possible to find relationships that were previously unknown. As well as the host the service should also be considered, this may reveal services listening on non-standard ports and indicate trust relationships such as keyless authentication for SSH.</p><h3 id="0x020101-VPN-Connections"><a href="#0x020101-VPN-Connections" class="headerlink" title="0x020101 VPN Connections"></a>0x020101 VPN Connections</h3><p>All VPN connections into and out of the target machine or network should be identified. Outbound connections can provide paths into new systems which may have not previously been identified. Both inbound and outbound can identify new systems and possible business relationships. VPN connections often bypass firewalls and intrusion detection/prevention systems due to their inability to decrypt or inspect encrypted traffic. This fact makes VPNs ideal to launch attacks through. Any new targets should be verified as in scope before launching attacks against them. The presence of VPN client or server connections on the target host may also provide access to credentials previously not known that could be used to target other hosts and services.</p><h3 id="0x020102-Directory-Services"><a href="#0x020102-Directory-Services" class="headerlink" title="0x020102 Directory Services"></a>0x020102 Directory Services</h3><p>A targeted host running directory services may provide an opportunity to enumerate user accounts, hosts and/or services that can be used in additional attacks or provide additional targets that may not have been previously discovered in the vulnerability analysis phase. Additionally, the details of users found in directory services could be used for Social Engineering and phishing campaign attacks, thus providing a possible higher success rate.</p><h3 id="0x020103-Neighbors"><a href="#0x020103-Neighbors" class="headerlink" title="0x020103 Neighbors"></a>0x020103 Neighbors</h3><p>In todays network many services and operating systems use a number of protocols for neighbor discovery in an effort make the access of services, troubleshooting and configuration more convenient. Protocols vary depending on the type of target host. Networking equipment may use protocols like CDP (Cisco Discovery Protocol) and LLDP (Link Layer Discovery Protocol) to identify systems, configurations and other details to hosts directly connected to them or present in the same subnet. Similarly, desktop and server operating systems may use protocols like mDNS (Multicast Domain Name Service) and NetBios to find details of hosts and services in the same subnet.</p><h1 id="0x03-Pillaging"><a href="#0x03-Pillaging" class="headerlink" title="0x03 Pillaging"></a>0x03 Pillaging</h1><p>Pillaging refers to obtaining information (i.e. files containing personal information, credit card information, passwords, etc.) from targeted hosts relevant to the goals defined in the pre-assessment phase. This information could be obtained for the purpose of satisfying goals or as part of the pivoting process to gain further access to the network. The location of this data will vary depending on the type of data, role of the host and other circumstances. Knowledge and basic familiarity with commonly used applications, server software and middleware is very important, as most applications store their data in many different formats and locations. Special tools may be necessary to obtain, extract or read the targeted data from some systems.</p><h2 id="0x0300-Installed-Programs"><a href="#0x0300-Installed-Programs" class="headerlink" title="0x0300 Installed Programs"></a>0x0300 Installed Programs</h2><h3 id="0x030000-Startup-Items"><a href="#0x030000-Startup-Items" class="headerlink" title="0x030000 Startup Items"></a>0x030000 Startup Items</h3><p>Most systems will have applications that can run at system startup or at user logon that can provide information about the purpose of the system, software and services it interacts with. This information may reveal potential countermeasures that could be in place that may hinder further exploitation of a target network and it’s systems (e.g. HIDS/HIPS, Application Whitelisting, FIM). Information that should be gathered includes:</p><ul><li>List of the applications and their associated versions installed on the system.</li><li>List of operating system updates applied to the system.</li></ul><h2 id="0x0301-Installed-Services"><a href="#0x0301-Installed-Services" class="headerlink" title="0x0301 Installed Services"></a>0x0301 Installed Services</h2><p>Services on a particular host may serve the host itself, or other hosts in the target network. It is necessary to create a profile of each targeted host, noting the configuration of these services, their purpose, and how they may potentially be used to achieve assessment goals or further penetrate the network.</p><h3 id="0x030100-Security-Services"><a href="#0x030100-Security-Services" class="headerlink" title="0x030100 Security Services"></a>0x030100 Security Services</h3><p>Security services comprise the software designed to keep an attacker out of systems, and keep data safe. These include, but are not limited to network firewalls, host-based firewalls, IDS/IPS, HIDS/HIPS and anti-virus. Identifying any security services on a single targeted host gives an idea of what to expect when targeting other machines in the network. It also gives an idea of what alerts may have been triggered during the test, which can be discussed with the client during the project debrief, and may result in updates to Security Policies, UAC, SELinux, IPSec, windows security templates, or other security rulesets/configurations.</p><h3 id="0x030101-File-Printer-Shares"><a href="#0x030101-File-Printer-Shares" class="headerlink" title="0x030101 File/Printer Shares"></a>0x030101 File/Printer Shares</h3><p>File and print servers often contain targeted data or provide an opportunity to further penetrate the target network and hosts. The information that should be targeted includes:</p><ul><li>Shares offered by File Servers - Any file shares offered by target systems should be examined. Even just the names and comments of shares can leak important information about the names of internal applications or projects (i.e. if only “Fred” and “Christine” have access to the “Accounting” folder, perhaps they are both accounting employees).</li><li>Access Control Lists and permissions for shares. - From the client side, if it is possible to connect to the share, then it should be checked to see if the connection is read/only or read/write. Remember that if a share contains directories then different permissions may apply to different directories. From the server side both server configuration and file/directory permissions should be examined.</li><li>File share file and content listings</li><li>Identify files of interest from the file share listings. Look for interesting or targeted items such as:<ul><li>Source Code</li><li>Backups</li><li>Installation Files</li><li>Confidential Data (financial data in spreadsheets, bank reports in TXT/PDF, password files, etc.)</li></ul></li><li>Place trojans or autorun files - Using clever naming, or by mimicking naming conventions already in use, users can be encouraged to execute these payloads, allowing the tester to further penetrate the network. If file server logs can be obtained, specific users may even be targeted.</li></ul><h3 id="0x030102-Database-Servers"><a href="#0x030102-Database-Servers" class="headerlink" title="0x030102 Database Servers"></a>0x030102 Database Servers</h3><p>Databases contain a wealth of information that may be targeted in an assessment.</p><ul><li>Databases - A list of database names can help the assessor to determine the purpose of the database and the types of data the database may contain. In an environment with many databases, this will help in prioritizing targets.</li><li>Tables - Table names and metadata, such as comments, column names and types can also help the assessor choose targets and find targeted data.</li><li>Table Content, row count for regulated content</li><li>Columns - It is possible in many databases to search all column names of all tables with a single command. This can be leveraged to find targeted data (e.g. If credit card data is targeted on an Oracle database, try executing <em>select * from all_tab_columns where name = ‘%CCN%’;</em>.</li><li>Database and Table Permissions</li><li>Database Users, Passwords, Groups and Roles</li></ul><p>The information hosted on databases can be also be used to show risk, achieve assessment goals, determine configuration and function of services or to further penetrate a client network and hosts.</p><h3 id="0x030103-Directory-Servers"><a href="#0x030103-Directory-Servers" class="headerlink" title="0x030103 Directory Servers"></a>0x030103 Directory Servers</h3><p>The main goals of a directory service is to provide information to services and hosts for reference or/and authentication. The compromise of this service can allow the control of all hosts that depend on the service and well as provide information that could be used to further an attack. Information to look for in a directory service are:</p><ul><li>List of objects (Users, passwords, Machines..etc)</li><li>Connections to the system</li><li>Identification of protocols and security level</li></ul><h3 id="0x030104-Name-Servers"><a href="#0x030104-Name-Servers" class="headerlink" title="0x030104 Name Servers"></a>0x030104 Name Servers</h3><p>Name server provide resolution to host and services depending on the types of records it servers. Enumeration of records and controls can provide a list of targets and services to prioritize and attack to further penetrate a clients network and hosts. The ability to modify and add records can be use to show risk of denial of services as well as aid in the interception of traffic and information on a customer network.</p><h3 id="0x030105-Deployment-Services"><a href="#0x030105-Deployment-Services" class="headerlink" title="0x030105 Deployment Services"></a>0x030105 Deployment Services</h3><p>Identification of deployment services allows for the access and enumeration of:</p><ul><li>Unattended answer files</li><li>Permission on files</li><li>Updates included</li><li>Applications and versions</li></ul><p>This information can be used to further penetrate a client network and hosts. The ability to modify the repositories and configuration of the service allows for</p><ul><li>Backdoor installation</li><li>Modification of services to make them vulnerable to attack</li></ul><h3 id="0x030106-Certificate-Authority"><a href="#0x030106-Certificate-Authority" class="headerlink" title="0x030106 Certificate Authority"></a>0x030106 Certificate Authority</h3><p>Identification of Certificate Authority services on a compromised client host will allow for the access to</p><ul><li>Root CA</li><li>Code Signing Certificates</li><li>Encryption and Signing Certificates</li></ul><p>Control of the service will also allow for the</p><ul><li>Creation of new certificates for several tasks</li><li>Revocation of certificates</li><li>Modification of the Certificate Revocation List</li><li>Insertion of Root CA Certificate</li></ul><p>The control of the services shows risk and allows for the compromise of data and services on a client’s network and hosts.</p><h3 id="0x0301007-Source-Code-Management-Server"><a href="#0x0301007-Source-Code-Management-Server" class="headerlink" title="0x0301007 Source Code Management Server"></a>0x0301007 Source Code Management Server</h3><p>Identification of source code management systems via by the service running on the compromised host or the client part of the service provides the opportunity for:</p><ul><li>Enumerate projects - The project names can give away sensitive information on company projects.</li><li>Verify access to source code files</li><li>Modify source code files - If it is allowed in scope then modifying source code proves that an attacker could make changes that would affect the system</li><li>Enumerate developers - Developers details can be use for social engineering attacks as well as as inputs for attacking other areas of the system</li><li>Enumerate configuration</li></ul><h3 id="0x030108-Dynamic-Host-Configuration-Server"><a href="#0x030108-Dynamic-Host-Configuration-Server" class="headerlink" title="0x030108 Dynamic Host Configuration Server"></a>0x030108 Dynamic Host Configuration Server</h3><p>Identification of dynamic host configuration service or use of the service by the compromised host allows for:</p><ul><li>Enumeration leases given</li><li>Enumeration configuration</li><li>Enumeration Options</li><li>Modification of configuration</li><li>Consumption of all leases</li></ul><p>The control of the service can be used to show risk of denial of service and for use in man in the middle attacks of hosts and services on the compromised network.</p><h3 id="0x030109-Virtualization"><a href="#0x030109-Virtualization" class="headerlink" title="0x030109 Virtualization"></a>0x030109 Virtualization</h3><p>Identification virtualization services or client software allow for:</p><ul><li>Enumerate Virtual Machines (name, configurations, OS)</li><li>Enumerate passwords and digital certificates for administration systems.</li><li>Enumerate virtualization software configuration</li><li>Configuration of Hosts</li><li>Show risk of denial of service with control of VM state</li><li>Access to data hosted on VM’s</li><li>Interception of traffic of virtual hosts or services hosted on the compromised host</li></ul><h3 id="0x03010A-Messaging"><a href="#0x03010A-Messaging" class="headerlink" title="0x03010A Messaging"></a>0x03010A Messaging</h3><p>Identification of services or client software for messaging provides the opportunity to</p><ul><li>Identify Directory Services</li><li>Compromise of credentials</li><li>Access to confidential information</li><li>Identification of hosts on the network</li><li>System and business relationships</li></ul><p>All of this information and actions can be used to show risk and to further penetrate a client’s network and hosts.</p><h3 id="0x03010B-Monitoring-and-Management"><a href="#0x03010B-Monitoring-and-Management" class="headerlink" title="0x03010B Monitoring and Management"></a>0x03010B Monitoring and Management</h3><p>Identification of services or client software for the purpose of monitoring and/or management may provide identification of additional servers and services on the target network, in addition the configuration parameters gained may provide access to other targets host and to determine what actions performed by the tester can be detected by the client. Some services to look for:</p><ul><li>SNMP (Simple Network Management Protocol)</li><li>Syslog</li></ul><p>Some Management Services and Software to look for to gain credentials, identify host and gain access to other services may be:</p><ul><li>SSH Server/Client</li><li>Telnet Server/Client</li><li>RDP (Remote Desktop Protocol) Client</li><li>Terminal Server</li><li>Virtual Environment Management Software</li></ul><h3 id="0x03010C-Backup-Systems"><a href="#0x03010C-Backup-Systems" class="headerlink" title="0x03010C Backup Systems"></a>0x03010C Backup Systems</h3><p>Identification of services or client software for the purpose of backing up data provide a great opportunity to an attacker since these system require access to the data and systems they need to backup providing an attacker:</p><ul><li>Enumeration of hosts and systems</li><li>Enumeration of services</li><li>Credentials to host and/or services</li><li>Access to backup data</li></ul><p>The information gained from the service can be used to show risk to the confidentiality, integrity and access tot he system and their information. Access to the backups can also provide opportunity to introduce miss configuration, vulnerable software or backdoors in to the clients systems.</p><h3 id="0x03010D-Networking-Services-RADIUS-TACACS-etc"><a href="#0x03010D-Networking-Services-RADIUS-TACACS-etc" class="headerlink" title="0x03010D Networking Services (RADIUS,TACACS..etc)"></a>0x03010D Networking Services (RADIUS,TACACS..etc)</h3><p>Identification of services or use of networking services allows for the:</p><ul><li>Enumeration of users</li><li>Enumeration of hosts and systems</li><li>Compromise of credentials</li><li>Show risk of denial of service if alternate methods are not present</li></ul><h2 id="0x0302-Sensitive-Data"><a href="#0x0302-Sensitive-Data" class="headerlink" title="0x0302 Sensitive Data"></a>0x0302 Sensitive Data</h2><h3 id="0x030200-Key-logging"><a href="#0x030200-Key-logging" class="headerlink" title="0x030200 Key-logging"></a>0x030200 Key-logging</h3><p>By monitoring key strokes it is possible to detect sensitive information including passwords and PII - Don’t know what the legality of this is if the user is say chatting on private IM while also using company software, anyone know? If the company says that all data on the network can be monitored then this should be ok. If the second bullet point in Protect Yourself is present and it states that use of equipment can be monitored and no personal use is permitted yes, if policy does not cover personal user or ownership of data, no. It should be extended to cover Network also.</p><h3 id="0x030201-Screen-capture"><a href="#0x030201-Screen-capture" class="headerlink" title="0x030201 Screen capture"></a>0x030201 Screen capture</h3><p>Screen capture can be use to show evidence of compromise as well as access to information that can shown on the screen and access thru other means is not possible. Great care should be taken with the data collected thru screen capture so as to nor show private data of employees of customers of the client.</p><h3 id="0x030202-Network-traffic-capture"><a href="#0x030202-Network-traffic-capture" class="headerlink" title="0x030202 Network traffic capture"></a>0x030202 Network traffic capture</h3><p>Network traffic capture can be used depending on the controls on the network and medium used for capture can be used to:</p><ul><li>Identify hosts on the network</li><li>Intercept data</li><li>Identify services</li><li>Identify relations between hosts in the network</li><li>Capture of credentials</li></ul><p>Care should be taken to only capture traffic covered under the scope of the engagement and that the information captured does not fall under the control of local laws like the capture of Voice Over IP calls. Information retained and shown should be filtered so as to protect client’s customer and/or employee personal and confidential data.</p><h3 id="0x030203-Previous-Audit-reports"><a href="#0x030203-Previous-Audit-reports" class="headerlink" title="0x030203 Previous Audit reports"></a>0x030203 Previous Audit reports</h3><h2 id="0x0303-User-Information"><a href="#0x0303-User-Information" class="headerlink" title="0x0303 User Information"></a>0x0303 User Information</h2><p>In this section the main focus is on the information present on the target system related to user accounts either present on the system or that have connected remotely and have left some trace that the personnel performing the assessment can gather and analyze for further penetration or provide the desired goal of the assessment.</p><h3 id="0x030300-On-System"><a href="#0x030300-On-System" class="headerlink" title="0x030300 On System"></a>0x030300 On System</h3><p>General information that can be gather on a compromised system are:</p><ul><li>History files - History files store recent commands the user has executed. Reading through these can reveal system configuration information, important applications, data locations and other system *sensitive information.</li><li>Encryption Keys (SSH, PGP/GPG)</li><li>Interesting Documents (.doc/x, .xls/x , password.*) - Users often store passwords and other sensitive information in clear text documents. These can be located in two ways, either searching through file names for interesting words, such as password.txt, or searching through the documents themselves. Indexing services can help with this, for example the Linux locate database.</li><li>User specific application configuration parameters</li><li>Individual Application History (MRU Windows only, history files..etc)</li><li>Enumerate removable media</li><li>Enumerate network shares / domain permission (gpresult)</li></ul><h3 id="0x030301-Web-Browsers"><a href="#0x030301-Web-Browsers" class="headerlink" title="0x030301 Web Browsers"></a>0x030301 Web Browsers</h3><p>Information that can be gathered from web browsers that can be use to identify other hosts and systems as well as provide information to further penetrate a client’s network and hosts are:</p><ul><li>Browser History</li><li>Bookmarks</li><li>Download History</li><li>Credentials</li><li>Proxies</li><li>Plugins/Extensions</li></ul><p>Great care should be taken that only data in scope for the engagement is capture since the information from a web browser may contain client’s employee confidential and private data. This data should be filtered from the data returned and report.</p><h3 id="0x030302-IM-Clients"><a href="#0x030302-IM-Clients" class="headerlink" title="0x030302 IM Clients"></a>0x030302 IM Clients</h3><p>Information that can be gathered from IM Clients on a compromised system is:</p><ul><li>Enumerate Account Configuration (User, Password, Server, Proxy)</li><li>Chat Logs</li></ul><p>Great care should be taken that only data in scope for the engagement is capture since the information from a web browser may contain client’s employee confidential and private data. This data should be filtered from the data returned and report.</p><h2 id="0x0304-System-Configuration"><a href="#0x0304-System-Configuration" class="headerlink" title="0x0304 System Configuration"></a>0x0304 System Configuration</h2><h3 id="0x030400-Password-Policy"><a href="#0x030400-Password-Policy" class="headerlink" title="0x030400 Password Policy"></a>0x030400 Password Policy</h3><p>By enumerating the systems password policy the ability to brute force and crack passwords becomes much more efficient, for example knowing that the minimum password length is 8 characters you can remove any word less than 8 characters from a dictionary.</p><h3 id="0x030401-Security-Policies"><a href="#0x030401-Security-Policies" class="headerlink" title="0x030401 Security Policies"></a>0x030401 Security Policies</h3><h3 id="0x030402-Configured-Wireless-Networks-and-Keys"><a href="#0x030402-Configured-Wireless-Networks-and-Keys" class="headerlink" title="0x030402 Configured Wireless Networks and Keys"></a>0x030402 Configured Wireless Networks and Keys</h3><p>By finding the targets wireless information it becomes possible to launch physical attacks through the companies wifi when on site. It can also allow a fake AP to be set up to lure targets to connect when away from site.</p><h1 id="0x04-High-Value-Profile-Targets"><a href="#0x04-High-Value-Profile-Targets" class="headerlink" title="0x04 High Value/Profile Targets"></a>0x04 High Value/Profile Targets</h1><p>High value/profile targets can be identified and further expanded from the targets identified in the pre-engagement meetings thru the analysis of the data gathered from the compromised systems and the interactions of those systems and the services that run on them This view of the the operation and interactions of these high value/profile targets helps in the identification and measurement of of impact that can be gained to the business do to the data and processes and to the overall integrity of the client’s infrastructure and services.</p><h1 id="0x05-Data-Exfiltration"><a href="#0x05-Data-Exfiltration" class="headerlink" title="0x05 Data Exfiltration"></a>0x05 Data Exfiltration</h1><h2 id="0x0500-Mapping-of-all-possible-exfiltration-paths"><a href="#0x0500-Mapping-of-all-possible-exfiltration-paths" class="headerlink" title="0x0500 Mapping of all possible exfiltration paths"></a>0x0500 Mapping of all possible exfiltration paths</h2><p>from each of the areas where access has been achieved, a full exfiltration paths should be created. This includes secondary and tertiary means of getting to the outside world (through different accessible subnetc, etc). Once the mapping is provided, the actual exfiltration testing should be commenced.</p><h2 id="0x0501-Testing-exfiltration-paths"><a href="#0x0501-Testing-exfiltration-paths" class="headerlink" title="0x0501 Testing exfiltration paths"></a>0x0501 Testing exfiltration paths</h2><p>Per exfiltration paths mapping, data should be exfiltrated from the organization being tested. This should already be covered in the <a href="http://www.pentest-standard.org/index.php/Pre-engagement">Pre-engagement</a> scoping and adequate infrastructure should have been setup which adheres to the customer’s acceptable engagement policy (i.e. data being exfiltrated is usually exfiltrated to a server in the full control of the tester, and will access and ownership right to the tested organization). The exfiltration itself should simulate real-world exfiltration strategies used by the threat actors that correspond to the <a href="http://www.pentest-standard.org/index.php/Threat_Modeling_Standard">Threat Modeling Standard</a> relevant for the organization (i.e. if criminal mostly then “standard” exfiltration using a staging area inside the network where data is archived inside zip/7z encrypted files and then sent to FTP/HTTP servers on the Internet, if a more sophisticated threat actor then using means that simulate such strategies and tactics used for exfiltration).</p><h2 id="0x0502-Measuring-control-strengths"><a href="#0x0502-Measuring-control-strengths" class="headerlink" title="0x0502 Measuring control strengths"></a>0x0502 Measuring control strengths</h2><p>When performing exfiltration testing, the main goal of the test is to see whether the current controls for detecting and blocking sensitive information from leaving the organization actually work, as well as exercise the response teams if anything has been detected in terms of how they react to such alerts and how are the events being investigated and mitigated.</p><h1 id="0x06-Persistence"><a href="#0x06-Persistence" class="headerlink" title="0x06 Persistence"></a>0x06 Persistence</h1><ul><li>Installation of backdoor that requires authentication.</li><li>Installation and/or modification of services to connect back to system. User and complex password should be used as a minimum; use of certificates or cryptographic keys is preferred where possible. (SSH, ncat, RDP). Reverse connections limited to a single IP may be used.</li><li>Creation of alternate accounts with complex passwords.</li><li>When possible backdoor must survive reboots.</li></ul><h1 id="0x07-Further-Penetration-Into-Infrastructure"><a href="#0x07-Further-Penetration-Into-Infrastructure" class="headerlink" title="0x07 Further Penetration Into Infrastructure"></a>0x07 Further Penetration Into Infrastructure</h1><p>Pivoting is the action in which the tester will use his presence of on the compromised system to further enumerate and gain access to other systems on the client’s infrastructure. This action can be executed from the compromised host it self using local resourced or tools uploaded to the compromised system.</p><h2 id="0x0700-From-Compromised-System"><a href="#0x0700-From-Compromised-System" class="headerlink" title="0x0700 From Compromised System"></a>0x0700 From Compromised System</h2><p>Actions that can be taken from a compromised system:</p><ul><li>Upload tools</li><li>Use local system tools</li><li>ARP Scan</li><li>Ping Sweep</li><li>DNS Enumeration of internal network</li><li>Directory Services Enumeration</li><li>Brute force attacks</li><li>Enumeration and Management thru Management Protocols and compromised credentials (WinRM, WMI, SMB, SNMP..etc)</li><li>Abuse of compromised credentials and keys (Webpages, Databases..etc)</li><li>Execute Remote Exploits</li></ul><p>The action that will be executed will depend on the information needed to show specific risk and/or further penetrating the client’s network and hosts. Regular planning sessions are recommended to re-evaluate the information gather and decide the best approach to continue the post exploitation until the set goals are meet.</p><h2 id="0x0701-Thru-Compromised-System"><a href="#0x0701-Thru-Compromised-System" class="headerlink" title="0x0701 Thru Compromised System"></a>0x0701 Thru Compromised System</h2><p>Actions that can be taken thru a compromised system:</p><ul><li>Port Forwarding</li><li>Proxy to internal network (SSH)</li><li>VPN to internal network</li><li>Execute Remote Exploit</li><li>Abuse of compromised credentials and keys (Webpages, Databases..etc)</li></ul><p>The action that will be executed will depend on the information needed to show specific risk and/or further penetrating the client’s network and hosts. Regular planning sessions are recommended to re-evaluate the information gather and decide the best approach to continue the post exploitation until the set goals are meet.</p><h1 id="0x08-Cleanup"><a href="#0x08-Cleanup" class="headerlink" title="0x08 Cleanup"></a>0x08 Cleanup</h1><p>The cleanup process covers the requirements for cleaning up systems once the penetration test has been completed. This will include all user accounts and binaries used during the test.</p><ul><li>Remove all executable, scripts and temporary file from a compromised system. If possible use secure delete method for removing the files and folders.</li><li>Return to original values system settings and application configuration parameters if they where modified during the assessment.</li><li>Remove all backdoors and/or rootkits installed.</li><li>Remove any user accounts created for connecting back to compromise systems.</li></ul>]]></content>
    
    
    <categories>
      
      <category>渗透测试</category>
      
    </categories>
    
    
    <tags>
      
      <tag>渗透测试</tag>
      
      <tag>标准</tag>
      
      <tag>Google翻译</tag>
      
      <tag>后利用</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>五、漏洞利用</title>
    <link href="/2020/12/29/%E4%BA%94%E3%80%81%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/"/>
    <url>/2020/12/29/%E4%BA%94%E3%80%81%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<h1 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h1><h1 id="0x00-目的-Purpose"><a href="#0x00-目的-Purpose" class="headerlink" title="0x00 目的(Purpose)"></a>0x00 目的(Purpose)</h1><p>The exploitation phase of a penetration test focuses solely on establishing access to a system or resource by bypassing security restrictions. If the prior phase, vulnerability analysis was performed properly, this phase should be well planned and a precision strike.. The main focus is to identify the main entry point into the organization and to identify high value target assets.</p><p>渗透测试的开发阶段仅专注于通过绕过安全限制来建立对系统或资源的访问。 如果在上一阶段适当地执行了漏洞分析，则此阶段应该计划周全，并且要进行精确的打击。主要重点是确定组织的主要切入点并确定高价值目标资产。</p><p>If the vulnerability analysis phase was properly completed, a high value target list should have been complied. Ultimately the attack vector should take into consideration the success probability and highest impact on the organization.</p><p>如果漏洞分析阶段已正确完成，则应遵守高价值目标列表。 最终，攻击媒介应考虑成功概率和对组织的最大影响。</p><h1 id="0x01-对策-Countermeasures"><a href="#0x01-对策-Countermeasures" class="headerlink" title="0x01 对策(Countermeasures)"></a>0x01 对策(Countermeasures)</h1><p>Countermeasures are defined as preventative technology or controls that hinder the ability to successfully complete an exploit avenue. This technology could be a Host Based Intrusion Prevention System, Security Guard, Web Application Firewall, or other preventative methods. When performing an exploit, several factors should be taken into consideration. In the event of a preventative technology, a circumvention technique should be considered. In circumstances when this is not possible, alternative exploit methods should be considered.</p><p>对策定义为阻止成功完成漏洞利用途径的能力的预防性技术或控制措施。 该技术可以是基于主机的入侵防御系统，安全卫士，Web应用程序防火墙或其他预防方法。 执行漏洞利用时，应考虑几个因素。 如果采用预防技术，则应考虑采取规避技术。 在不可能的情况下，应考虑使用其他利用方法。</p><p>Overall, the purpose is to remain stealth when attacking the organization, if alarms are tripped the level of the assessment could be diminished. If at all possible, the countermeasures should be enumerated prior to triggering the exploit. This could be done through doing dry runs of the attack or enumerating the technology.</p><p>总体而言，这样做的目的是在攻击组织时保持隐身状态，如果发出警报，评估水平可能会降低。 如果有可能，应在触发利用之前枚举对策。 这可以通过空袭或枚举技术来完成。</p><h2 id="0x0100-反病毒-Anti-Virus"><a href="#0x0100-反病毒-Anti-Virus" class="headerlink" title="0x0100 反病毒(Anti-Virus)"></a>0x0100 反病毒(Anti-Virus)</h2><p>Anti-virus is a technology aimed at preventing malicious software from being deployed on the system. As a penetration tester we should be able to identify these types of anti-virus technologies and be able to protect against them. Anti-virus is a small subset of all of the different preventative measures that can be in place, for example host-based intrusion prevention systems, web application firewalls, and other preventative technologies.</p><p>防病毒是一种旨在防止恶意软件在系统上部署的技术。 作为渗透测试人员，我们应该能够识别出这些类型的防病毒技术并能够加以保护。 防病毒只是可以采取的所有不同预防措施的一小部分，例如基于主机的入侵防御系统，Web应用程序防火墙和其他预防技术。</p><h3 id="0x010000-编码"><a href="#0x010000-编码" class="headerlink" title="0x010000 编码"></a>0x010000 编码</h3><p>Encoding is the method of obfuscating data in a way that makes the deployed piece of code not appear the same. With encoding, the obfuscation occurs usually by scrambling the information and re-arranging in order to hide the fact of what the application is actually doing.</p><p>编码是一种使数据混淆的方法，可以使部署的代码看起来不一样。 使用编码时，混淆通常是通过加扰信息并重新排列以隐藏应用程序实际在做什么的事实而发生的。</p><h3 id="0x010001-打包"><a href="#0x010001-打包" class="headerlink" title="0x010001 打包"></a>0x010001 打包</h3><p>Packing is similar to encoding in a sense in that it attempts to re-arrange data to compress the application or “pack” it. The hopes of this is that the executable or piece of code being delivered is obfuscated in a manner that it won’t be picked up by anti-virus technologies.</p><p>打包在某种意义上与编码类似，因为它尝试重新排列数据以压缩应用程序或对其进行“打包”。 这样做的希望是，所交付的可执行文件或代码段被混淆，从而不会被防病毒技术拾取。</p><h3 id="0x010002-加密"><a href="#0x010002-加密" class="headerlink" title="0x010002 加密"></a>0x010002 加密</h3><p>Encrypting, like Encoding and Packing is another method of manipulating the intended runnable code such that it is not recognizable or available for inspection. Only after decrypting in in-memory (with methods similar to packing) the actual code is exposed for the first time - hopefully after security mechanisms have allowed it through and it is executed immediately after it is decrypted.</p><p>像编码和打包一样，加密是另一种处理预期的可运行代码的方法，该方法无法识别或不可检查。 仅在内存中解密（使用类似于打包的方法）之后，才首次公开实际代码-希望在安全机制允许它通过并在解密后立即执行之后才公开。</p><h3 id="0x010003-白名单绕过"><a href="#0x010003-白名单绕过" class="headerlink" title="0x010003 白名单绕过"></a>0x010003 白名单绕过</h3><p>Whitelisting technologies leveraged a trusted model for applications that have been seen on a given system at a time. The technology takes a baseline of the system and identifies what is normal to be run on the system versus what is something foreign. The penetration tester should be able to circumvent whitelist technologies. One of the most common methods is through direct memory access. Whitelisting does not have the capbility of monitoring memory real time and if a memory resident program is running and not touching disk, it can run without being detect by the given technology.</p><p>白名单技术利用可信任模型建立了一次在给定系统上看到的应用程序。 该技术以系统为基准，并确定在系统上可以正常运行的东西与哪些东西无关。 渗透测试人员应该能够规避白名单技术。 最常见的方法之一是通过直接内存访问。 白名单不具有实时监视内存的功能，并且如果内存驻留程序正在运行且未接触磁盘，则可以在不被给定技术检测的情况下运行。</p><h3 id="0x010004-进程注入"><a href="#0x010004-进程注入" class="headerlink" title="0x010004 进程注入"></a>0x010004 进程注入</h3><p>Process injection is simply the method to inject into an already running process. By injecting into a process, the information of the application can be hidden within a process that would normally be trusted in nature. It’s very difficult for preventative measure technology to inspect running processes and can almost always hide in a different process that the application would think is a trusted one.</p><p>流程注入只是注入到已经运行的流程中的方法。 通过注入到进程中，可以将应用程序的信息隐藏在通常会自然信任的进程中。 预防措施技术很难检查正在运行的进程，并且几乎总是隐藏在应用程序认为是值得信任的进程中。</p><h3 id="0x010005-纯粹的常驻内存-Purely-Memory-Resident"><a href="#0x010005-纯粹的常驻内存-Purely-Memory-Resident" class="headerlink" title="0x010005 纯粹的常驻内存(Purely Memory Resident)"></a>0x010005 纯粹的常驻内存(Purely Memory Resident)</h3><p>Memory resident attacks are generally the most preferred as most technologies do not inspect memory. As an attacker, finding a way to live in memory purely would be most desirable. When writing to disk, most applications will conduct scans, baselines, and other identifications of potentially maliicous software. The ability to be detected when writing to disk becomes significantly greater.</p><p>通常，最常首选驻留内存的攻击，因为大多数技术都不会检查内存。 作为攻击者，最希望找到一种纯粹生活在内存中的方法。 当写入磁盘时，大多数应用程序将进行扫描，基准测试以及其他可能恶意软件的标识。 写入磁盘时被检测的能力大大增强。</p><h2 id="0x0101-人为因素-Human"><a href="#0x0101-人为因素-Human" class="headerlink" title="0x0101 人为因素(Human)"></a>0x0101 人为因素(Human)</h2><p>When performing exploitation, it is not always the best route to go through a direct exploit or through an application flaw. Sometimes the human element may be a better way to attack an organization. It’s important to understand the right attack avenue and make sure that the method we are leveraging is the best route to take.</p><p>在执行利用时，进行直接利用或通过应用程序漏洞不一定总是最佳途径。 有时，人为因素可能是攻击组织的更好方法。 重要的是要了解正确的攻击途径，并确保我们利用的方法是采取的最佳途径。</p><h2 id="0x0102-数据执行保护-DEP"><a href="#0x0102-数据执行保护-DEP" class="headerlink" title="0x0102 数据执行保护(DEP)"></a>0x0102 数据执行保护(DEP)</h2><p>When performing exploitation, many preventative measures canc ome into play. Data Execution Prevention is a defensive measure implemented into most operating systems and prevents execute permission when an overwrite in memory has occurred. The thought process behind DEP is to stop an attacker in rewriting memory and then executing that code. There are mulitple methods to bypass data execution prevention and discussed later in the the exploitation phase of PTES.</p><p>在进行剥削时，许多预防措施都会发挥作用。 数据执行保护是一种防御措施，已在大多数操作系统中实施，并在发生内存覆盖时阻止执行权限。 DEP背后的思考过程是阻止攻击者重写内存，然后执行该代码。 有多种方法可以绕过数据执行保护，稍后将在PTES的开发阶段进行讨论。</p><h2 id="0x0103-地址空间布局随机化-ASLR"><a href="#0x0103-地址空间布局随机化-ASLR" class="headerlink" title="0x0103 地址空间布局随机化(ASLR)"></a>0x0103 地址空间布局随机化(ASLR)</h2><p>During a buffer overflow vulnerability (or that of anything where we control memory), memory addresses are hardcoded in order redirect execution flow to our shellcode. In the event of ASLR, certain bytes are randomized in order to prevent an attacker from predicting where he/she can always go to in order to execute shellcode.</p><p>在缓冲区溢出漏洞（或我们控制内存的任何漏洞）中，内存地址经过硬编码，以便将执行流重定向到我们的Shellcode。 在发生ASLR的情况下，某些字节将被随机分配，以防止攻击者预测他/她为了执行shellcode而总是可以去的地方。</p><h2 id="0x0104-Web应用防火墙-WAF"><a href="#0x0104-Web应用防火墙-WAF" class="headerlink" title="0x0104 Web应用防火墙(WAF)"></a>0x0104 Web应用防火墙(WAF)</h2><p>Web application firewalls are a technology that sits inline with an application in order to protect against web-based application attacks. Web application firewalls attempt to identify potentially dangerous or malforms attacked towards a given web applciation and prevent them. There are a number of bypass techniques for web application firewalls and should be tested during the penetration test.</p><p>Web应用程序防火墙是一种与应用程序共存的技术，可以防止基于Web的应用程序受到攻击。 Web应用程序防火墙试图识别针对给定Web应用程序而受到攻击的潜在危险或格式错误，并阻止它们。 Web应用程序防火墙有许多绕过技术，应该在渗透测试期间进行测试。</p><h1 id="0x02-逃避-Evasion"><a href="#0x02-逃避-Evasion" class="headerlink" title="0x02 逃避(Evasion)"></a>0x02 逃避(Evasion)</h1><p>Evasion is the technique used in order to escape detection during a penetration test. This could be circumventing a camera system as to not be seen by a guard, obfuscating your payloads to evade Intrusion Detection Systems (IDS) or Intrusion Prevention Systems (IPS) or encoding requests/responses to circumvent web application firewalls. Overall, the need to identify a low risk scenario for evading a technology or person should be formulated prior to the exploit.</p><p>逃避是一种用于在渗透测试过程中逃避检测的技术。 这可能是绕过了警卫看不到的摄像头系统，混淆了您的有效载荷以逃避入侵检测系统（IDS）或入侵防御系统（IPS）或对请求/响应进行编码以绕过Web应用程序防火墙。 总体而言，应在漏洞利用之前确定对技术或人员进行低风险识别的需求。</p><h1 id="0x03-精准打击-Precision-Strike"><a href="#0x03-精准打击-Precision-Strike" class="headerlink" title="0x03 精准打击(Precision Strike)"></a>0x03 精准打击(Precision Strike)</h1><p>The main focus of a penetration test is to simulate an attacker in order to represent a simulated attack against the organization. The value brought through a penetration test is generally not through smash and grab techniques where the attacks are noisy in nature and in an attempt to try every exploit. This approach may be particularly useful at the end of a penetration test to gauge the level of incident response from the organization, but in most cases the exploitation phase is a accumulation of specific research on the target.</p><p>渗透测试的主要重点是模拟攻击者，以表示对组织的模拟攻击。 渗透测试所带来的价值通常不是通过攻击本质上是嘈杂的，试图尝试各种利用的粉碎和抢夺技术来实现的。 这种方法在渗透测试结束后评估组织的事件响应水平时可能特别有用，但是在大多数情况下，开发阶段是针对目标的特定研究的积累。</p><h1 id="0x04-定制化漏洞利用途径"><a href="#0x04-定制化漏洞利用途径" class="headerlink" title="0x04 定制化漏洞利用途径"></a>0x04 定制化漏洞利用途径</h1><p>Every attack will typically not be the same in how the exploitation avenue occurs. In order to be successful in this phase, the attack should be tailored and customized based on the scenario. For example, if a wireless penetration test is occurred, and a specific technology is in use, these need to be identified and attacked based on what technologies are in place. Having a clear understanding of each scenario and the applicability of an exploit is one of the most important aspects of this phase of the penetration test.</p><p>通常，每种攻击在利用途径上都是不同的。 为了在此阶段中取得成功，应根据情况定制和定制攻击。 例如，如果进行了无线渗透测试，并且正在使用特定技术，则需要根据所采用的技术来识别和攻击这些技术。 深入了解每种情况和漏洞利用的适用性是渗透测试此阶段最重要的方面之一。</p><h1 id="0x05-定制的利用-Tailored-Exploits"><a href="#0x05-定制的利用-Tailored-Exploits" class="headerlink" title="0x05 定制的利用(Tailored Exploits)"></a>0x05 定制的利用(Tailored Exploits)</h1><p>In a number of occasions the exploits that are public on the Internet may need some work in order to successfully complete. In most cases, if an exploit is designed for Windows XP SP2, specific modifications to the exploit will be required in order for the attack to be successful via Windows XP SP3. The penetration tester should have the knowledge in place to be able to customize an exploit and the ability to change on the fly in order to successfully complete the attack.</p><p>在许多情况下，要成功完成Internet上公开的漏洞利用，可能需要做一些工作。 在大多数情况下，如果为Windows XP SP2设计了漏洞利用程序，则需要对该漏洞利用程序进行特定的修改，才能通过Windows XP SP3成功进行攻击。 渗透测试人员应具备适当的知识，能够自定义漏洞利用程序和即时更改能力，以成功完成攻击。</p><h2 id="0x0500-利用定制-Exploit-Customization"><a href="#0x0500-利用定制-Exploit-Customization" class="headerlink" title="0x0500 利用定制(Exploit Customization)"></a>0x0500 利用定制(Exploit Customization)</h2><p>In the event of an attack, it is often required to simulate the victims infrastructure in order to ensure that the exploitation phase will be successful. The techniques leveraged in the information gathering phase can always help assist in that however, having a working infrastructure and systems in place will make the expliotation phase much easier. In the event of a tailored exploit, the penetration tester should be able to customize already public exploits in order to successfully attack a system. A common theme for exploits is to target specific versions of operating systems or applications. The reason for this is due to memory addresses changing based on service packs, and/or new versions of the operating system. The tester should be able to customize these exploits to successfully deploy to different operating systems and successfully compromise the system.</p><p>发生攻击时，通常需要模拟受害者的基础结构，以确保开发阶段能够成功进行。 在信息收集阶段利用的技术总是可以帮助实现这一点，但是，拥有适当的基础架构和系统将使开发阶段更加容易。 如果是量身定制的漏洞利用，渗透测试人员应该能够自定义已经公开的漏洞利用，以成功攻击系统。 漏洞利用的一个常见主题是针对特定版本的操作系统或应用程序。 其原因是由于内存地址根据Service Pack和/或操作系统的新版本而改变。 测试人员应该能够自定义这些漏洞，以成功部署到不同的操作系统并成功危害系统。</p><h1 id="0x06-Zero-Day-Angle"><a href="#0x06-Zero-Day-Angle" class="headerlink" title="0x06 Zero-Day Angle"></a>0x06 Zero-Day Angle</h1><p>In most cases, the zero-day angle is often a last resort for most penetration testers. This type of attack often represents a highly advanced organization that can handle a focused attack against the organization through normal attack methods. In certain scenarios research may be conducted in order to reverse engineer, fuzz, or perform advanced discovery of vulnerabilities that have not been discovered. In the event this type of attack is applicable, ensure that the environment to the best of the attackers knowledge is reproduced to include countermeasure technology.</p><p>在大多数情况下，对于大多数渗透测试人员而言，零日倾角通常是不得已的方法。 这种类型的攻击通常表示一个高级组织，可以通过常规攻击方法对组织进行有针对性的攻击。 在某些情况下，可以进行研究以逆向工程，模糊化或执行尚未发现的漏洞的高级发现。 如果适用这种类型的攻击，请确保复制攻击者所知的环境以包括对策技术。</p><p>In order for zero-day exploits to be successful (or any exploit for that matter), having the same operating system, patches, and countermeasures is highly important on success. Sometimes this information may not be available based on the level of access or enumeration that has occurred.</p><p>为了使零时差攻击（或与此相关的任何攻击）获得成功，拥有相同的操作系统，补丁程序和对策对成功至关重要。 有时，根据已发生的访问或枚举级别，可能无法获得此信息。</p><h2 id="0x0600-模糊测试"><a href="#0x0600-模糊测试" class="headerlink" title="0x0600 模糊测试"></a>0x0600 模糊测试</h2><p>Fuzzing is the ability to recreate a protocol or application and attempt to send data at the application in hopes of identification of a vulnerability. Often times the hopes of a fuzzer is to identify a crash in an application and craft a specific exploit out of it. In the case of fuzzing, the attacker is attempting to create a specific vulnerability out of something that hasn’t been discovered before. As part of a penetration test, if no avenues are identified during the engagement, or the engagement calls for zero-day research; fuzzing techniques should be leveraged in order to identify potentially vulnerable exposures.</p><p>模糊测试是重新创建协议或应用程序并尝试在该应用程序发送数据以识别漏洞的能力。 通常，模糊测试器的希望是识别应用程序中的崩溃并从中进行特定的利用。 在进行模糊测试的情况下，攻击者将尝试从以前未发现的内容中创建特定的漏洞。 作为渗透测试的一部分，如果在参与期间没有发现任何途径，或者参与需要零日研究； 应该利用模糊技术来识别潜在的易受攻击的暴露。</p><h2 id="0x0601-源码分析"><a href="#0x0601-源码分析" class="headerlink" title="0x0601 源码分析"></a>0x0601 源码分析</h2><p>Other avenues that a penetration tester has available is if the source code is available or open-source. If the tester has the ability to look at the source code and identify flaws within the application, zero day exposures can also be identified through these methods.</p><p>渗透测试人员可以使用的其他途径是源代码可用还是开源。 如果测试人员有能力查看源代码并识别应用程序中的缺陷，则也可以通过这些方法确定零日暴露。</p><h2 id="0x0602-利用类型-Types-of-Exploits"><a href="#0x0602-利用类型-Types-of-Exploits" class="headerlink" title="0x0602 利用类型(Types of Exploits)"></a>0x0602 利用类型(Types of Exploits)</h2><p>There are several types of exploits that can be identified during a penetration test that could be classified as a zero-day. Some are listed in this section.</p><p>在渗透测试期间可以识别出几种类型的漏洞，可以将其归类为零时差。 本节中列出了一些。</p><h3 id="0x060200-缓冲区溢出"><a href="#0x060200-缓冲区溢出" class="headerlink" title="0x060200 缓冲区溢出"></a>0x060200 缓冲区溢出</h3><p>Buffer overflows occur due to improper coding techniques. Specifically this usually occurs when a program writes data to a buffer and then overruns the buffer’s boundary and begins to overwrite portions of memory. In buffer overflow exploits the attackers goal is to control a crash and gain code execution on the given system. In a buffer overflow exploit, one of the more common techniques is to overwrite a given register and “jump” to the shellcode.</p><p>缓冲区溢出是由于编码技术不正确造成的。 特别是，这通常在程序将数据写入缓冲区，然后超出缓冲区边界并开始覆盖内存的某些部分时发生。 在缓冲区溢出中，攻击者的目标是控制崩溃并在给定系统上执行代码。 在缓冲区溢出利用中，较常见的技术之一是覆盖给定的寄存器并“跳转”到shellcode。</p><h3 id="0x060201-SEH覆盖-SEH-Overwrites"><a href="#0x060201-SEH覆盖-SEH-Overwrites" class="headerlink" title="0x060201 SEH覆盖(SEH Overwrites)"></a>0x060201 SEH覆盖(SEH Overwrites)</h3><p>SEH overwrites occur when the structured exception handler begins to gracefully close an application. The attacker can manipulate how SEH works, overwrite the base address of the SEH handler and gain control of execution flow through the SEH. This is a common attack leveraged with buffer overflow vulnerability and applications that have been complied with SEH.</p><p>当结构化异常处理程序开始正常关闭应用程序时，将发生SEH覆盖。 攻击者可以操纵SEH的工作方式，覆盖SEH处理程序的基地址，并控制通过SEH的执行流。 这是利用SEH符合的缓冲区溢出漏洞和应用程序的常见攻击。</p><h3 id="0x060202-面向返回编程-Return-Oriented-Programming"><a href="#0x060202-面向返回编程-Return-Oriented-Programming" class="headerlink" title="0x060202 面向返回编程(Return Oriented Programming)"></a>0x060202 面向返回编程(Return Oriented Programming)</h3><p>Return Oriented Programming (ROP) is a technique used during a portion where the user has control of execution flow however data execution prevention (DEP) or other precluding defense mechanisms may be in place. In the situation where DEP is enabled, the attacker does not have direct access to execute specific assembly instructions, therefor the attacker buildsa ROP gadget in order to prep certain Windows API calls or techniques to disable DEP or circumvent DEP. A common method is leveraging the WriteProcessMemory call to copy data from the stack into a writable memory space that can then be executed.</p><p> 面向返回的编程（ROP）是一种在用户可以控制执行流程的部分中使用的技术，但是可以采用数据执行保护（DEP）或其他预防措施。 在启用DEP的情况下，攻击者无权直接执行特定的汇编指令，因此攻击者会构建ROP小工具以准备某些Windows API调用或禁用DEP或规避DEP的技术。 一种常见的方法是利用WriteProcessMemory调用将数据从堆栈复制到可写的存储空间，然后再执行该空间。</p><h2 id="0x0603-流量分析"><a href="#0x0603-流量分析" class="headerlink" title="0x0603 流量分析"></a>0x0603 流量分析</h2><p>Traffic analysis is the technique of identifying what type of information is being sent and the ability to understand and manipulate that traffic. A penetration tester should be able to understand how a protocol works and how it can be manipulated in order to leverage an attack.</p><p>流量分析是一种识别正在发送的信息类型以及了解和操纵该流量的能力的技术。 渗透测试人员应该能够理解协议的工作原理以及如何利用协议来利用攻击。</p><h2 id="0x0604-物理访问"><a href="#0x0604-物理访问" class="headerlink" title="0x0604 物理访问"></a>0x0604 物理访问</h2><p>Physical access during a penetration test can be a viable attack method for attempting to circumvent physical security controls and gain unauthorized access. During a penetration test, the assessor should be able to identify potentially flawed physical security controls and attempt to gain access to the facility if within scope.</p><p>渗透测试期间的物理访问可能是尝试绕过物理安全控制并获得未授权访问的可行攻击方法。 在渗透测试期间，评估人员应该能够识别出可能存在缺陷的物理安全控制，并在范围内尝试访问该设施。</p><h3 id="0x060400-Human-Angle"><a href="#0x060400-Human-Angle" class="headerlink" title="0x060400 Human Angle"></a>0x060400 Human Angle</h3><p>During a physical penetration test, some of the most obvious ways would be to social-engineer your way into the facility and gain access. This requires significant knowledge of how the organization performs business, and everything you learned from the intelligence gathering phase.</p><p>在进行物理渗透测试时，一些最明显的方法是对进入工厂的方式进行社交工程并获得访问权限。 这需要对组织如何开展业务以及从情报收集阶段学到的一切有大量的了解。</p><h3 id="0x060401-PC访问权限"><a href="#0x060401-PC访问权限" class="headerlink" title="0x060401 PC访问权限"></a>0x060401 PC访问权限</h3><p>If physical access is granted to a PC, the penetration tester should be able to attack the PC and gain access through multiple methods that would allow access to the system.</p><p>如果授予PC物理访问权限，则渗透测试人员应该能够攻击PC并通过允许访问系统的多种方法获得访问权限。</p><h2 id="0x0605-近场访问-WiFi"><a href="#0x0605-近场访问-WiFi" class="headerlink" title="0x0605 近场访问(WiFi)"></a>0x0605 近场访问(WiFi)</h2><p>Wireless communications are an avenue for attacks to gain access through RF type communications. The penetration tester should view the FCC radio frequency list to see if the target has registered spectrum frequencies in use.</p><p>无线通信是攻击者通过RF类型通信获得访问权限的途径。 渗透测试仪应查看FCC射频列表，以查看目标是否已使用注册的频谱频率。</p><h3 id="0x060500-WiFi攻击"><a href="#0x060500-WiFi攻击" class="headerlink" title="0x060500 WiFi攻击"></a>0x060500 WiFi攻击</h3><p>Regardless of protocol, there are a number of attacks available for WEP, WPA, WPA2, EAP-FAST, EAP-LEAP, and other avenues. The attacker should be familiar with the various encryption protocols and standards and be able to effectively test the implementation around the controls put in place.</p><p>无论采用哪种协议，WEP，WPA，WPA2，EAP-FAST，EAP-LEAP和其他途径都可以使用多种攻击。 攻击者应该熟悉各种加密协议和标准，并能够有效地测试已实施的控件周围的实现。</p><h3 id="0x060501-攻击用户"><a href="#0x060501-攻击用户" class="headerlink" title="0x060501 攻击用户"></a>0x060501 攻击用户</h3><p>Leveraging rogue access points in order to attack the victim is often a beneficial and a viable attack method. Leveraging a rogue access point to entice victims in order to leverage exploits or steal sensitive information should be performed during a wireless assessment. There are several common techniques in use of this, but most commonly the attacker would setup a wireless access point with the same name or an enticing name in order for the victim to connect.</p><p>利用流氓接入点攻击受害者通常是一种有益且可行的攻击方法。 在无线评估期间，应利用恶意接入点诱使受害者利用攻击或窃取敏感信息。 有几种常用的技术可以使用，但是最常见的是，攻击者会设置一个具有相同名称或诱人名称的无线访问点，以便受害者连接。</p><h1 id="0x07-攻击途径示例"><a href="#0x07-攻击途径示例" class="headerlink" title="0x07 攻击途径示例"></a>0x07 攻击途径示例</h1><p>In any scenario, the attacks should consist based on the scenario that is within scope of the engagement. Below is a list of several attack avenues to consider based on scenario but is by no means a comprehensive list.</p><p>在任何情况下，攻击都应基于参与范围内的情况进行。 以下是根据场景考虑的几种攻击途径的列表，但绝不是全面的列表。</p><p>Web Application Attacks Social-Engineering Physical Attack Avenues Memory Based Exploits (i.e. buffer/heap overflows, memory corruptions, use-after-free). Man in the Middle VLAN Hopping USB/Flash Drive deployment Reverse Engineering Zero-Day Angle Attacking the user Encryption Cracking Graphics Processing Unit (GPU) Cracking Traffic Analysis Firewire Routing protocols Phishing with Pretexting Employee Impersonation</p><p>Web应用程序攻击社会工程物理攻击途径基于内存的漏洞（即缓冲区/堆溢出，内存损坏，无偿使用）。 处于中间VLAN中的人跳动USB /闪存驱动器部署逆向工程零日角度攻击用户加密破解图形处理单元（GPU）破解流量分析火线路由协议假冒员工冒名顶替网络钓鱼</p><p>Again, these examples are only basic avenues for attack based on the scenario you are performing for the organization. The value from a penetration test comes from creativity and the ability to identify exposures and exploit them in a precise manner.</p><p>同样，这些示例仅是根据您为组织执行的方案进行攻击的基本途径。 渗透测试的价值来自创造力和识别风险并以精确方式加以利用的能力。</p><h1 id="0x08-总体目标-Overall-Objective"><a href="#0x08-总体目标-Overall-Objective" class="headerlink" title="0x08 总体目标(Overall Objective)"></a>0x08 总体目标(Overall Objective)</h1><p>In the pre-engagement interaction phase with the customer, a clear definition of the overall objectives of the penetration test should have been communicated. In the case of the exploitation phase, the biggest challenge is identifying the least path of resistance into the organization without detection and having the most impact on the organizations ability to generate revenue.</p><p>在与客户进行接触前的互动阶段，应该传达渗透测试总体目标的明确定义。 在开发阶段，最大的挑战是在不被发现的情况下，确定进入组织的阻力最小的途径，并且对组织创收能力的影响最大。</p><p>By performing the prior phases properly, a clear understanding of how the organization functions and makes money should be relatively understood. From the exploitation phase and into the post-exploitation phase, the attack vectors should rely solely on the mission of circumventing security controls in order to represent how the organization can suffer substantial losses through a targeted attack against the organization.</p><p>通过正确地执行先前的阶段，应该相对了解组织的运作方式和赚钱方式。 从开发阶段到进入开发后阶段，攻击媒介应仅依赖于规避安全控制的任务，以表示组织如何通过针对组织的有针对性的攻击而遭受重大损失。</p>]]></content>
    
    
    <categories>
      
      <category>渗透测试</category>
      
    </categories>
    
    
    <tags>
      
      <tag>渗透测试</tag>
      
      <tag>标准</tag>
      
      <tag>Google翻译</tag>
      
      <tag>漏洞利用</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>四、漏洞分析</title>
    <link href="/2020/12/29/%E5%9B%9B%E3%80%81%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/"/>
    <url>/2020/12/29/%E5%9B%9B%E3%80%81%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h1 id="漏洞分析"><a href="#漏洞分析" class="headerlink" title="漏洞分析"></a>漏洞分析</h1><h1 id="0x00-漏洞测试"><a href="#0x00-漏洞测试" class="headerlink" title="0x00 漏洞测试"></a>0x00 漏洞测试</h1><p>Vulnerability testing is the process of discovering flaws in systems and applications which can be leveraged by an attacker. These flaws can range anywhere from host and service misconfiguration, or insecure application design. Although the process used to look for flaws varies and is highly dependent on the particular component being tested, some key principals apply to the process.</p><p>漏洞测试是发现攻击者可以利用的系统和应用程序缺陷的过程。 这些缺陷的范围很广，从主机和服务的错误配置到不安全的应用程序设计。 尽管用于查找缺陷的过程各不相同，并且高度依赖于要测试的特定组件，但是某些关键原则适用于该过程。</p><p>When conducting vulnerability analysis of any type the tester should properly scope the testing for applicable depth and breadth to meet the goals and/or requirements of the desired outcome. Depth values can include such things as the location of an assessment tool, authentication requirements, etc. For example; in some cases it maybe the goal of the test to validate mitigation is in place and working and the vulnerability is not accessible; while in other instances the goal maybe to test every applicable variable with authenticated access in an effort to discover all applicable vulnerabilities. Whatever your scope, the testing should be tailored to meet the depth requirements to reach your goals. Depth of testing should always be validated to ensure the results of the assessment meet the expectation (i.e. did all the machines authenticate, etc.). In addition to depth, breadth must also be taken into consideration when conducting vulnerability testing. Breadth values can include things such as target networks, segments, hosts, application, inventories, etc. At its simplest element, your testing may be to find all the vulnerabilities on a host system; while in other instances you may need to find all the vulnerabilities on hosts with in a given inventory or boundary. Additionally breadth of testing should always be validated to ensure you have met your testing scope (i.e. was every machine in the inventory alive at the time of scanning? If not, why).</p><p>在进行任何类型的漏洞分析时，测试人员应适当调整测试的适用深度和广度，以达到预期结果的目标和/或要求。深度值可以包括诸如评估工具的位置，身份验证要求等内容。在某些情况下，验证缓解的测试目标可能已经到位并且可以正常工作，并且该漏洞无法访问；而在其他情况下，目标可能是使用经过身份验证的访问来测试每个适用的变量，以发现所有适用的漏洞。无论您的范围是什么，测试都应量身定制，以满足达到目标的深度要求。应始终验证测试深度，以确保评估结果符合预期（即所有机器都进行了身份验证等）。除了深度之外，在进行漏洞测试时还必须考虑广度。广度值可以包括目标网络，网段，主机，应用程序，清单等内容。最简单的测试可能是查找主机系统上的所有漏洞。而在其他情况下，您可能需要查找具有给定清单或边界的主机上的所有漏洞。此外，应始终验证测试的广度，以确保满足测试范围（即，扫描时库存中的每台计算机是否都处于活动状态？如果不是，原因为何）。</p><h1 id="0x01-有效漏洞"><a href="#0x01-有效漏洞" class="headerlink" title="0x01 有效漏洞"></a>0x01 有效漏洞</h1><p>Active testing involves direct interaction with the component being tested for security vulnerabilities. This could be low level components such as the TCP stack on a network device, or it could be components higher up on the stack such as the web based interface used to administer such a device. There are two distinct ways to interact with the target component: automated, and manual.</p><p>主动测试涉及与要测试的组件的安全漏洞的直接交互。 这可能是低级组件，例如网络设备上的TCP堆栈，也可能是栈上较高的组件，例如用于管理此类设备的基于Web的界面。 与目标组件进行交互的方式有两种：自动和手动。</p><p><strong>Automated</strong></p><p>Automated testing utilizes software to interact with a target, examine responses, and determine whether a vulnerability exists based on those responses. An automated process can help reduce time and labor requirements. For example, while it is simple to connect to a single TCP port on a system to determine whether it is open to receive incoming data, performing this step once for each of the available 65,535 possible ports requires a significant amount of time if done manually. When such a test must be repeated on multiple network addresses, the time required may simply be too great to allow testing to be completed without some form of automation. Using software to perform these functions allows the tester to accomplish the task at hand, and focus their attention on processing data and performing tasks which are better suited to manual testing.</p><p>自动化测试利用软件与目标交互，检查响应并根据这些响应确定是否存在漏洞。 自动化过程可以帮助减少时间和劳动力需求。 例如，虽然很容易连接到系统上的单个TCP端口来确定它是否已打开以接收传入的数据，但是如果手动进行，则对每个可用的65,535个可能的端口执行一次此步骤需要大量的时间。 当必须在多个网络地址上重复进行这样的测试时，所需的时间可能太长而无法在没有某种形式的自动化的情况下完成测试。 使用软件执行这些功能可以使测试人员完成手头的任务，并将精力集中在处理数据和执行更适合手动测试的任务上。</p><p><strong>Network/General Vulnerability Scanners</strong></p><p><em>Port Based</em></p><p>An automated port based scan is generally one of the first steps in a traditional penetration test because it helps obtain a basic overview of what may be available on the target network or host. Port based scanners check to determine whether a port on a remote host is able to receive a connection. Generally, this will involve the protocols which utilize IP (such as TCP, UDP, ICMP, etc.), However, ports on other network protocols could be present as well dependent on the environment (for example, it’s quite common in large mainframe environments for SNA to be in use). Typically, a port can have one of two possible states:</p><p>基于端口的自动扫描通常是传统渗透测试的第一步，因为它有助于获得目标网络或主机上可能可用内容的基本概述。 基于端口的扫描程序检查以确定远程主机上的端口是否能够接收连接。 通常，这将涉及利用IP的协议（例如TCP，UDP，ICMP等），但是，其他网络协议上的端口也可能取决于环境而存在（例如，在大型主机环境中很常见） 以便使用SNA）。 通常，端口可以具有以下两种可能状态之一：</p><figure class="highlight vhdl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs vhdl"><span class="hljs-keyword">Open</span> - the <span class="hljs-keyword">port</span> <span class="hljs-keyword">is</span> able <span class="hljs-keyword">to</span> receive data<br>Closed - the <span class="hljs-keyword">port</span> <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> able <span class="hljs-keyword">to</span> receive data<br></code></pre></td></tr></table></figure><p>A scanner may list other states, such as “filtered”, if it is unable to accurately determine whether a given port is open or closed.</p><p>如果扫描仪无法准确确定给定端口是打开还是关闭，它可能会列出其他状态，例如“已过滤”。</p><p>When the scanner determines that a port is open, a presumption is made by the scanner as to whether a vulnerability is present or not. For example, if a port based scanner connects to TCP port 23, and that port is listening, the scanner is likely to report that the telnet service is available on the remote host, and flag it as having a clear text authentication protocol enabled.</p><p>当扫描程序确定端口已打开时，扫描程序将假定是否存在漏洞。 例如，如果基于端口的扫描器连接到TCP端口23，并且该端口正在侦听，则扫描器可能会报告远程主机上有telnet服务可用，并将其标记为启用了明文身份验证协议。</p><p><strong>Service Based</strong></p><p>A service based vulnerability scanner is one which utilizes specific protocols to communicate with open ports on a remote host, to determine more about the service that is running on that port. This is more precise than a port scan, because it does not rely on the port alone to determine what service is running. For example, a port scan may be able to identify that TCP port 8000 is open on a host, but it will not know based on that information alone what service is running there. A service scanner would attempt to communicate with the port using different protocols. If the service running on port 8000 is able to correctly communicate using HTTP, then it will be identified as a web server.</p><p>基于服务的漏洞扫描程序是一种利用特定协议与远程主机上的开放端口进行通信，以确定有关在该端口上运行的服务的更多信息的漏洞扫描程序。 这比端口扫描更为精确，因为它不仅仅依靠端口来确定正在运行的服务。 例如，端口扫描可能能够识别TCP端口8000在主机上处于打开状态，但是仅根据该信息，它不会知道那里正在运行什么服务。 服务扫描程序将尝试使用不同的协议与端口进行通信。 如果在端口8000上运行的服务能够使用HTTP正确通信，则它将被识别为Web服务器。</p><p><strong>Banner Grabbing</strong></p><p>Banner grabbing is the process of connecting to a specific port and examining data returned from the remote host to identify the service/application bound to that port. Often in the connection process, software will provide an identification string which may include information such as the name of the application, or information about which specific version of the software is running.</p><p>标语抓取是连接到特定端口并检查从远程主机返回的数据以标识绑定到该端口的服务/应用程序的过程。 通常在连接过程中，软件会提供一个标识字符串，其中可能包含诸如应用程序名称之类的信息，或者有关正在运行哪个特定版本软件的信息。</p><p><strong>Web Application Scanners</strong></p><p><strong>General application flaw scanners</strong></p><p>Most web application scans start with the address of a website, web application, or web service. The scanner then crawls the site by following links and directory structures. After compiling a list of webpages, resources, services and/or other media offered, the scanner will perform tests, or audits against the results of the crawl. For example, if a webpage discovered in the crawl has form fields, the scanner might attempt SQL injection or cross-site scripting. If the crawled page contained errors, the scanner might look for sensitive information displayed in the error detail, and so on.</p><p>大多数Web应用程序扫描均以网站，Web应用程序或Web服务的地址开头。 然后，扫描程序将通过遵循链接和目录结构对站点进行爬网。 编译提供的网页，资源，服务和/或其他媒体的列表后，扫描程序将执行测试或对爬网结果进行审核。 例如，如果在爬网中发现的网页具有表单字段，则扫描程序可能会尝试SQL注入或跨站点脚本。 如果爬网的页面包含错误，则扫描程序可能会寻找错误详细信息中显示的敏感信息，依此类推。</p><p>It should be noted that crawling and testing phases can be staggered and performed at the same time to reduce overall scanning time. This is the default behavior for many web application scanners.</p><p>应当注意，爬行和测试阶段可以错开并同时执行，以减少总体扫描时间。 这是许多Web应用程序扫描程序的默认行为。</p><p><strong>Directory Listing/Brute Forcing</strong></p><p>Suppose there are directories available on the website that the crawler won’t find by following links. Without prior knowledge of these directories, provided by the user, the scanner has at least two additional options.</p><p>假设通过以下链接，爬网程序无法找到网站上的可用目录。 在没有用户提供的这些目录的先验知识的情况下，扫描仪至少具有两个附加选项。</p><p>The scanner/crawler can search for “common” directories. These are directories with names and variants of names that are commonly found, and are included in a list that has been compiled as the result of years of experience and scanning. Most web applications have a “built-in” list of this sort, while some penetration testers maintain their own custom lists. Sometimes directory names are unique enough that they can be used to identify a 3rd party web application with reasonably high accuracy. An accurate directory list can often be the key to finding the “administrative” portion of a website - a portion most penetration testers should be highly interested in discovering.</p><p>扫描仪/搜寻器可以搜索“公用”目录。 这些是具有常见名称的名称和名称变体的目录，并包含在经过多年经验和扫描而编制的列表中。 大多数Web应用程序都有这种“内置”列表，而某些渗透测试人员则维护自己的自定义列表。 有时，目录名称的唯一性足以使它们可用于以相当高的准确性识别第三方Web应用程序。 准确的目录列表通常可能是找到网站“管理”部分的关键-大多数渗透测试人员应该对发现这一部分非常感兴趣。</p><p>Brute forcing directories is a similar approach, though instead of using a static list, a tool is used to enumerate every possibility a directory name could have. The downside of using this approach is that it has the potential to crash or inundate the web server with requests and thus cause a denial-of-service condition. Care should be taken to perform directory brute forcing while someone is keeping a close watch on the condition of the web server, especially in a production setting.</p><p>强制目录是一种类似的方法，尽管不是使用静态列表，而是使用一种工具来枚举目录名称可能具有的所有可能性。 使用此方法的缺点是，它可能使Web服务器崩溃或被请求淹没，从而导致拒绝服务情况。 当有人密切注意Web服务器的状况时，尤其是在生产环境中，应小心执行目录暴力破解。</p><p>The reason you as the penetration tester would want to perform directory listing is to extend your attack field or to find directories that could contain sensitive information (which depending on the goal of the penetration test, may lead to a major finding within it).</p><p>作为渗透测试人员，您希望执行目录列表的原因是为了扩展攻击范围或查找可能包含敏感信息的目录（这取决于渗透测试的目标，可能会在其中产生重大发现）。</p><p><strong>Web Server Version/Vulnerability Identification</strong></p><p>Many web application scanners will attempt to compare the version of the web server with known vulnerable versions in security advisories. This approach can sometimes lead to false positives; as there are some cases where open-source web servers are forked or copied and given new names, banners, and assigned different version numbers. Additional steps should be taken to verify that the web server is, in fact, running what the banner, or web scanner reports.</p><p>许多Web应用程序扫描程序将尝试在安全公告中将Web服务器的版本与已知的易受攻击的版本进行比较。 这种方法有时会导致误报。 因为在某些情况下，派生或复制开源Web服务器并为其赋予新名称，标语并分配了不同的版本号。 应该采取其他步骤来验证Web服务器实际上是否正在运行横幅或Web扫描程序报告的内容。</p><p><em>Methods</em></p><p>Several web server methods are considered insecure, and can allow attackers to gain varying levels of access to web server content. The fact that these methods are part of the web server software, and not web site content differentiates it from other vulnerabilities discussed thus far. Some insecure methods include:</p><p>几种Web服务器方法被认为是不安全的，它们可以使攻击者获得对Web服务器内容的不同级别的访问。 这些方法是Web服务器软件的一部分，而不是Web站点内容，这一事实将其与迄今为止讨论的其他漏洞区分开来。 一些不安全的方法包括：</p><p>OPTIONS</p><p>While the HTTP OPTIONS method is not insecure by itself, it can allow an attacker to easily enumerate the kinds of HTTP methods accepted by the target server. Note, the OPTIONS method is not always accurate and each of the methods below should be validated individually.</p><p>尽管HTTP OPTIONS方法本身并不是不安全的，但它可以使攻击者轻松枚举目标服务器接受的HTTP方法的种类。 注意，OPTIONS方法并不总是准确的，下面的每个方法都应单独进行验证。</p><p>PUT/DELETE</p><p>Using the PUT method, an attacker can upload malicious content such as HTML pages that could be used to transfer information, alter web content or install malicious software on the web server. Using the DELETE method an attacker could remove content or deface a site causing a disruption of service.</p><p>使用PUT方法，攻击者可以上载诸如HTML页面之类的恶意内容，这些内容可能用于传输信息，更改Web内容或在Web服务器上安装恶意软件。 攻击者可以使用DELETE方法删除内容或破坏站点，从而导致服务中断。</p><p>Additionally, modern REST applications use PUT in a different manner:</p><p>此外，现代REST应用程序以不同的方式使用PUT：</p><p>Create-&gt;POST Read-&gt;GET Update-&gt;PUT Delete-&gt;DELETE</p><p>WebDAV</p><p>WebDAV is a component of the Microsoft Internet Information Server (IIS). WebDAV stands for “Web-based Distributed Authoring and Versioning” and is used for editing and file management. WebDAV extensions are used by administrators to manage and edit Web content remotely on IIS Web servers and can include PROPFIND, COPY, MOVE, PROPPATCH, MKCOL, LOCK, and UNLOCK .WebDAV interacts with core operating system components, which can expose a system to several possible vulnerabilities. Some of these potential risks include:</p><p>WebDAV是Microsoft Internet信息服务器（IIS）的组件。 WebDAV代表“基于Web的分布式创作和版本控制”，并用于编辑和文件管理。 管理员使用WebDAV扩展来在IIS Web服务器上远程管理和编辑Web内容，其中可以包括PROPFIND，COPY，MOVE，PROPPATCH，MKCOL，LOCK和UNLOCK。WebDAV与核心操作系统组件进行交互，从而使系统暴露于多个可能的漏洞。 这些潜在风险包括：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs css">Buffer <span class="hljs-attribute">overflow</span> conditions due <span class="hljs-selector-tag">to</span> improper handling of user requests<br>Denial-of-service conditions <span class="hljs-selector-tag">from</span> malformed requests<br>Domain based scripting attacks<br>Privilege escalation<br>Execution of arbitrary <span class="hljs-selector-tag">code</span><br></code></pre></td></tr></table></figure><p>TRACE/TRACK</p><p>Modern web servers support the TRACE HTTP method, which contains a flaw that can lead to unauthorized information disclosure. The TRACE method is used to debug web server connections and can allow the client to see what is being received at the other end of the request chain. Enabled by default in all major web servers, a remote attacker may abuse the HTTP TRACE functionality to disclose sensitive information resulting in a loss of confidentiality.</p><p>现代Web服务器支持TRACE HTTP方法，该方法包含可能导致未经授权的信息泄露的缺陷。 TRACE方法用于调试Web服务器连接，并且可以允许客户端查看请求链另一端正在接收的内容。 默认情况下，所有主要的Web服务器都启用了远程攻击者，远程攻击者可能会滥用HTTP TRACE功能来泄露敏感信息，从而导致机密性下降。</p><p><strong>Network Vulnerability Scanners/Specific Protocols</strong></p><p><strong>VPN</strong></p><p>Conventional vulnerability assessment tools are not capable of performing the correct protocol negotiations with VPN devices that service Internet Key Exchange (IKE). In situations where IKE is in use, it will be necessary to use additional toolkits that can perform functions such as accurate fingerprinting, back off patterns and identify authentication mechanisms that are in use. By identifying these attributes of a VPN device, weaknesses can be identified in running code versions as well as authentication types such as static preshared keys.</p><p>传统的漏洞评估工具无法与为Internet密钥交换（IKE）服务的VPN设备执行正确的协议协商。 在使用IKE的情况下，有必要使用其他工具包来执行诸如准确的指纹识别，退回模式和识别正在使用的身份验证机制之类的功能。 通过识别VPN设备的这些属性，可以识别运行代码版本以及身份验证类型（例如静态预共享密钥）中的弱点。</p><p><strong>Voice Network Scanners</strong></p><p><em>War Dialing</em></p><p>Many organizations still utilize out of band access over telephone lines. Using vulnerability assessment tools that are designed to conduct war-dialing can determine weaknesses in authentication and network architecture.</p><p>许多组织仍在通过电话线使用带外访问。 使用旨在进行战争拨号的漏洞评估工具可以确定身份验证和网络体系结构中的弱点。</p><p><em>VoIP</em></p><p>Voice over IP technologies are now abundant within most organizations. Many tools have been developed to conduct vulnerability analysis of VoIP infrastructures. Using these tools, one can identify if VoIP networks are properly segmented and potentials for leveraging these networks to access core infrastructure systems or record phone conversations on a target network may exist.</p><p>IP语音技术现在在大多数组织中都很丰富。 已经开发了许多工具来进行VoIP基础结构的漏洞分析。 使用这些工具，可以确定VoIP网络是否正确分段，并且可能存在利用这些网络访问核心基础结构系统或在目标网络上记录电话对话的潜力。</p><p><strong>Manual Direct Connections</strong></p><p>As with any automated process or technology, the margin for error always exists. Instabilities in systems, network devices and network connectivity may introduce inaccurate results during testing. It is always recommended to execute manual direct connections to each protocol or service available on a target system to validate the results of automated testing as well as identifying all potential attack vectors and previously unidentified weaknesses.</p><p>与任何自动化过程或技术一样，错误的余地总是存在的。 系统，网络设备和网络连接的不稳定性可能会在测试期间引入不正确的结果。 始终建议对目标系统上可用的每个协议或服务执行手动直接连接，以验证自动测试的结果以及识别所有潜在的攻击媒介和以前未发现的弱点。</p><p><strong>Obfuscated</strong></p><p><em>Multiple Exit Nodes</em></p><p>Security monitoring and defense systems operate under the pretense of identifying malicious activity from a specific IP address. In situations where Intrusion Detection systems are deployed and monitoring activity, sourcing assessment and attack activities from multiple IP addresses provide more accurate results and lessen the opportunity for a monitoring device on a target network to identify and respond. Technologies such as TOR proxies can provide a means to conduct assessment activities without sourcing from a single IP address.</p><p>安全监视和防御系统会伪装成从特定IP地址识别恶意活动。 在部署了入侵检测系统并监视活动的情况下，来自多个IP地址的源评估和攻击活动可提供更准确的结果，并减少目标网络上的监视设备进行识别和响应的机会。 TOR代理之类的技术可以提供一种进行评估活动的方法，而无需从单个IP地址采购。</p><p><em>IDS Evasion</em></p><p>When conducting assessment activities against a target environment where IDS technologies are deployed, it may be necessary to perform evasion. Using methods such as string manipulation, polymorphism, session splicing, and fragmentation can provide more accurate results while bypassing signature matching patterns implemented in IDS devices.</p><p>当针对部署了IDS技术的目标环境进行评估活动时，可能有必要进行规避。 使用诸如字符串操作，多态性，会话拼接和分段之类的方法可以提供更准确的结果，同时绕过IDS设备中实现的签名匹配模式。</p><h1 id="0x02-虚假漏洞"><a href="#0x02-虚假漏洞" class="headerlink" title="0x02 虚假漏洞"></a>0x02 虚假漏洞</h1><p><strong>Metadata Analysis</strong></p><p>Metadata analysis involves looking at data that describes a file, as opposed to the file data itself. A Microsoft Office document for example, might list the document author, company, when the document was last saved, when the document was created, and so on. Many documents even allow for the entry of custom metadata. This could potentially contain internal addresses and paths to servers, internal IP addresses, and other information a penetration tester could use to gain additional access or information.</p><p>元数据分析涉及查看描述文件的数据，而不是文件数据本身。 例如，一个Microsoft Office文档可能会列出文档作者，公司，上次保存文档的时间，创建文档的时间等等。 许多文档甚至允许输入自定义元数据。 它可能包含内部地址和服务器路径，内部IP地址以及渗透测试人员可以用来获取其他访问或信息的其他信息。</p><p>Though metadata is quite common on documents located on a company’s internal network, companies should take care to purge metadata before making documents available to the public, or on the public Internet. For this reason, any metadata an attacker could gain access to passively (without directly attacking the target) should be considered a security issue.</p><p>尽管元数据在公司内部网络上的文档中非常普遍，但是公司在将文档提供给公众或公共Internet之前，应谨慎清除元数据。 因此，攻击者可以被动地访问（而不直接攻击目标）的任何元数据都应被视为安全问题。</p><p><strong>Traffic Monitoring</strong></p><p>Traffic monitoring is the concept of connecting to an internal network and capturing data for offline analysis. Route poisoning is excluded from this phase as these create “noise” on the network and can easily be detected. It is often surprising how much sensitive data can be gleaned from a “switched” network. This “leaking of data” onto a switched network can be categorized as follows:</p><p>流量监视是连接到内部网络并捕获数据以进行脱机分析的概念。 此阶段排除了路由中毒，因为它们会在网络上产生“噪声”，并且很容易被检测到。 令人惊讶的是，可以从“交换”网络中收集到多少敏感数据。 可以将这种“数据泄漏”到交换网络中的方法如下：</p><p>ARP/MAC cache overflow, causing switched packets to be broadcast - this is common on Cisco switches that have improper ARP/MAC cache timing configurations.</p><p>ARP / MAC缓存溢出，导致交换的数据包被广播-这在ARP / MAC缓存定时配置不正确的Cisco交换机上很常见。</p><p>Etherleak - some older network drivers and some embedded drivers will use data from system memory to pad ARP packets. If enough ARP packets can be collected, sensitive information from internal memory can be captured</p><p>Etherleak-一些较旧的网络驱动程序和某些嵌入式驱动程序将使用系统内存中的数据填充ARP数据包。 如果可以收集足够的ARP数据包，则可以捕获内部存储器中的敏感信息</p><p>Misconfigured clusters or load balancers 群集或负载均衡器配置错误</p><p>Hubs plugged into the network Note that some of these categories only result in data leakage to a single subnet, while others can result in leakage to much larger network segments.</p><p>集线器插入网络注意，其中一些类别只会导致数据泄漏到单个子网，而其他类别可能导致泄漏到更大的网络段。</p><h1 id="0x03-漏洞验证"><a href="#0x03-漏洞验证" class="headerlink" title="0x03 漏洞验证"></a>0x03 漏洞验证</h1><p><strong>Correlation between Tools</strong></p><p>When working with multiple tools the need for correlation of findings can become complicated. Correlation can be broken down into two distinct styles, specific and categorical correlation of items, both are useful based on the type of information, metrics and statistics you are trying to gather on a given target.</p><p>当使用多种工具时，结果相关性的需求可能会变得复杂。 关联可以分为两种不同的样式，即项目的特定和分类关联，这两种方式都可以根据您要在给定目标上收集的信息类型，指标和统计信息来使用。</p><p>Specific correlation relates to a specific definable issue such as vulnerability ID, CVE, OSVDB, vendor indexing numbers, known issue with a software product, etc. and can be grouped with micro factors such as hostname, IP, FQDN, MAC Address etc. An example of this would be grouping the findings for host x by CVE number as they would index the same issue in multiple tools.</p><p>特定关联与特定的可定义问题有关，例如漏洞ID，CVE，OSVDB，供应商索引号，软件产品的已知问题等，并且可以与诸如主机名，IP，FQDN，MAC地址等微观因素分组。 例如，可以将主机x的发现结果按CVE编号分组，因为它们将在多个工具中索引同一问题。</p><p>Categorical correlation relates to a categorical structure for issues such as in compliance frameworks (i.e. NIST SP 800-53, DoD 5300 Series, PCI, HIPPA, OWASP List, etc.) that allow you to group items by macro factors such as vulnerability types, configuration issues, etc. An example of this would be grouping all the findings for hosts with default passwords into a group for password complexity within NIST 800-53 (IA-5).</p><p>分类相关性涉及问题的分类结构，例如合规性框架（例如，NIST SP 800-53，DoD 5300系列，PCI，HIPPA，OWASP列表等）中的问题，这些问题使您可以根据宏观因素（例如漏洞类型， 例如，配置问题等。在NIST 800-53（IA-5）中，将具有默认密码的主机的所有发现分组为一个分组，以解决密码复杂性问题。</p><p>In most cases penetration testers are going to focus on the micro issues of specific vulnerabilities found in redundancy between multiple tools on the same host. This redundancy can skew the statistical results in the test output leading to a false increased risk profile.</p><p>在大多数情况下，渗透测试人员将专注于特定漏洞的微观问题，这些漏洞是在同一主机上的多个工具之间的冗余中发现的。 这种冗余可能会使测试输出中的统计结果产生偏差，从而导致错误的风险分布增加。</p><p>The inverse of this is with an over reduction or simplification in macro correlation (i.e. top 10/20 lists) as the results can skew the output resulting in a false reduced risk profile.</p><p>反之则是宏观相关性的过度降低或简化（即排名前10/20的列表），因为结果可能会使输出偏斜，从而导致错误的风险分布降低。</p><p><strong>Manual Testing/Protocol Specific</strong></p><p><strong>VPN</strong></p><p><em>Fingerprinting</em></p><p>Fingerprinting is useful to determine the type of VPN device and correct version of code released installed. By accurately fingerprinting the device, proper research and analysis can then be conducted against the target system.</p><p>指纹对确定VPN设备的类型和已安装的已发布代码的正确版本很有用。 通过对设备进行准确的指纹识别，可以对目标系统进行适当的研究和分析。</p><p><em>Authentication</em></p><p>VPN devices can operate with various forms of authentication. Using VPN toolkits that are not part of conventional vulnerability assessment tools allow for proper identification of the authentication mechanisms and determine weaknesses that may exist such as pre-shared keys or default group IDs.</p><p>VPN设备可以使用各种形式的身份验证进行操作。 使用不属于常规漏洞评估工具的VPN工具包，可以正确识别身份验证机制并确定可能存在的弱点，例如预共享密钥或默认组ID。</p><p><strong>Citrix</strong></p><p><em>Enumeration</em></p><p>Many default installations and poorly configured Citrix appliances provide a means to enumerate published applications and determine valid usernames that are configured to authenticate to the device. This information becomes crucial during brute force attacks and attempts to break out of predefined profiles for authorized users.</p><p>许多默认安装和配置不佳的Citrix设备提供了一种枚举已发布的应用程序并确定配置为对设备进行身份验证的有效用户名的方法。 该信息在蛮力攻击期间很重要，并试图突破授权用户的预定义配置文件。</p><p><strong>DNS</strong></p><p>Domain Name Systems can offer an abundance of information to an attacker when they are not properly hardened. Version information allow for proper identification and accurate research analysis. Weaknesses such as zone transfers provide an exhaustive list of additional targets for attack as well as information leakage of potentially sensitive data pertaining to the target organization.</p><p>如果域名系统未得到适当的加固，它们可以向攻击者提供大量信息。 版本信息允许正确识别和准确的研究分析。 诸如区域传输之类的弱点提供了针对攻击的其他目标的详尽列表，以及与目标组织有关的潜在敏感数据的信息泄漏。</p><p><strong>Web</strong></p><p>Web services provide a large landscape for an attacker. Unlike most other protocols and services, web services are often found running on multiple ports of a single system. Administrators may focus their hardening on the common ports for web services or published directories and neglect to properly harden additional attributes. Web services should always be reviewed in a manual fashion as automated assessment tools are not capable of identifying most weaknesses in their services.</p><p>Web服务为攻击者提供了广阔的前景。 与大多数其他协议和服务不同，通常可以在单个系统的多个端口上运行Web服务。 管理员可能会将其强化工作集中在Web服务或已发布目录的通用端口上，而忽略了适当强化其他属性的情况。 Web服务应始终以手动方式进行检查，因为自动评估工具无法识别其服务中的大多数弱点。</p><p><strong>Mail</strong></p><p>Mail servers can provide an abundance of information about a target organization. Using inherent functions in the target device, confirmation of valid accounts can be conducted as well as developing a list of potential usernames for additional attacks on other systems. Vulnerabilities such as mail relaying can be leveraged for additional attacks on the organization such as phishing. Often, mail servers will provide a web interface for remote access that can be targeted in brute force campaigns.</p><p>邮件服务器可以提供有关目标组织的大量信息。 使用目标设备中的固有功能，可以进行有效帐户的确认以及为其他系统上的其他攻击开发潜在用户名的列表。 可以利用诸如邮件中继之类的漏洞来对组织进行其他攻击，例如网络钓鱼。 通常，邮件服务器会为远程访问提供一个Web界面，该界面可用于暴力活动。</p><p><strong>Attack Avenues</strong></p><p><strong>Creation of attack trees</strong></p><p>During a security assessment, it is crucial to the accuracy of the final report to develop an attack tree as testing progresses throughout the engagement. As new systems, services and potential vulnerabilities are identified; an attack tree should be developed and regularly updated. This is especially important during the exploitation phases of the engagement as one point of entry that materializes could be repeated across other vectors mapped out during the development of the attack tree.</p><p>在安全评估期间，随着测试在整个参与过程中的进展，制定攻击树对于最终报告的准确性至关重要。 随着新系统，服务和潜在漏洞的发现； 应该开发攻击树并定期更新。 在参与的开发阶段，这一点尤其重要，因为可以在攻击树的开发过程中跨制定的其他向量上重复实现的一个入口点。</p><p><strong>Isolated Lab Testing</strong></p><p>The accuracy of vulnerability analysis and exploitation is substantially greater when replicated environments are setup in an isolated lab. Often times, systems may be hardened with specific control sets or additional protection mechanisms. By designing a lab that mimics that of the target organization, the consultant can ensure that the vulnerabilities identified and exploits attempted against the desired targets are reliable and lessen the opportunity for inaccurate results or system inoperability.</p><p>在隔离的实验室中设置复制环境时，漏洞分析和利用的准确性会大大提高。 通常，系统可以使用特定的控制集或其他保护机制进行加固。 通过设计一个模仿目标组织的实验室，顾问可以确保所发现的漏洞和针对期望目标的攻击是可靠的，并减少了获得不准确结果或系统无法操作的机会。</p><p><strong>Visual Confirmation</strong></p><p><em>Manual Connection with Review</em></p><p>While proper correlation can help reduce false findings and increase overall accuracy, there is no substitute for visually inspecting a target system. Assessment tools are designed to review the results of a protocol/service connection or the response and compare to known signatures of vulnerabilities. However, tools are not always accurate in identifying services on uncommon ports or custom logic that may be built into an application. By manually assessing a target system, its services available and the applications that provide functionality for those services, a tester can ensure that proper validation and vulnerability identification have been completed.</p><p>尽管适当的相关性可以帮助减少错误的发现并提高总体准确性，但是没有替代方法可以目视检查目标系统。 评估工具旨在检查协议/服务连接或响应的结果，并与已知的漏洞签名进行比较。 但是，在识别不常见端口上的服务或应用程序中可能内置的自定义逻辑时，工具并不总是准确的。 通过手动评估目标系统，可用的服务以及为这些服务提供功能的应用程序，测试人员可以确保已完成正确的验证和漏洞识别。</p><h1 id="0x04-漏洞研究"><a href="#0x04-漏洞研究" class="headerlink" title="0x04 漏洞研究"></a>0x04 漏洞研究</h1><p><strong>Public Research</strong></p><p>Once a vulnerability has been reported in a target system, it is necessary to determine the accuracy of the identification of the issue, and to research the potential exploitability of the vulnerability within the scope of the penetration test. In many cases, the vulnerability will be a reported software vulnerability in a commercial or open source software package, and in other cases the vulnerability can be a flaw in a business process, or a common administrative error like misconfiguration or default password usage.</p><p>一旦在目标系统中报告了漏洞，就必须确定问题标识的准确性，并研究在渗透测试范围内漏洞的潜在利用性。 在许多情况下，该漏洞将是商业或开源软件包中的已报告软件漏洞，而在其他情况下，该漏洞可能是业务流程中的缺陷，或者是常见的管理错误，例如配置错误或默认密码使用。</p><p><em>Vulnerability Databases</em></p><p>Vulnerability databases can be used to verify an issue reported by an automated tool, or to manually review the vulnerability of a target application. Most tools will use the CVE identifier for a given vulnerability, which can be used to access the summary information and links to other sources in the CVE database. The CVE can also be used to search for the issue in vulnerability databases like OSVDB and Bugtraq, or in exploit databases and frameworks.</p><p>漏洞数据库可用于验证自动化工具报告的问题，或手动查看目标应用程序的漏洞。 大多数工具将针对给定漏洞使用CVE标识符，该标识符可用于访问摘要信息以及指向CVE数据库中其他来源的链接。 CVE还可以用于在漏洞数据库（例如OSVDB和Bugtraq）或漏洞利用数据库和框架中搜索问题。</p><p>Vulnerability databases should be used to verify the accuracy of a reported issue. For example, an Apache web server flaw can exist on Windows, but not on Linux, which may not be taken into account by an automated scanner.</p><p>应该使用漏洞数据库来验证所报告问题的准确性。 例如，Apache Web服务器漏洞可能在Windows上存在，但在Linux上不存在，自动扫描程序可能不会考虑到这一缺陷。</p><p><em>Vendor Advisories</em></p><p>Vendor-issued security advisories and change logs can provide pointers to vulnerability information that may not be reported by any automated tools. Many major software vendors report limited details on internally discovered issues and issues where an independent researcher coordinates the disclosure of a vulnerability. If the researcher chooses to remain silent on the details of the vulnerability, the vendor advisory is frequently the only data available. In these cases, other researchers may discover more details independently, and add the details to vulnerability databases. Searching for the CVE used in a vendor advisory may turn up more detail on a potentially exploitable issue.</p><p>供应商发布的安全公告和更改日志可以提供指向漏洞信息的指针，这些漏洞信息可能无法通过任何自动化工具进行报告。 许多主要软件供应商报告的内部发现问题以及独立研究人员协调漏洞披露的问题的详细信息有限。 如果研究人员选择对漏洞的详细信息保持沉默，则供应商咨询通常是唯一可用的数据。 在这些情况下，其他研究人员可能会独立发现更多详细信息，并将这些详细信息添加到漏洞数据库中。 搜索供应商咨询中使用的CVE可能会发现有关潜在可利用问题的更多详细信息。</p><p>Change logs can provide guidance for additional research, especially in open source products, where a diff between versions can reveal a vulnerability which was fixed but not widely known, and perhaps not prioritized for upgrade or installation as a result.</p><p>变更日志可以为其他研究提供指导，尤其是在开源产品中，在这些产品之间，版本之间的差异可以揭示一个已修复但尚未广为人知的漏洞，因此可能不优先考虑进行升级或安装。</p><p><strong>Exploit Databases and Framework Modules</strong></p><p>Many exploit databases are actively maintained and publicly accessible on the Internet. Security researchers and exploit writers do not always submit their exploit code to multiple sites, so it is advisable to become familiar with several sites, and check each one for exploit code to use against potentially vulnerable applications. While some vulnerability databases track exploit availability, their coverage is usually incomplete and should not be considered exhaustive.</p><p>许多漏洞利用数据库都得到了积极维护，可以在Internet上公开访问。 安全研究人员和漏洞利用者并不总是将其漏洞利用代码提交到多个站点，因此建议您熟悉多个站点，并检查每个站点的漏洞利用代码以用于潜在的易受攻击的应用程序。 尽管某些漏洞数据库跟踪漏洞利用程序的可用性，但它们的覆盖范围通常不完整，不应视为详尽无遗。</p><p>Commercial and open source exploit frameworks can also prove useful in researching vulnerabilities. In most cases, available exploit modules are listed on their public web sites, and can be a valuable indication of the exploitability of an issue.</p><p>商业和开源漏洞利用框架也可以证明对研究漏洞有用。 在大多数情况下，可用的漏洞利用模块会在其公共网站上列出，并且可以很好地表明问题的可利用性。</p><p><strong>Common/default Passwords</strong></p><p>Frequently, administrators and technicians choose weak passwords, never change the default or do not set any password at all. Manuals for most software and hardware can be easily found online, and will provide the default credentials. Internet forums and official vendor mailing lists can provide information on undocumented accounts, commonly-used passwords and frequently misconfigured accounts. Finally, many web sites document default/backdoor passwords and should be checked for every identified system.</p><p>通常，管理员和技术人员会选择弱密码，永远不要更改默认密码或根本不设置任何密码。 可以在网上轻松找到大多数软件和硬件的手册，并将提供默认凭据。 Internet论坛和官方供应商邮件列表可以提供有关未记录帐户，常用密码和经常配置错误的帐户的信息。 最后，许多网站都记录了默认密码/后门密码，应该对每个已识别的系统进行检查。</p><p><strong>Hardening Guides/Common Misconfigurations</strong></p><p>One of the primary goals of penetration testing is to simulate the tactics and behavior of an actual attacker. While automated scanning can reduce the time window of a test, no scanner can behave like a human being. Hardening guides can be an invaluable reference for a penetration tester. They not only highlight the weakest parts of a system, but you can gain a sense of the diligence of an administrator by validating how many recommendations have been implemented. During every penetration test, time should be taken to review every major system and its recommended hardening settings, in order to discover vulnerabilities left in place by the administrator.</p><p>渗透测试的主要目标之一是模拟实际攻击者的战术和行为。 尽管自动扫描可以减少测试的时间范围，但没有扫描仪可以像人类一样工作。 硬化指南可能是渗透测试仪的宝贵参考。 它们不仅突出了系统中最薄弱的部分，而且您可以通过验证已实施了多少建议来了解管理员的勤奋。 在每个渗透测试期间，应花时间检查每个主要系统及其建议的强化设置，以发现管理员留下的漏洞。</p><p>User forums and mailing lists can provide valuable information about systems and the various issues administrators have in configuring and securing them. A tester should research target systems as if he were installing one himself, and discover where the pain points and probable configuration errors will lie.</p><p>用户论坛和邮件列表可以提供有关系统以及管理员在配置和保护系统方面遇到的各种问题的有价值的信息。 测试人员应该像在自己安装一样研究目标系统，并发现问题所在和可能的配置错误。</p><p><strong>Private Research</strong></p><p><em>Setting up a replica environment</em></p><p>Virtualization technologies allow a security researcher to run a wide variety of operating systems and applications, without requiring dedicated hardware. When a target operating system or application has been identified, a virtual machine (VM) environment can be quickly created to mimic the target. The tester can use this VM to explore to configuration parameters and behaviors of the application, without directly connecting to the target.</p><p>虚拟化技术使安全研究人员无需专用硬件即可运行多种操作系统和应用程序。 确定目标操作系统或应用程序后，可以快速创建虚拟机（VM）环境来模拟目标。 测试人员可以使用此VM探索应用程序的配置参数和行为，而无需直接连接到目标。</p><p><em>Testing Configurations</em></p><p>A testing VM lab should contain base images for all common operating systems, including Windows XP, Vista, 7, Server 2003 and Server 2008, Debian, Ubuntu, Red Hat and Mac OS X, where possible. Maintaining separate images for each service pack level will streamline the process of recreating the target’s environment. A complete VM library in combination with a VM environment that supports cloning will allow a tester to bring up a new target VM in minutes. Additionally, using a snapshot feature will allow to work more efficiently and to reproduce bugs.</p><p>测试VM实验室应尽可能包含所有常见操作系统的基础映像，包括Windows XP，Vista，7，Server 2003和Server 2008，Debian，Ubuntu，Red Hat和Mac OSX。 为每个Service Pack级别维护单独的映像将简化重新创建目标环境的过程。 完整的VM库与支持克隆的VM环境相结合，可使测试人员在几分钟内启动新的目标VM。 此外，使用快照功能将使工作效率更高并重现错误。</p><p><em>Fuzzing</em></p><p>Fuzzing, or fault injection, is a brute-force technique for finding application flaws by programmatically submitting valid, random or unexpected input to the application. The basic process involves attaching a debugger to the target application, and then running the fuzzing routine against specific areas of input and then analyzing the program state following any crashes. Many fuzzing applications are available, although some testers write their own fuzzers for specific targets.</p><p>模糊测试或故障注入是一种蛮力技术，可通过以编程方式向应用程序提交有效，随机或意外的输入来查找应用程序缺陷。 基本过程包括将调试器附加到目标应用程序，然后针对特定的输入区域运行模糊测试例程，然后在发生任何崩溃后分析程序状态。 尽管有些测试人员为特定目标编写了自己的模糊器，但仍有许多模糊处理应用程序可用。</p><p><strong>Identifying potential avenues/vectors</strong></p><p>Log in or connect to a target network application to identify commands and other areas of input. If the target is a desktop application that reads files and/or web pages, analyze the accepted file formats for avenues of data input. Some simple tests involve submitting invalid characters, or very long strings of characters to cause a crash. Attach a debugger to analyze the program state in the event of a successful crash.</p><p>登录或连接到目标网络应用程序以标识命令和其他输入区域。 如果目标是读取文件和/或网页的桌面应用程序，请分析接受的文件格式以获取数据输入途径。 一些简单的测试涉及提交无效字符或很长的字符串以导致崩溃。 如果成功崩溃，请附加调试器以分析程序状态。</p><p><strong>Disassembly and code analysis</strong></p><p>Some programming languages allow for decompilation, and some specific applications are compiled with symbols for debugging. A tester can take advantage of these features to analyze program flow and identify potential vulnerabilities. Source code for open source applications should be analyzed for flaws. Web applications written in PHP share many of the same vulnerabilities, and their source code should be examined as part of any test.</p><p>一些编程语言允许反编译，而某些特定的应用程序则用符号进行编译以进行调试。 测试人员可以利用这些功能来分析程序流并识别潜在的漏洞。 应该分析开源应用程序的源代码是否存在缺陷。 用PHP编写的Web应用程序具有许多相同的漏洞，它们的源代码应作为任何测试的一部分进行检查。</p>]]></content>
    
    
    <categories>
      
      <category>渗透测试</category>
      
    </categories>
    
    
    <tags>
      
      <tag>渗透测试</tag>
      
      <tag>标准</tag>
      
      <tag>Google翻译</tag>
      
      <tag>漏洞分析</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>三、威胁建模</title>
    <link href="/2020/12/29/%E4%B8%89%E3%80%81%E5%A8%81%E8%83%81%E5%BB%BA%E6%A8%A1/"/>
    <url>/2020/12/29/%E4%B8%89%E3%80%81%E5%A8%81%E8%83%81%E5%BB%BA%E6%A8%A1/</url>
    
    <content type="html"><![CDATA[<h1 id="威胁建模"><a href="#威胁建模" class="headerlink" title="威胁建模"></a>威胁建模</h1><h1 id="0x00-概述"><a href="#0x00-概述" class="headerlink" title="0x00 概述"></a>0x00 概述</h1><p>This section defines a threat modeling approach as required for a correct execution of a penetration testing. The standard does not use a specific model, but instead requires that the model used be consistent in terms of its representation of threats, their capabilities, their qualifications as per the organization being tested, and the ability to repeatedly be applied to future tests with the same results.</p><p>本部分定义了正确执行渗透测试所需的威胁建模方法。 该标准不使用特定模型，而是要求所使用的模型在威胁的表示，威胁的能力，根据被测组织的资格方面以及与被测组织重复应用于未来测试的能力方面必须保持一致。 相同的结果。</p><p>The standard focuses on two key elements of traditional threat modeling - assets and attacker (threat community/agent). Each one is respectively broken down into business assets and business processes and the threat communities and their capabilities.</p><p>该标准侧重于传统威胁建模的两个关键元素-资产和攻击者（威胁社区/代理）。 每一个都细分为业务资产和业务流程以及威胁社区及其功能。</p><p>As a minimum, all four elements should be clearly identified and documented in every penetration test.</p><p>至少，在每个渗透测试中，所有四个要素都应明确标识并记录在案。</p><p>When modeling the attacker side, on top of the threat community (which is mostly semantic and can be tied back to the organization’s business SWOT analysis), and the capabilities (which is mostly technical), additional aspects of motivation modeling should also be provided. These additional points essentially take into account the value of the different assets available at the target and are combined with the cost of acquiring it. As a complementary model, impact modeling should also be performed for the organization in order to provide a more accurate view of the “what-if?” scenario surrounding the loss event of each of the identified assets. This should take into account the assets “net” value, its intrinsic value, and other indirectly incurred costs associated with a loss event.</p><p>在对攻击者进行建模时，除了要在威胁社区（主要是语义上，可以将其绑定到组织的业务SWOT分析）和功能（主要是技术上的）之外，还应提供动机建模的其他方面。 这些额外点基本上考虑了目标处可用的不同资产的价值，并与获取资产的成本结合在一起。 作为补充模型，还应该为组织执行影响建模，以提供“假设条件”的更准确视图。 每个已识别资产的损失事件的场景。 这应考虑到资产的“净值”，其内在价值以及与损失事件相关的其他间接费用。</p><p>The threat modeling phase of any penetration testing engagement is critical for both the testers, as well as the organization. It provides clarity as far as the organization’s risk appetite and prioritization (which assets are more important than others? what threat communities are more relevant than others?). Additionally, it enables the tester to focus on delivering an engagement that closely emulates the tools, techniques, capabilities, accessibility and general profile of the attacker, while keeping in mind what are the actual targets inside the organization such that the more relevant controls, processes, and infrastructure are put to the test rather than an inventory list of IT elements. The threat model should be constructed in coordination with the organization being tested whenever possible, and even in a complete black-box situation where the tester does not have any prior information on the organization, the tester should create a threat model based on the attacker’s view in combination with OSINT related to the target organization.</p><p>任何渗透测试活动的威胁建模阶段对于测试人员和组织都至关重要。它提供了有关组织风险偏好和优先级的清晰信息（哪些资产比其他资产更重要？哪些威胁社区比其他资产更重要？）。此外，它使测试人员能够专注于提供与攻击者的工具，技术，功能，可访问性和一般概况紧密相似的互动，同时牢记组织内部的实际目标是什么，以便更相关的控制，流程和基础设施而不是IT元素清单清单进行测试。威胁模型的构建应尽可能与被测组织协调，甚至在测试人员没有组织的任何先验信息的完全黑箱情况下，测试人员也应根据攻击者的观点创建威胁模型。结合与目标组织有关的OSINT。</p><p>The model should be clearly documented, and be delivered as part of the final report as the findings in the report will reference the threat model in order to create a more accurate relevance and risk score that is specific to the organization (rather than a generic technical one).</p><p>该模型应清楚地记录在案，并作为最终报告的一部分提供，因为报告中的发现将参考威胁模型，以便创建针对组织的更准确的相关性和风险评分（而不是通用技术指标） 之一）。</p><h2 id="0x0000-高级威胁建模过程"><a href="#0x0000-高级威胁建模过程" class="headerlink" title="0x0000 高级威胁建模过程"></a>0x0000 高级威胁建模过程</h2><ol><li>Gather relevant documentation</li><li>Identify and categorize primary and secondary assets</li><li>Identify and categorize threats and threat communities</li><li>Map threat communities against primary and secondary assets</li></ol><h2 id="0x0001-示例"><a href="#0x0001-示例" class="headerlink" title="0x0001 示例"></a>0x0001 示例</h2><p>In the light of a PTES assessment the internally hosted CRM application may be in scope. The customer information stored in the back-end database is an easily identifiable primary asset as it is directly linked to the application in scope. However, by reviewing the technical design of the database server, it can also be identified that the HR database stored on the same back-end database server is a secondary asset. An attacker can use the CRM application as a stepping stone to obtain employee information. In a basic threat modeling exercise, certain threat communities may be identified as not relevant when mapped to the CRM application, but by identifying the secondary assets the threat landscape suddenly changes.</p><p>根据PTES评估，内部托管的CRM应用程序可能会在范围内。 后端数据库中存储的客户信息是易于识别的主要资产，因为它直接与范围内的应用程序链接。 但是，通过查看数据库服务器的技术设计，还可以确定存储在同一后端数据库服务器上的HR数据库是辅助资产。 攻击者可以将CRM应用程序用作获取员工信息的垫脚石。 在基本的威胁建模练习中，某些威胁社区在映射到CRM应用程序时可能会被标识为不相关，但是通过标识次要资产，威胁态势会突然改变。</p><h2 id="0x0002-高级建模工具"><a href="#0x0002-高级建模工具" class="headerlink" title="0x0002 高级建模工具"></a>0x0002 高级建模工具</h2><p>There are a variety of tools available to identify targets and map attack vectors. These normally focus on the business assets (what systems to target) and business processes (how to attack them.) Depending on the engagement, the penetration testing team may perform these exercises with no input from the customer; or they may spend a lot of time with customer stakeholders identifying targets of interest. Tools with a business asset focus usually require a quantitative input to describe how important each potential target is to test. The inputs may also be qualitative, such as a description by the customer’s CIO that a system is mission-critical. Tools focused on business processes, information flows and technical architecture are used to identify potential attack vectors and choose which are mostly likely to succed or most likely to be used by a certain class of adversary.</p><p>有多种工具可用于识别目标和映射攻击媒介。 这些通常集中在业务资产（要针对的系统）和业务流程（如何攻击它们）上。根据参与情况，渗透测试团队可能在没有客户输入的情况下执行这些练习； 否则他们可能会与客户利益相关者花费大量时间来确定感兴趣的目标。 专注于业务资产的工具通常需要定量输入，以描述每个潜在目标要测试的重要性。 这些输入也可能是定性的，例如客户的CIO对系统至关重要的描述。 使用针对业务流程，信息流和技术体系结构的工具来识别潜在的攻击媒介，并选择最有可能成功或最有可能被某类攻击者使用的媒介。</p><h1 id="0x01-企业资产分析"><a href="#0x01-企业资产分析" class="headerlink" title="0x01 企业资产分析"></a>0x01 企业资产分析</h1><p>During the business asset analysis part of the threat modeling exercise an asset-centric view is taken on all assets, and business processes they support them, included in the scope. By analyzing the gathered documentation and interviewing relevant personnel within the organization, the pentester is able to identify the assets that are most likely to be targeted by an attacker, what their value is and what the impact of their (partial) loss would be.</p><p>在威胁建模练习的业务资产分析过程中，将对所有资产及其包含的业务流程（包括在范围内）采取以资产为中心的视图。 通过分析收集的文档并与组织内的相关人员进行访谈，pentester能够识别出最有可能成为攻击者目标的资产，其价值是什么以及（部分）损失的影响。</p><h2 id="0x0100-组织数据"><a href="#0x0100-组织数据" class="headerlink" title="0x0100 组织数据"></a>0x0100 组织数据</h2><h3 id="0x010000-政策，计划和程序"><a href="#0x010000-政策，计划和程序" class="headerlink" title="0x010000 政策，计划和程序"></a>0x010000 政策，计划和程序</h3><p>Internal policies, plans, and procedures define how the organization does business. These documents are of particular interest as they can help identify key roles within an organization and critical business processes that keep a company running.</p><p>内部政策，计划和程序定义了组织开展业务的方式。 这些文档特别有用，因为它们可以帮助确定组织内的关键角色以及使公司保持运转的关键业务流程。</p><h3 id="0x010001-产品信息（例如商业秘密，研发数据）"><a href="#0x010001-产品信息（例如商业秘密，研发数据）" class="headerlink" title="0x010001 产品信息（例如商业秘密，研发数据）"></a>0x010001 产品信息（例如商业秘密，研发数据）</h3><p>Product related information includes any patents, trade secrets, future plans, source code, supporting systems that directly affect the product market value, algorithms, and any other information that the organization regards as a key factor to the business success of such product.</p><p>与产品相关的信息包括任何专利，商业秘密，未来计划，源代码，直接影响产品市场价值的支持系统，算法以及组织认为是此类产品的业务成功的关键因素的任何其他信息。</p><h3 id="0x010002-市场信息-计划、路线图等"><a href="#0x010002-市场信息-计划、路线图等" class="headerlink" title="0x010002 市场信息(计划、路线图等)"></a>0x010002 市场信息(计划、路线图等)</h3><p>Marketing plans for promotions, launches, product changes, positioning, partnerships, 3rd party providers, business plans related to activities inside or outside the organization. Additionally, PR related data such as details of partners, reporters, consulting firm, and any correspondence with such entities is also considered a highly sought after target.</p><p>促销，发布，产品变更，定位，合作伙伴关系，第三方提供商，与组织内部或外部活动相关的商业计划的营销计划。 此外，与PR相关的数据（例如合作伙伴，记者，咨询公司的详细信息以及与此类实体的任何往来信息）也被视为极受欢迎的目标。</p><h3 id="0x010003-财务信息（例如-银行、信贷、权益账户）"><a href="#0x010003-财务信息（例如-银行、信贷、权益账户）" class="headerlink" title="0x010003 财务信息（例如:银行、信贷、权益账户）"></a>0x010003 财务信息（例如:银行、信贷、权益账户）</h3><p>Financial information is often some of the most guarded information an organization possesses. This information can include bank account information, credit card account information and/or credit card numbers, and investment accounts, among others.</p><p>财务信息通常是组织拥有的最受保护的信息。 该信息可以包括银行帐户信息，信用卡帐户信息和/或信用卡号以及投资帐户等。</p><h3 id="0x010004-技术信息"><a href="#0x010004-技术信息" class="headerlink" title="0x010004 技术信息"></a>0x010004 技术信息</h3><p>Technical information about the organization, and the organization’s operations, is of unique interest to the penetration tester. Such information is often not the expected deliverable of a penetration test, however, it facilitates the testing process by feeding valuable information to other areas; infrastructure design information may provide valuable data to the Intelligence Gathering process.</p><p>渗透测试人员对组织的技术信息以及组织的运营非常感兴趣。 这些信息通常不是渗透测试的预期结果，但是，它通过将有价值的信息提供给其他领域来促进测试过程。 基础架构设计信息可以为情报收集过程提供有价值的数据。</p><ul><li>Infrastructure Design Information 基础设施设计信息</li></ul><p>Infrastructure design related information pertains to all the core technologies and facilities used to run the organization. Building blueprints, technical wiring and connectivity diagrams, computing equipment/networking designs, and application level data processing are all considered infrastructure design information.</p><p>与基础架构设计相关的信息与用于组织运行的所有核心技术和设施有关。 建筑蓝图，技术布线和连接图，计算设备/网络设计以及应用程序级别数据处理都被视为基础架构设计信息。</p><ul><li>System Configuration Information</li></ul><p>System configuration information includes configuration baseline documentation, configuration checklists and hardening procedures, group policy information, operating system images, software inventories, etc. This information could aid the discovery of vulnerabilities (such as through the knowledge of configuration errors or outdated software installations).</p><p>系统配置信息包括配置基准文档，配置清单和强化过程，组策略信息，操作系统映像，软件清单等。此信息可以帮助发现漏洞（例如，通过了解配置错误或过时的软件安装）。</p><ul><li>User Account Credentials 用户帐户凭证</li></ul><p>User account credentials help facilitate access to the information system, at a non-privileged level, as long as a means to authenticate exists (e.g. VPN, web portal, etc.).</p><p>只要存在身份验证手段（例如VPN，Web门户等），用户帐户凭据就可以帮助以非特权级别访问信息系统。</p><ul><li>Privileged User Account Credentials 特权用户帐户凭据</li></ul><p>Privileged user account credentials help facilitate access to the information system, at an elevated level of access, as long as a means to authenticate exists (e.g. VPN, web portal, etc.). Obtaining privileged user account credentials often leads to compromise of the information system being tested.</p><p>只要存在身份验证手段（例如VPN，Web门户等），特权用户帐户凭据有助于以较高的访问级别促进对信息系统的访问。 获取特权用户帐户凭据通常会导致正在测试的信息系统受到损害。</p><h3 id="0x010005-员工数据"><a href="#0x010005-员工数据" class="headerlink" title="0x010005 员工数据"></a>0x010005 员工数据</h3><p>Here employee data is being analyzed as any data that can have a DIRECT affect on the organization is obtained or compromised by an attacker. Organizations that have to adhere to some compliance which places fines on the loss or exposure of such data are obvious candidates for such a direct loss effect. Also, organizations who’s employees may be considered critical assets may also be subjected to such scrutiny (specific government bodies, specialized trade secret related employees/departments, etc…). The following list provides examples to information realms of personal data that may be considered business assets for the threat modeling.</p><p>在这里，正在对员工数据进行分析，因为任何可能对组织产生直接影响的数据都会被攻击者获取或破坏。 那些必须遵守某些合规规定而对此类数据的丢失或暴露处以罚款的组织显然是这种直接损失影响的候选者。 另外，可能会将员工的组织视为重要资产（特定的政府机构，与商业秘密有关的特殊员工/部门等）也要接受此类审查。 以下列表提供了有关个人数据信息领域的示例，这些个人数据领域可能被视为威胁建模的业务资产。</p><ul><li>National Identification Numbers (SSNs, etc.)</li><li>Personally Identifiable Information (PII)</li><li>Protected Health Information (PHI)</li><li>Financial Information (e.g. bank, credit accounts)</li></ul><h3 id="0x010006-客户数据"><a href="#0x010006-客户数据" class="headerlink" title="0x010006 客户数据"></a>0x010006 客户数据</h3><p>Much like employee data, customer data is considered a business asset in the threat modeling process when such information will incur a direct/indirect loss to the organization. On top of regulatory/compliance need (based on fines), an additional factor comes into play here when such data can be used to conduct fraud, where the organization may be held liable or sued for the losses related to the fraud (based on losing the customer information that enabled the fraud to take place). The following list provides examples of such information realms that may hold relevant customer data and should be considered business assets for the sake of the threat modeling</p><p>与员工数据非常相似，客户数据在威胁建模过程中被视为企业资产，当此类信息将对组织造成直接/间接损失时。 除了法规/合规性需求（基于罚款）之外，当此类数据可用于进行欺诈时，这里还有一个其他因素在起作用，在这种情况下，组织可能因欺诈行为造成的损失而被追究责任或起诉（基于损失） 导致欺诈行为发生的客户信息）。 以下列表提供了此类信息领域的示例，这些信息领域可能包含相关的客户数据，出于威胁建模的考虑，应将其视为业务资产</p><ul><li>National Identification Numbers (SSN’s, etc.)</li><li>Personally Identifiable Information (PII)</li><li>Protected Health Information (PHI)</li><li>Financial Accounts (e.g. bank, credit, equity accounts)</li><li>Supplier Data</li></ul><p>Information related to suppliers that is considered critical to the organization (such as critical component manufacturers, agreements with suppliers that may be part of a trade secret, cost analysis of supplied components), as well as any data that may be used to affect the business operations of the organization through its suppliers is considered a business asset.</p><ul><li>Partner Data</li><li>“Cloud” Service Account Information</li></ul><h2 id="0x0101-人力资产"><a href="#0x0101-人力资产" class="headerlink" title="0x0101 人力资产"></a>0x0101 人力资产</h2><p>When identifying human assets in an organization, we have to remember that the context is having such assets part of a greater effort to compromise the organization. As such, human assets that are identified as business assets are those that could be leveraged to divulge information, manipulated to make decisions or actions that would adversely affect the organization or enable an attacker to further compromise it. Human assets are not necessarily the highest up within the corporate hierarchy, but are more often key personnel that are related to previously identified business assets, or are in positions to enable access to such assets. This list can also include employees that normally would not be associated with access to restricted company assets, but may be in a position to grant physical access to a company that facilitates a breach of security or procedure. The following list provides some examples of such assets, and should be adapted to the organization being tested.</p><p>在确定组织中的人力资产时，我们必须记住，上下文是此类资产的一部分，是对组织做出更大努力的一部分。 这样，被识别为业务资产的人力资产就是可以被用来泄露信息，被操纵以做出对组织产生不利影响或使攻击者能够进一步危害它的决策或行动的人力资产。 人力资产不一定是公司层次结构中最高的，但更经常是与先前确定的企业资产相关的关键人员，或者可以访问这些资产的人员。 该列表还可以包括通常不与访问受限制的公司资产相关联的员工，但可以授予对公司的物理访问权，以利于违反安全性或程序。 以下列表提供了此类资产的一些示例，并且应适合于要测试的组织。</p><ul><li>Executive Management</li><li>Executive Assistants</li><li>Middle Management</li><li>Administrative Assistants</li><li>Technical/Team Leads</li><li>Engineers</li><li>Technicians</li><li>Human Resources</li></ul><h1 id="0x02-业务流程分析"><a href="#0x02-业务流程分析" class="headerlink" title="0x02 业务流程分析"></a>0x02 业务流程分析</h1><p>A business isn’t a business if it doesn’t make money. The way this happens is by having either raw goods or knowledge run through various processes to enhance them and create added value. This generates revenue. Business processes and the assets (people, technology, money) supporting them form value chains. By mapping these processes, identifying the critical vs. non-critical processes and eventually finding flaws in them we are able to understand how the business works, what makes them money and eventually how specific threat communities can make them lose money.</p><p>如果一家企业不赚钱，那就不是一家企业。 发生这种情况的方式是使原材料或知识经过各种过程来增强它们并创造附加值。 这产生了收入。 业务流程和支持它们的资产（人员，技术，金钱）形成价值链。 通过映射这些流程，识别关键流程和非关键流程并最终发现它们中的缺陷，我们能够了解业务的运作方式，使它们赚钱的方式以及特定威胁社区如何使他们亏损的方式。</p><p>In the business process analysis we differentiate between critical business processes, and non-critical processes. For each category the analysis is the same, and takes into account the same elements. The main difference is in the weighting that the threat from a critical business process is assigned with as opposed to a non-critical one. Nevertheless, it’s imperative to remember that an aggregation of a few non-critical business processes can be combined into a scenario that essentially forms a critical flaw within an element/process. Such threat scenarios should also be identified within this phase and mapped out for later use in the penetration test.</p><p>在业务流程分析中，我们区分关键业务流程和非关键流程。 对于每个类别，分析都是相同的，并考虑了相同的元素。 主要区别在于权重来自关键业务流程，而不是非关键业务。 但是，必须记住，可以将一些非关键业务流程的聚合组合到一个场景中，该场景本质上会在元素/流程中形成关键缺陷。 还应在此阶段中识别出此类威胁情景，并进行规划，以供以后在渗透测试中使用。</p><h2 id="0x0200-支持流程的技术基础架构"><a href="#0x0200-支持流程的技术基础架构" class="headerlink" title="0x0200 支持流程的技术基础架构"></a>0x0200 支持流程的技术基础架构</h2><p>As business processes are usually supported by IT infrastructure (such as computer networks, processing power, PCs for entering information and managing the business process, etc…), all those elements must be identified and mapped. Such mapping should be clear enough to be used later on in the process when translating the threat model to the vulnerability mapping and exploitation.</p><p>由于业务流程通常受IT基础结构（例如计算机网络，处理能力，用于输入信息和管理业务流程的PC等）的支持，因此必须识别并映射所有这些元素。 这种映射应该足够清晰，以便在将威胁模型转换为漏洞映射和利用时在过程中稍后使用。</p><h2 id="0x0201-支持流程的信息资产"><a href="#0x0201-支持流程的信息资产" class="headerlink" title="0x0201 支持流程的信息资产"></a>0x0201 支持流程的信息资产</h2><p>Contrary to technical infrastructure, information assets are existing knowledge bases in the organization that are used as either a reference, or as support material (decision making, legal, marketing, etc…). Such assets are usually identified in the business process already, and should be mapped alongside the technical infrastructure, as well as any additional technical infrastructure that supports the information assets themselves.</p><p>与技术基础结构相反，信息资产是组织中的现有知识库，可用作参考或支持材料（决策，法律，市场营销等）。 通常在业务流程中已经标识了此类资产，并且应将其与技术基础结构以及支持信息资产本身的任何其他技术基础结构一起进行映射。</p><h2 id="0x0202-支持流程的人力资源"><a href="#0x0202-支持流程的人力资源" class="headerlink" title="0x0202 支持流程的人力资源"></a>0x0202 支持流程的人力资源</h2><p>Identification of the HR that are involved in the business process should be made in conjunction with the process analysis itself (whether documented or not), and every person that has any kind of involvement (even if it does not relate to a specific information asset or a technical infrastructure element) should be documented and mapped in the process. Such HR assets are usually part of an approval sub-process, a verification sub-process, or even a reference (such as legal advice). These kinds of assets (especially ones that have no relation to information assets or technical infrastructure) would be later mapped to attack vectors that are more social than technical in nature.</p><p>应当与流程分析本身（无论是否有文件记录）一起进行识别业务流程中涉及的人力资源，并且每个人都应参与其中（即使与特定的信息资产或资产无关）。 技术基础架构要素）应记录在案并在过程中进行映射。 这些人力资源资产通常是批准子流程，验证子流程甚至参考（例如法律建议）的一部分。 这些资产（特别是与信息资产或技术基础设施无关的资产）将在以后映射到本质上比技术更具社会性的攻击媒介。</p><h2 id="0x0203-第三方集成或流程的使用"><a href="#0x0203-第三方集成或流程的使用" class="headerlink" title="0x0203 第三方集成或流程的使用"></a>0x0203 第三方集成或流程的使用</h2><p>Similar to human assets supporting the process, any 3rd party that has any involvement with the business process should be mapped as well. This category can be tricky to map out, as it could contain both human assets, as well as information/technical ones (such as a SaaS provider).</p><p>与支持流程的人力资产相似，与业务流程有任何关系的任何第三方也应进行映射。 该类别很难标出，因为它既可以包含人力资产，也可以包含信息/技术资产（例如SaaS提供程序）。</p><h1 id="0x03-威胁社区和代理分析"><a href="#0x03-威胁社区和代理分析" class="headerlink" title="0x03 威胁社区和代理分析"></a>0x03 威胁社区和代理分析</h1><p>When defining the relevant threat communities and agents, a clear identification of the threat should be provided in terms of location (internal / external to the organization), the specific community within the location, and any additional relevant information that would assist in establishing a capabilities/motivation profile for the specific agent/community. Where possible, specific agents should be identified. Otherwise, a more general community should be outlined, along-with any supporting material and intelligence. Some examples of threat agent/community classifications are:</p><p>在定义相关威胁社区和代理商时，应根据位置（组织的内部/外部），位置内的特定社区以及有助于建立能力的任何其他相关信息，对威胁进行清晰的标识。 特定代理人/社区的/动机配置文件。 如有可能，应确定具体的代理商。 否则，应概述更广泛的社区以及所有支持材料和情报。 威胁代理/社区分类的一些示例是：</p><table><thead><tr><th align="center">内部</th><th align="center">外部</th></tr></thead><tbody><tr><td align="center">Employees</td><td align="center">Business Partners</td></tr><tr><td align="center">Management (executive, middle)</td><td align="center">Competitors</td></tr><tr><td align="center">Administrators (network, system, server)</td><td align="center">Contractors</td></tr><tr><td align="center">Developers</td><td align="center">Suppliers</td></tr><tr><td align="center">Engineers</td><td align="center">Nation States</td></tr><tr><td align="center">Technicians</td><td align="center">Organized Crime</td></tr><tr><td align="center">Contractors (with their external users)</td><td align="center">Hacktivists</td></tr><tr><td align="center">General user community</td><td align="center">Script Kiddies (recreational/random hacking)</td></tr><tr><td align="center">Remote Support</td><td align="center"></td></tr></tbody></table><h2 id="0x0300-员工"><a href="#0x0300-员工" class="headerlink" title="0x0300 员工"></a>0x0300 员工</h2><p>Persons working directly for the company under a part-time or full-time contract. In general they are not regarded as posing a severe threat as most of them are relying on the company to make a living and, assuming they are treated well, are inclined to protect the company rather than to hurt it. Oftentimes involved in data loss incidents or accidental compromise. In rare cases they may be motivated by outsiders to assist in intrusions or they may engage in malicious acts on their own (e.g. rogue traders). While the skill level may vary, it is usually low to medium.</p><p>根据兼职或全职合同直接为公司工作的人员。 通常，他们不被视为构成严重威胁，因为他们中的大多数人都依靠公司为生，并且假设他们受到良好的对待，他们倾向于保护公司而不是伤害公司。 通常涉及数据丢失事件或意外泄露。 在极少数情况下，他们可能会受到局外人的动机来协助进行入侵，或者他们可能自己（例如流氓交易员）进行恶意行为。 尽管技能水平可能有所不同，但通常是中低水平。</p><h2 id="0x0301-管理层（高管、中层）"><a href="#0x0301-管理层（高管、中层）" class="headerlink" title="0x0301 管理层（高管、中层）"></a>0x0301 管理层（高管、中层）</h2><p>Employees working directly for the company as described above. Given their position and function within the company they oftentimes have access to privileged information and may</p><p>如上所述，直接为公司工作的员工。 鉴于他们在公司中的职位和职能，他们通常可以访问特权信息，并且可能</p><h1 id="0x04-威胁能力分析"><a href="#0x04-威胁能力分析" class="headerlink" title="0x04 威胁能力分析"></a>0x04 威胁能力分析</h1><p>Once a threat community has been identified, the capabilities of said community must also be analyzed in order to build an accurate threat model that reflects the actual probability of such a community/agent to successfully act upon the organization and compromise it. This analysis requires both a technical analysis as well as an opportunity analysis (where applicable).</p><p>一旦确定了威胁社区，就还必须分析该社区的能力，以建立一个准确的威胁模型，以反映这种社区/代理成功地对组织采取行动并做出妥协的实际可能性。 此分析需要技术分析和机会分析（如果适用）。</p><h2 id="0x0400-分析使用中的工具"><a href="#0x0400-分析使用中的工具" class="headerlink" title="0x0400 分析使用中的工具"></a>0x0400 分析使用中的工具</h2><p>Any tools that are known to be available to the threat community/agent are to be included here. Additionally, tools that may be freely available should be analyzed for the required skill level needed to be able to utilize them to their potential, and mapped in the threat capability.</p><p>威胁社区/代理已知的任何工具都将包含在此处。 此外，应针对可能需要免费使用的工具进行分析，以使其能够发挥其潜力所需的技能水平，并在威胁能力中进行映射。</p><h2 id="0x0401-相关漏洞利用-exploits-或有效负载-payloads-的可用性"><a href="#0x0401-相关漏洞利用-exploits-或有效负载-payloads-的可用性" class="headerlink" title="0x0401 相关漏洞利用(exploits)或有效负载(payloads)的可用性"></a>0x0401 相关漏洞利用(exploits)或有效负载(payloads)的可用性</h2><p>The threat community/agent should be analyzed in terms of its capability to either obtain or develop exploits for the environment relevant to the organization. Additionally, accessibility to such exploits/payloads through 3rd parties, business partners, or underground communities should also be to taken into account in this analysis.</p><p>应对威胁社区/代理进行分析，使其具有获取或开发与组织相关的环境的攻击的能力。 此外，在此分析中还应考虑通过第三方，业务合作伙伴或地下社区对此类漏洞利用/有效载荷的可访问性。</p><h2 id="0x0402-沟通机制-Communication-mechanisms"><a href="#0x0402-沟通机制-Communication-mechanisms" class="headerlink" title="0x0402 沟通机制(Communication mechanisms)"></a>0x0402 沟通机制(Communication mechanisms)</h2><p>An analysis of communication mechanisms available to the threat agent/community should be made to evaluate the complexity of attacks against an organization. These communication mechanisms range from simple and openly available technologies such as encryption, through to specialist tools and services such as bulletproof hosting, use of drop-sites, and the use of known or unknown botnets to perform attacks or mask source information. For example, as part of testing we test to see what the overall attack surface for an organization is from the outside. However, there is another whole component that is often times missed. What types of threats can exist post exploitation? This falls under the context of detecting exfiltration channels. Coincidentally, penetration testers are uniquely situated to test an organizations capability to detect command and control channels of today’s modern malware. When this is in scope, we recommend the tester create a series of malware specimens that increase the level of obfuscation used to hide C2. The goal is to create malware that is easily detected, then increase the obfuscation to the point where detection no longer occurs.</p><p>应该对威胁代理/社区可用的通信机制进行分析，以评估针对组织的攻击的复杂性。这些通信机制从简单和公开可用的技术（例如加密）到专业工具和服务（例如防弹托管，使用放置站点，以及使用已知或未知的僵尸网络进行攻击或掩盖源信息）不等。例如，作为测试的一部分，我们进行测试以查看组织的整体攻击面是从外部开始的。但是，还有其他整个组件经常被遗漏。开发后可以存在哪些类型的威胁？这属于检测渗出通道的范围。巧合的是，渗透测试仪的位置独特，可以测试组织检测当今现代恶意软件的命令和控制通道的能力。在此范围内，我们建议测试人员创建一系列恶意软件标本，以增加用于隐藏C2的混淆程度。目标是创建易于检测的恶意软件，然后将混淆程度提高到不再发生检测的程度。</p><h2 id="0x0403-可访问性"><a href="#0x0403-可访问性" class="headerlink" title="0x0403 可访问性"></a>0x0403 可访问性</h2><p>The final element in the threat actor capability analysis is their accessibility to the organization and/or the specific assets in question. Completing the profile depicted above while factoring in accessibility analysis would enable the penetration test to create clear scenarios that are relevant to the organization’s risk.</p><p>威胁参与者能力分析的最后一个要素是他们对组织和/或所讨论的特定资产的可访问性。 在完成可访问性分析的同时，完成上述配置文件，可以使渗透测试能够创建与组织风险相关的清晰方案。</p><h1 id="0x05-建模动机"><a href="#0x05-建模动机" class="headerlink" title="0x05 建模动机"></a>0x05 建模动机</h1><p>The possible motivation of threat agents/communities should be noted for further analysis. Motivations of attackers are constantly changing, as can be seen by the increase in hacktivism branded attacks by groups such as Anonymous and Antisec. There will be subtle differences in unique motivations based on each organization and/or vertical market, some common motivations include :</p><p>应该指出威胁因素/社区的可能动机，以进行进一步分析。 攻击者的动机正在不断变化，这可以从匿名者和Antisec之类的团体以黑客行为为品牌的攻击中看到。 根据每个组织和/或垂直市场的独特动机会有细微的差异，一些常见的动机包括：</p><ul><li>Profit (direct or indirect)</li><li>Hacktivism</li><li>Direct grudge</li><li>Fun / Reputation</li><li>Further access to partner/connected systems</li></ul><h1 id="0x06-寻找可比组织受到威胁的相关新闻"><a href="#0x06-寻找可比组织受到威胁的相关新闻" class="headerlink" title="0x06 寻找可比组织受到威胁的相关新闻"></a>0x06 寻找可比组织受到威胁的相关新闻</h1><p>In order to provide a complete threat model, a comparison to other organizations within the same industry vertical should be provided. This comparison should include any relevant incidents or news related to such organizations and the challenges they face. Such a comparison is used to validate the threat model and offer a baseline for the organization to compare itself to (taking into account that this publicly available information only represents a portion of the actual threats and incidents the compared organization actually face).</p><p>为了提供完整的威胁模型，应提供与同一行业垂直领域内其他组织的比较。 这种比较应包括与此类组织及其面临的挑战有关的任何相关事件或新闻。 这种比较用于验证威胁模型，并为组织进行自我比较提供基准（考虑到此公开可用的信息仅代表被比较组织实际面临的部分实际威胁和事件）。</p>]]></content>
    
    
    <categories>
      
      <category>渗透测试</category>
      
    </categories>
    
    
    <tags>
      
      <tag>渗透测试</tag>
      
      <tag>标准</tag>
      
      <tag>Google翻译</tag>
      
      <tag>威胁建模</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>二、情报搜集</title>
    <link href="/2020/12/29/%E4%BA%8C%E3%80%81%E6%83%85%E6%8A%A5%E6%90%9C%E9%9B%86/"/>
    <url>/2020/12/29/%E4%BA%8C%E3%80%81%E6%83%85%E6%8A%A5%E6%90%9C%E9%9B%86/</url>
    
    <content type="html"><![CDATA[<h1 id="情报搜集"><a href="#情报搜集" class="headerlink" title="情报搜集"></a>情报搜集</h1><h1 id="0x00-概述"><a href="#0x00-概述" class="headerlink" title="0x00 概述"></a>0x00 概述</h1><p>本部分定义渗透测试的情报收集活动。本文档的目的是提供专门为渗透测试人员对目标（通常是公司，军事或相关目标）进行侦察的标准。该文档详细介绍了渗透侦察的思想过程和目标，如果使用得当，可以帮助读者制定出针对攻击目标的高度战略性计划。</p><h1 id="0x01-背景概念"><a href="#0x01-背景概念" class="headerlink" title="0x01 背景概念"></a>0x01 背景概念</h1><p>**级别(Level)**是本文档以及整个PTES的重要概念。这是用于渗透测试的成熟度模型。定义级别使我们能够在某些现实世界的约束下（例如时间，精力，信息访问等）阐明预期的输出和活动。</p><p>目前，“情报收集”级别分为三类，每个类别都给出一个典型示例。这些将指导以下文档中技术的添加。例如，在更高级的情况下，进行密集的活动（例如创建Facebook个人资料和分析目标对象的社交网络）是适当的，并应标上适当的级别。有关示例，请参见下面的思维导图。</p><h2 id="0x0100-情报搜集：Level-1"><a href="#0x0100-情报搜集：Level-1" class="headerlink" title="0x0100 情报搜集：Level 1"></a>0x0100 情报搜集：Level 1</h2><p>（思考：合规驱动）主要是点击按钮的信息收集过程。这种信息水平几乎可以完全通过自动化工具获得。至少可以说您为PT做过IG(Intelligence Gathering)。</p><p>Acme公司被要求符合PCI / FISMA / HIPAA。“Level 1”的信息收集工作应该适用于满足遵循法规的需求。</p><h2 id="0x0101-情报搜集：Level-2"><a href="#0x0101-情报搜集：Level-2" class="headerlink" title="0x0101 情报搜集：Level 2"></a>0x0101 情报搜集：Level 2</h2><p>（思考：最佳实践）可以使用级别1的自动化工具和一些手动分析来创建此级别。对业务有很好的了解，包括地理位置，业务关系，组织结构图等信息。</p><p>Widgets Inc必须符合PCI，但对其长期安全策略感兴趣，并正在收购一些较小的widget制造商。 “Level 2”的信息收集工作应适合他们的需求。</p><h2 id="0x0102-情报搜集：Level-3"><a href="#0x0102-情报搜集：Level-3" class="headerlink" title="0x0102 情报搜集：Level 3"></a>0x0102 情报搜集：Level 3</h2><p>（思考：国家支持）更高级的渗透测试、Redteam、全范围。来自“Level 1”和“Level 2”的所有信息，以及大量的手动分析。考虑在社交网络(SocNet)上培养关系，大量分析，深入理解业务关系，很可能要花大量的时间来完成收集和关联。</p><p>一支陆军红队的任务是从国外分析和攻击部分陆军网络，以发现可能被外国国民利用的弱点。在这种情况下，需要进行3级信息收集工作。</p><h1 id="0x02-情报搜集"><a href="#0x02-情报搜集" class="headerlink" title="0x02 情报搜集"></a>0x02 情报搜集</h1><h2 id="0x0200-什么是信息搜集？"><a href="#0x0200-什么是信息搜集？" class="headerlink" title="0x0200 什么是信息搜集？"></a>0x0200 什么是信息搜集？</h2><p>情报收集是对目标进行侦察，在漏洞评估和利用阶段收集尽可能多的信息，以便在渗透目标时使用。你能得到的信息越多，将来您就可以使用更多的攻击媒介。</p><p>开源情报(Open source intelligence, OSINT)是情报收集管理的一种形式，涉及从公开来源中查找，选择和获取信息，然后对其进行分析以产生可操作的情报。</p><h2 id="0x0201-为什么进行信息搜集？"><a href="#0x0201-为什么进行信息搜集？" class="headerlink" title="0x0201 为什么进行信息搜集？"></a>0x0201 为什么进行信息搜集？</h2><p>我们执行开源情报收集，以确定进入组织的各种入口点。这些入口点可以是物理的、电子的或者是一个人。许多公司没有考虑到他们将自己的哪些信息公开，以及这些信息如何被有心的攻击者使用。最重要的是，许多员工没有考虑到他们在公共场合放置了哪些关于自己的信息，以及这些信息如何被用来攻击他们或他们的雇主。</p><h2 id="0x0203-它不是什么？-What-is-it-not"><a href="#0x0203-它不是什么？-What-is-it-not" class="headerlink" title="0x0203 它不是什么？(What is it not)"></a>0x0203 它不是什么？(What is it not)</h2><p>OSINT可能不准确或不及时。 可能会故意、意外地操纵信息源以反映错误的数据，信息可能会随着时间的流逝而变得过时，或者仅仅是不完整。</p><p>它不包含翻箱倒柜或从现场发现的实物中检索公司信息的任何方法。</p><h1 id="0x03-目标选择"><a href="#0x03-目标选择" class="headerlink" title="0x03 目标选择"></a>0x03 目标选择</h1><h2 id="0x0300-目标识别和命名-Identification-and-Naming-of-Target"><a href="#0x0300-目标识别和命名-Identification-and-Naming-of-Target" class="headerlink" title="0x0300 目标识别和命名(Identification and Naming of Target)"></a>0x0300 目标识别和命名(Identification and Naming of Target)</h2><p>在接触目标组织时，重要的是要了解一个公司可能有许多不同的顶级域(tdl)和辅助业务。虽然这些信息应该在确定范围阶段就已经发现了，但是确定其他的服务器域和公司也不是很不寻常，这些服务器域和公司可能不属于”前期交互”阶段讨论的初始范围的一部分。例如，一个公司的TDL可能是.com。然而，它们也可能有.net .co和.xxx。这些可能需要成为修订范围的一部分，或者它们可能是禁区。无论采用哪种方式，都需要在测试开始前与客户确认。对于一个公司来说，旗下有许多子公司也不是那么罕见。例如，通用电气(General Electric)和宝洁(Proctor and Gamble)拥有大量较小的公司。</p><h2 id="0x0301-考虑任何参与规则限制-Consider-any-Rules-of-Engagement-limitations"><a href="#0x0301-考虑任何参与规则限制-Consider-any-Rules-of-Engagement-limitations" class="headerlink" title="0x0301 考虑任何参与规则限制(Consider any Rules of Engagement limitations)"></a>0x0301 考虑任何参与规则限制(Consider any Rules of Engagement limitations)</h2><p>在这一点上，最好回顾一下“参与规则”。 这些是在测试期间被遗忘的常见现象。 有时，随着测试人员对发现的内容和攻击可能性的关注变得如此之深，以至于我们忘记了可以攻击哪些IP地址，域和网络。 因此，始终要参考“参与规则”，以使测试重点突出。 这不仅从常规的角度来看很重要，而且从范围蠕变角度也很重要。 每当您偏离测试的核心目标时，都会花费您的时间。 从长远来看，这可能会花费您公司的钱。</p><h2 id="0x0302-考虑测试时间-Consider-time-length-for-test"><a href="#0x0302-考虑测试时间-Consider-time-length-for-test" class="headerlink" title="0x0302 考虑测试时间(Consider time length for test)"></a>0x0302 考虑测试时间(Consider time length for test)</h2><p>整个测试的时间量将直接影响可以完成的情报收集量。 有些测试的总时间为两到三个月。 在这些活动中，测试公司将花费大量时间来调查公司的每个核心业务部门和个人。 但是，对于较短的crystal-box类型的测试，目标可能更具战术性。 例如，测试特定的Web应用程序可能不需要您研究公司CEO的财务记录。</p><h2 id="0x0303-考虑测试的最终目标-Consider-end-goal-of-the-test"><a href="#0x0303-考虑测试的最终目标-Consider-end-goal-of-the-test" class="headerlink" title="0x0303 考虑测试的最终目标(Consider end goal of the test)"></a>0x0303 考虑测试的最终目标(Consider end goal of the test)</h2><p>每个测试都有一个最终目标-组织认为关键的特定资产或过程。 考虑到最终结果，情报收集阶段应确保包括最终目标周围的所有第二、第三元素：无论是技术支持、第三方、相关人员等等。确保重点集中在关键资产上，确保不太相关的情报元素被取消优先级并分类，以避免干扰分析过程。</p><h1 id="0x04-开源情报-OSINT"><a href="#0x04-开源情报-OSINT" class="headerlink" title="0x04 开源情报(OSINT)"></a>0x04 开源情报(OSINT)</h1><p>开源情报（OSINT）采取三种形式： 被动，半被动和主动。</p><ul><li><p><strong>被动信息收集</strong>：被动信息收集通常仅在有非常明确的要求，即目标永远不要检测到信息收集活动时才有用。 从技术上讲，这种类型的配置很难执行，因为我们永远不会从主机之一或“匿名”主机或服务上向Internet发送任何流量到目标组织。 这意味着我们只能使用和收集存档或存储的信息。 因此，此信息可能已过时或不正确，因为我们仅限于从第三方收集的结果。</p></li><li><p><strong>半被动信息收集</strong>：半被动信息收集的目标是使用类似于正常Internet流量和行为的方法来描述目标。 我们仅查询发布的名称服务器以获取信息，我们不执行深入的反向查找或蛮力DNS请求，也不搜索“未发布”的服务器或目录。 我们没有运行网络级的端口扫描器或搜寻器，仅查看发布的文档和文件中的元数据； 不积极寻找隐藏的内容。 这里的关键是不要让别人注意到我们的行为。事后分析中，目标可以返回并发现侦察活动，但他们不应该归咎于任何人的活动。</p></li><li><p><strong>主动信息收集</strong>：目标应检测到主动信息的收集以及可疑或恶意的行为。 在此阶段中，我们正在主动映射网络基础结构（考虑完整的端口扫描：nmap –p1-65535），正在主动枚举或漏洞扫描开放服务，我们正在积极搜索未发布的目录、文件和服务器。 大多数此类活动属于您通常进行标准测试的“侦察”或“扫描”活动。</p></li></ul><h1 id="0x05-企业-Corporate"><a href="#0x05-企业-Corporate" class="headerlink" title="0x05 企业(Corporate)"></a>0x05 企业(Corporate)</h1><h2 id="0x0500-物理上-Physical"><a href="#0x0500-物理上-Physical" class="headerlink" title="0x0500 物理上(Physical)"></a>0x0500 物理上(Physical)</h2><h3 id="地点-Locations-L1"><a href="#地点-Locations-L1" class="headerlink" title="地点(Locations, L1)"></a>地点(Locations, L1)</h3><p>每个位置的完整地址，所有权，相关记录（城市，税收，法律等）的清单，针对该位置的所有物理安全措施的完整清单（摄像头放置，传感器，围栏，护栏，进入控制，大门，识别类型） ，供应商的入口，基于IP块/地理位置服务的物理位置等。对于Hosts/NOC：主机和网络的完整CIDR表示，所有关联资产的完整DNS列表，AS的完整映射，对等路径，CDN设置，netblock所有者（数据），电子邮件记录（MX + 邮件地址结构）</p><ul><li>所有者(L1/L2)</li><li>土地、税收记录(L1/L2)  </li><li>共享、个人 (Shared/individual, L1/L2)  </li><li>时区(L1/L2)  </li><li>Hosts、NOC</li></ul><h3 id="Pervasiveness-L1-无处不在"><a href="#Pervasiveness-L1-无处不在" class="headerlink" title="Pervasiveness (L1)-无处不在"></a>Pervasiveness (L1)-无处不在</h3><p>目标组织具有多个单独的物理位置并不少见。 例如，一家银行将设有中央办公室，但它们也将具有许多远程分支机构。 虽然物理和技术安全性在中心位置可能非常好，但是偏远位置的安全控制通常很差。</p><h3 id="Relationships-L1-人际关系"><a href="#Relationships-L1-人际关系" class="headerlink" title="Relationships (L1)-人际关系"></a>Relationships (L1)-人际关系</h3><p>商业伙伴，海关，供应商，通过公司网页上公开共享的内容进行分析，租赁公司等。此信息可用于更好地理解业务或组织项目。 例如，哪些产品和服务对目标组织至关重要？</p><p>同样，此信息也可以用于创建成功的社会工程场景。</p><ul><li>Relationships (L2/L3)</li><li>Shared office space (L2/L3)</li><li>Shared infrastructure (L2/L3)</li><li>Rented / Leased Equipment (L2/L3)</li></ul><h2 id="0x0501-逻辑上-Logical"><a href="#0x0501-逻辑上-Logical" class="headerlink" title="0x0501 逻辑上(Logical)"></a>0x0501 逻辑上(Logical)</h2><p>合作伙伴，客户和竞争对手的累积信息：每一个都完整列出公司名称，公司地址，关系类型，基本财务信息，基本主机/网络信息。</p><ul><li><p>Business Partners (L1/L2/L3)</p></li><li><p>Business Clients (L1/L2/L3)</p></li><li><p>Competitors (L1/L2/L3)</p></li><li><p>Touchgraph (L1)</p></li><li><p>Hoovers profile (L1/L2)</p></li><li><p>Product line (L2/L3)</p></li><li><p>Market Vertical (L1)</p></li><li><p>Marketing accounts (L2/L3)</p></li><li><p>Meetings (L2/L3)</p></li><li><p>Significant company dates (L1/L2/L3)</p></li><li><p>Job openings (L1/L2)</p></li><li><p>Charity affiliations (L1/L2/L3)</p></li><li><p>RFP, RFQ and other Public Bid Information (L1/L2)</p></li><li><p>Court records (L2/L3)</p></li><li><p>Political donations (L2/L3)</p></li><li><p>Professional licenses or registries (L2/L3)</p></li></ul><h2 id="0x0502-组织图-Org-Chart-L1"><a href="#0x0502-组织图-Org-Chart-L1" class="headerlink" title="0x0502 组织图(Org Chart, L1)"></a>0x0502 组织图(Org Chart, L1)</h2><ul><li>Position identification-位置识别<ul><li>Important people in the organization</li><li>Individuals to specifically target</li></ul></li><li>Transactions-交易次数<ul><li>Mapping on changes within the organization (promotions, lateral movements)</li></ul></li><li>Affiliates-会员关系<ul><li>Mapping of affiliate organizations that are tied to the business</li></ul></li></ul><h2 id="0x0503-电子的-Electronic"><a href="#0x0503-电子的-Electronic" class="headerlink" title="0x0503 电子的(Electronic)"></a>0x0503 电子的(Electronic)</h2><h3 id="0x050300-Document-Metadata-L1-L2"><a href="#0x050300-Document-Metadata-L1-L2" class="headerlink" title="0x050300 Document Metadata (L1/L2)"></a>0x050300 Document Metadata (L1/L2)</h3><ul><li>What it is? Metadata or meta-content provides information about the data/document in scope. It can have information such as author/creator name, time and date, standards used/referred, location in a computer network (printer/folder/directory path/etc. info), geo-tag etc. For an image its’ metadata can contain color, depth, resolution, camera make/type and even the co-ordinates and location information.</li><li>这是什么？ 元数据或元内容提供有关范围内的数据/文档的信息。 它可以具有诸如作者/创建者名称，时间和日期，使用/引用的标准，计算机网络中的位置（打印机/文件夹/目录路径/等信息），地理标记等信息。对于图像，其元数据可以 包含颜色，深度，分辨率，相机品牌/类型，甚至坐标和位置信息。</li><li>Why you would do it? Metadata is important because it contains information about the internal network, user-names, email addresses, printer locations etc. and will help to create a blueprint of the location. It also contains information about software used in creating the respective documents. This can enable an attacker to create a profile and/or perform targeted attacks with internal knowledge on the networks and users.</li><li>为什么要这么做？ 元数据很重要，因为它包含有关内部网络，用户名，电子邮件地址，打印机位置等的信息，并将有助于创建该位置的蓝图。 它还包含有关在创建相应文档时使用的软件的信息。 这可以使攻击者可以利用网络和用户的内部知识来创建配置文件和/或执行有针对性的攻击。</li><li>How you would do it? There are tools available to extract the metadata from the file (pdf/word/image) like FOCA (GUI-based), metagoofil (python-based), meta-extractor, exiftool (perl-based). These tools are capable of extracting and displaying the results in different formats as HTML, XML, GUI, JSON etc. The input to these tools is mostly a document downloaded from the public presence of the ‘client’ and then analyzed to know more about it. Whereas FOCA helps you search documents, download and analyzes all through its GUI interface.</li><li>你会怎么做？ 有一些工具可以从文件（pdf / word / image）中提取元数据，例如FOCA（基于GUI），metagoofil（基于python），元提取器，exiftool（基于perl）。 这些工具能够以HTML，XML，GUI，JSON等不同格式提取和显示结果。这些工具的输入大部分是从“客户”的公共场合下载的文档，然后进行分析以了解更多信息。 。 FOCA可帮助您通过其GUI界面搜索文档，下载和分析所有内容。</li></ul><h3 id="0x050301-Marketing-Communications-L1-L2-营销传播"><a href="#0x050301-Marketing-Communications-L1-L2-营销传播" class="headerlink" title="0x050301 Marketing Communications (L1/L2) -营销传播"></a>0x050301 Marketing Communications (L1/L2) -营销传播</h3><ul><li>Past marketing campaigns provide information for projects which might of been retired that might still be accessible.</li><li>过去的营销活动为可能已经退休但仍可以访问的项目提供信息。</li><li>Current marketing communications contain design components (Colors, Fonts, Graphics etc..) which are for the most part used internally as well.</li><li>当前的营销传播包含设计组件（颜色，字体，图形等），这些组件也大部分在内部使用。</li><li>Additional contact information including external marketing organizations.</li><li>其他联系信息，包括外部营销组织。</li></ul><h2 id="0x0504-基础设施资产-Infrastructure-Assets"><a href="#0x0504-基础设施资产-Infrastructure-Assets" class="headerlink" title="0x0504 基础设施资产(Infrastructure Assets)"></a>0x0504 基础设施资产(Infrastructure Assets)</h2><h3 id="0x050400-Network-blocks-owned-L1-拥有的网络块"><a href="#0x050400-Network-blocks-owned-L1-拥有的网络块" class="headerlink" title="0x050400 Network blocks owned (L1) - 拥有的网络块"></a>0x050400 Network blocks owned (L1) - 拥有的网络块</h3><ul><li>Network Blocks owned by the organization can be passively obtained from performing whois searches. DNSStuff.com is a one stop shop for obtaining this type of information.</li><li>可以通过执行Whois搜索来被动获取组织拥有的网络块。 DNSStuff.com是获取此类信息的一站式服务。</li><li>Open Source searches for IP Addresses could yield information about the types of infrastructure at the target. Administrators often post ip address information in the context of help requests on various support sites.</li><li>开源搜索IP地址可能会产生有关目标上基础结构类型的信息。 管理员通常会在各种支持站点上的帮助请求上下文中发布ip地址信息。</li></ul><h3 id="0x050401-Email-addresses-L1"><a href="#0x050401-Email-addresses-L1" class="headerlink" title="0x050401 Email addresses (L1)"></a>0x050401 Email addresses (L1)</h3><ul><li>E-mail addresses provide a potential list of valid usernames and domain structure</li><li>电子邮件地址提供了有效用户名和域结构的潜在列表</li><li>E-mail addresses can be gathered from multiple sources including the organizations website.</li><li>可以从包括组织网站在内的多个来源收集电子邮件地址。</li></ul><h3 id="0x050402-External-infrastructure-profile-L1-外部基础架构简介"><a href="#0x050402-External-infrastructure-profile-L1-外部基础架构简介" class="headerlink" title="0x050402 External infrastructure profile (L1) - 外部基础架构简介"></a>0x050402 External infrastructure profile (L1) - 外部基础架构简介</h3><ul><li>The target’s external infrastructure profile can provide immense information about the technologies used internally.</li><li>目标的外部基础结构配置文件可以提供有关内部使用的技术的大量信息。</li><li>This information can be gathered from multiple sources both passively and actively.</li><li>可以从多个来源被动地和主动地收集此信息。</li><li>The profile should be utilized in assembling an attack scenario against the external infrastructure.</li><li>在组合针对外部基础架构的攻击方案时，应使用该配置文件。</li></ul><h3 id="0x050403-Technologies-used-L1-L2-使用的技术"><a href="#0x050403-Technologies-used-L1-L2-使用的技术" class="headerlink" title="0x050403 Technologies used (L1/L2) - 使用的技术"></a>0x050403 Technologies used (L1/L2) - 使用的技术</h3><ul><li>OSINT searches through support forums, mailing lists and other resources can gather information of technologies used at the target</li><li>OSINT通过支持论坛，邮件列表和其他资源进行搜索可以收集目标使用的技术信息</li><li>Use of Social engineering against the identified information technology organization</li><li>针对确定的信息技术组织使用社会工程学</li><li>Use of social engineering against product vendors</li><li>对产品供应商使用社交工程</li></ul><h3 id="0x050404-Purchase-agreements-L1-L2-L3-采购协议"><a href="#0x050404-Purchase-agreements-L1-L2-L3-采购协议" class="headerlink" title="0x050404 Purchase agreements (L1/L2/L3) - 采购协议"></a>0x050404 Purchase agreements (L1/L2/L3) - 采购协议</h3><ul><li>Purchase agreements contain information about hardware, software, licenses and additional tangible asset in place at the target.</li><li>采购协议包含有关目标上就位的硬件，软件，许可证和其他有形资产的信息。</li></ul><h3 id="0x050405-Remote-access-L1-L2"><a href="#0x050405-Remote-access-L1-L2" class="headerlink" title="0x050405 Remote access (L1/L2)"></a>0x050405 Remote access (L1/L2)</h3><ul><li>Obtaining information on how employees and/or clients connect into the target for remote access provides a potential point of ingress.</li><li>获取有关员工和/或客户如何连接到目标以进行远程访问的信息可提供潜在的入口点。</li><li>Often times link to remote access portal are available off of the target’s home page</li><li>通常，可以从目标主页上获得到远程访问门户的链接</li><li>How To documents reveal applications/procedures to connect for remote users</li><li>如何记录揭示远程用户连接的应用程序/过程</li></ul><h3 id="0x050406-Application-usage-L1-L2-应用程序使用"><a href="#0x050406-Application-usage-L1-L2-应用程序使用" class="headerlink" title="0x050406 Application usage (L1/L2) - 应用程序使用"></a>0x050406 Application usage (L1/L2) - 应用程序使用</h3><p>Gather a list of known application used by the target organization. This can often be achieved by extracting metadata from publicly accessible files (as discussed previously)</p><p>收集目标组织使用的已知应用程序列表。 这通常可以通过从公共可访问文件中提取元数据来实现（如前所述）</p><h3 id="0x050407-Defense-technologies-L1-L2-L3-国防技术"><a href="#0x050407-Defense-technologies-L1-L2-L3-国防技术" class="headerlink" title="0x050407 Defense technologies (L1/L2/L3) - 国防技术"></a>0x050407 Defense technologies (L1/L2/L3) - 国防技术</h3><p>Fingerprinting defensive technologies in use can be achieved in a number of ways depending on the defenses in use.</p><p>根据使用的防御方式，可以采用多种方式实现使用的指纹防御技术。</p><h4 id="被动指纹-Passive-fingerprinting"><a href="#被动指纹-Passive-fingerprinting" class="headerlink" title="被动指纹(Passive fingerprinting)"></a>被动指纹(Passive fingerprinting)</h4><ul><li>Search forums and publicly accessible information where technicians of the target organisation may be discussing issues or asking for assistance on the technology in use</li><li>搜索论坛和可公开访问的信息，目标组织的技术人员可能会在其中讨论问题或寻求有关正在使用的技术的帮助</li><li>Search marketing information for the target organisation as well as popular technology vendors</li><li>搜索目标组织以及流行技术供应商的营销信息</li><li>Using Tin-eye (or another image matching tool) search for the target organisations logo to see if it is listed on vendor reference pages or marketing material</li><li>使用Tin-eye（或其他图像匹配工具）搜索目标组织徽标，以查看其是否列在供应商参考页或营销材料上</li></ul><h4 id="主动指纹-Active-fingerprinting"><a href="#主动指纹-Active-fingerprinting" class="headerlink" title="主动指纹(Active fingerprinting)"></a>主动指纹(Active fingerprinting)</h4><ul><li>Send appropriate probe packets to the public facing systems to test patterns in blocking. Several tools exist for fingerprinting of specific WAF types.</li><li>将适当的探测包发送到面向公众的系统，以测试阻塞模式。 存在几种用于特定WAF类型的指纹识别的工具。</li><li>Header information both in responses from the target website and within emails often show information not only on the systems in use, but also the specific protection mechanisms enabled (e.g. Email gateway Anti-virus scanners)</li><li>来自目标网站的响应和电子邮件中的标头信息通常不仅显示有关正在使用的系统的信息，而且还显示启用的特定保护机制（例如，电子邮件网关防病毒扫描程序）</li></ul><h3 id="0x050408-人的能力-Human-capability-L1-L2-L3"><a href="#0x050408-人的能力-Human-capability-L1-L2-L3" class="headerlink" title="0x050408 人的能力(Human capability, L1/L2/L3)"></a>0x050408 人的能力(Human capability, L1/L2/L3)</h3><p>Discovering the defensive human capability of a target organization can be difficult. There are several key pieces of information that could assist in judging the security of the target organization.</p><p>发现目标组织的防御人员能力可能很困难。 有几项关键信息可以帮助判断目标组织的安全性。</p><ul><li>Check for the presence of a company-wide CERT/CSIRT/PSRT team</li><li>检查公司范围内的CERT / CSIRT / PSRT团队是否存在</li><li>Check for advertised jobs to see how often a security position is listed</li><li>检查发布的作业以查看列出安全位置的频率</li><li>Check for advertised jobs to see if security is listed as a requirement for non-security jobs (e.g. developers)</li><li>检查发布的工作，以查看是否将安全性列为非安全性工作的要求（例如，开发人员）</li><li>Check for out-sourcing agreements to see if the security of the target has been outsourced partially or in it’s entirety</li><li>检查外包协议，以查看目标的安全性是否已部分或全部外包</li><li>Check for specific individuals working for the company that may be active in the security community</li><li>检查在安全社区中活跃于公司的特定人员</li></ul><h2 id="0x0505-Financial-金融"><a href="#0x0505-Financial-金融" class="headerlink" title="0x0505 Financial(金融)"></a>0x0505 Financial(金融)</h2><h3 id="0x050500-财务报告-Reporting-L1-L2"><a href="#0x050500-财务报告-Reporting-L1-L2" class="headerlink" title="0x050500 财务报告(Reporting, L1/L2)"></a>0x050500 财务报告(Reporting, L1/L2)</h3><p>The targets financial reporting will depend heavily on the location of the organization. Reporting may also be made through the organizations head office and not for each branch office. In 2008 the SEC issued a proposed roadmap for adoption of the International Financial Reporting Standards (IFRS) in the US.</p><p>目标财务报告将在很大程度上取决于组织的位置。 也可以通过组织总部而不是每个分支机构进行报告。 SEC在2008年发布了在美国采用国际财务报告准则（IFRS）的拟议路线图。</p><p>IFRS Adoption per country –&gt; <a href="http://www.iasplus.com/en/resources/use-of-ifrs">http://www.iasplus.com/en/resources/use-of-ifrs</a></p><p>各国采用IFRS的情况 -&gt;  <a href="http://www.iasplus.com/en/resources/use-of-ifrs">http://www.iasplus.com/en/resources/use-of-ifrs</a></p><h3 id="0x050501-市场分析-Market-analysis-L1-L2-L3"><a href="#0x050501-市场分析-Market-analysis-L1-L2-L3" class="headerlink" title="0x050501 市场分析(Market analysis, L1/L2/L3)"></a>0x050501 市场分析(Market analysis, L1/L2/L3)</h3><ul><li>Obtain market analysis reports from analyst organizations (such as Gartner, IDC, Forrester, 541, etc…). This should include what the market definition is, market cap, competitors, and any major changes to the valuation, product, or company in general.</li><li>从分析机构（如Gartner，IDC，Forrester，541等）获取市场分析报告。 这应该包括市场定义，市值，竞争对手以及总体上对估值，产品或公司的任何重大变化。</li></ul><h4 id="Trade-capital-贸易资金"><a href="#Trade-capital-贸易资金" class="headerlink" title="Trade capital 贸易资金"></a>Trade capital 贸易资金</h4><ul><li>Identify is the organization is allocating any trade capital, and in what percentage of the overall valuation and free capital it has. This will indicate how sensitive the organization is to market fluctuations, and whether it depends on external investment as part of it’s valuation and cash flow.</li><li>确定组织正在分配任何贸易资本，以及它在整体估值和自由资本中所占的百分比。 这将表明组织对市场波动的敏感程度，以及组织是否依赖外部投资作为其估值和现金流量的一部分。</li></ul><h4 id="Value-history-价值记录"><a href="#Value-history-价值记录" class="headerlink" title="Value history 价值记录"></a>Value history 价值记录</h4><ul><li>Charting of the valuation of the organization over time, in order to establish correlation between external and internal events, and their effect on the valuation.</li><li>随时间推移绘制组织估值图表，以建立外部事件和内部事件之间的相关性，以及它们对估值的影响。</li></ul><h4 id="EDGAR-SEC"><a href="#EDGAR-SEC" class="headerlink" title="EDGAR (SEC)"></a>EDGAR (SEC)</h4><ul><li>What is it: EDGAR (the Electronic Data Gathering, Analysis, and Retrieval system) is a database of the U.S. Security and Exchanges Commission (SEC) that contains registration statements, periodic reports, and other information of all companies (both foreign and domestic) who are required by law to file.</li><li>内容：EDGAR（电子数据收集，分析和检索系统）是美国安全与交易委员会（SEC）的数据库，其中包含注册声明，定期报告以及所有公司（外国和国内公司）的其他信息 法律要求提交的人。</li><li>Why do it: EDGAR data is important because, in additional to financial information, it identifies key personnel within a company that may not be otherwise notable from a company’s website or other public presence. It also includes statements of executive compensation, names and addresses of major common stock owners, a summary of legal proceedings against the company, economic risk factors, and other potentially interesting data.</li><li>这么做的理由：EDGAR数据非常重要，因为除了财务信息之外，它还可以识别公司内部的关键人员，而这些人员在公司的网站或其他公众活动中可能不会引起注意。 它还包括高管薪酬声明，主要普通股所有者的姓名和地址，针对公司的法律诉讼摘要，经济风险因素以及其他可能有趣的数据。</li><li>How to obtain: The information is available on the SEC’s EDGAR website (<a href="http://www.sec.gov/edgar.shtml">http://www.sec.gov/edgar.shtml</a>). Reports of particular interest include the 10-K (annual report) and 10-Q (quarterly report).</li><li>如何获取：该信息可在SEC的EDGAR网站（<a href="http://www.sec.gov/edgar.shtml%EF%BC%89%E4%B8%8A%E8%8E%B7%E5%BE%97%E3%80%82">http://www.sec.gov/edgar.shtml）上获得。</a> 特别令人关注的报告包括10-K（年度报告）和10-Q（季度报告）。</li></ul><h1 id="0x06-Individual-个人"><a href="#0x06-Individual-个人" class="headerlink" title="0x06 Individual 个人"></a>0x06 Individual 个人</h1><h2 id="0x0600-Employee-雇员"><a href="#0x0600-Employee-雇员" class="headerlink" title="0x0600 Employee 雇员"></a>0x0600 Employee 雇员</h2><h3 id="0x060000-历史-History"><a href="#0x060000-历史-History" class="headerlink" title="0x060000 历史(History)"></a>0x060000 历史(History)</h3><ul><li>Court Records (L2/L3) 法庭记录<ul><li>What is it: Court records are all the public records related to criminal and/or civil complaints, lawsuits, or other legal actions for or against a person or organization of interest.</li><li>Why you would do it: Court records could potentially reveal sensitive information related to an individual employee or the company as a whole. This information could be useful by itself or may be the driver for gaining additional information. It could also be used for social engineering or other purposes later on in the penetration test.</li><li>How you would do it: Much of this information is now available on the Internet via publicly available court websites and records databases. Some additional information may be available via pay services such as LEXIS/NEXIS. Some information may be available via records request or in person requests.</li></ul></li><li>Political Donations (L2/L3) 政治捐款<ul><li>What is it: Political donations are an individual’s personal funds directed to specific political candidates, political parties, or special interest organizations.</li><li>Why you would do it: Information about political donations could potentially reveal useful information related to an individual. This information could be used as a part of social network analysis to help draw connections between individuals and politicians, political candidates, or other political organizations. It could also be used for social engineering or other purposes later on in the penetration test.</li><li>How you would do it: Much of this information is now available on the Internet via publicly available websites (i.e., <a href="http://www.opensecrets.org/">http://www.opensecrets.org/</a>) that track political donations by individual. Depending upon the laws of a given state, donations over a certain amount are usually required to be recorded.</li></ul></li><li>Professional licenses or registries (L2/L3) 专业执照或注册<ul><li>What is it: Professional licenses or registries are repositories of information that contain lists of members and other related information for individuals who have attained a particular license or some measure of specific affiliation within a community.</li><li>Why you would do it: Information about professional licenses could potentially reveal useful information related to an individual. This information could be used to validate an individual’s trustworthiness (do they really have a particular certification as they claim) or as a part of social network analysisto help draw connections between individuals and other organizations. It could also be used for social engineering or other purposes later on in the penetration test.</li><li>How you would do it: Much of this information is now available on the Internet via publicly available websites. Typically, each organization maintains their own registry of information that may be available online or may require additional steps to gather.</li></ul></li></ul><h3 id="0x060001-社交网络（SocNet）资料-Social-Network-SocNet-Profile"><a href="#0x060001-社交网络（SocNet）资料-Social-Network-SocNet-Profile" class="headerlink" title="0x060001 社交网络（SocNet）资料(Social Network (SocNet) Profile)"></a>0x060001 社交网络（SocNet）资料(Social Network (SocNet) Profile)</h3><ul><li><p>Metadata Leakage (L2/L3)</p><ul><li>Location awareness via Photo Metadata</li></ul></li><li><p>Tone (L2/L3)</p><ul><li>Expected deliverable: subjective identification of the tone used in communications – aggressive, passive, appealing, sales, praising, dissing, condescending, arrogance, elitist, underdog, leader, follower, mimicking, etc…</li></ul></li><li><p>Frequency (L2/L3)</p><ul><li>Expected deliverable: Identification of the frequency of publications (once an hour/day/week, etc…). Additionally - time of day/week in which communications are prone to happen.</li></ul></li><li><p>Location awareness (L2/L3)</p></li></ul><ul><li><p>Bing Map Apps</p></li><li><p>Foursquare</p></li><li><p>Google Latitude</p></li><li><p>Yelp</p></li><li><p>Gowalla</p></li><li><p>Social Media Presence (L1/L2/L3)</p></li></ul><h3 id="0x060002-存在于互联网-Internet-Presence"><a href="#0x060002-存在于互联网-Internet-Presence" class="headerlink" title="0x060002 存在于互联网(Internet Presence)"></a>0x060002 存在于互联网(Internet Presence)</h3><ul><li>Email Address (L1)<ul><li>What it is? Email addresses are the public mail box ids of the users.</li><li>Why you would do it? Email address harvesting or searching is important because it serves multiple purposes - provides a probable user-id format which can later be brute-forced for access but more importantly it helps sending targeted spams and even to automated bots. These spam emails can contain exploits, malware etc. and can be addressed with specific content particularly to a user.</li><li>How you would do it? Email addresses can be searched and extracted from various websites, groups, blogs, forums, social networking portals etc. These email addresses are also available from various tech support websites. There are harvesting and spider tools to perform search for email addresses mapped to a certain domain (if needed).</li></ul></li><li>Personal Handles/Nicknames (L1)</li><li>Personal Domain Names registered (L1/L2)</li><li>Assigned Static IPs/Netblocks (L1/L2)</li></ul><h3 id="0x060003-物理位置-Physical-Location"><a href="#0x060003-物理位置-Physical-Location" class="headerlink" title="0x060003 物理位置(Physical Location)"></a>0x060003 物理位置(Physical Location)</h3><ul><li>Physical Location<ul><li>Can you derive the target’s physical location</li></ul></li></ul><h3 id="0x060004-移动电话痕迹-Mobile-Footprint"><a href="#0x060004-移动电话痕迹-Mobile-Footprint" class="headerlink" title="0x060004 移动电话痕迹(Mobile Footprint)"></a>0x060004 移动电话痕迹(Mobile Footprint)</h3><ul><li>Phone number (L1/L2/L3)</li><li>Device type (L1/L2/L3)</li><li>Use (L1/L2/L3)</li><li>Installed applications (L1/L2/L3)</li><li>Owner/administrator (L1/L2/L3)</li></ul><h3 id="0x060005-“付费”信息-“For-Pay”-Information"><a href="#0x060005-“付费”信息-“For-Pay”-Information" class="headerlink" title="0x060005 “付费”信息(“For Pay” Information)"></a>0x060005 “付费”信息(“For Pay” Information)</h3><ul><li>Background Checks</li><li>For Pay Linked-In</li><li>LEXIS/NEXIS</li></ul><h1 id="0x07-隐蔽收集-Covert-Gathering"><a href="#0x07-隐蔽收集-Covert-Gathering" class="headerlink" title="0x07 隐蔽收集(Covert Gathering)"></a>0x07 隐蔽收集(Covert Gathering)</h1><h2 id="0x0700-企业-Corporate"><a href="#0x0700-企业-Corporate" class="headerlink" title="0x0700 企业(Corporate)"></a>0x0700 企业(Corporate)</h2><h3 id="0x070000-现场收集-On-Location-Gathering"><a href="#0x070000-现场收集-On-Location-Gathering" class="headerlink" title="0x070000 现场收集(On-Location Gathering)"></a>0x070000 现场收集(On-Location Gathering)</h3><p>Selecting specific locations for onsite gathering, and then performing reconnaissance over time (usually at least 2-3 days in order to assure patterns). The following elements are sought after when performing onsite intelligence gathering:</p><p>选择特定地点进行现场搜集，然后随时间进行侦察（通常至少需要2-3天以确保模式）。 执行现场情报收集时，需要以下要素：</p><ul><li>Physical security inspections</li><li>Wireless scanning / RF frequency scanning</li><li>Employee behavior training inspection</li><li>Accessible/adjacent facilities (shared spaces)</li><li>Dumpster diving</li><li>Types of equipment in use</li></ul><h3 id="0x070001-线下收集-Offsite-Gathering"><a href="#0x070001-线下收集-Offsite-Gathering" class="headerlink" title="0x070001 线下收集(Offsite Gathering)"></a>0x070001 线下收集(Offsite Gathering)</h3><p>Identifying offsite locations and their importance/relation to the organization. These are both logical as well as physical locations as per the below:</p><p>识别异地位置及其与组织的重要性/关系。 这些都是逻辑位置以及物理位置，如下所示：</p><ul><li>Data center locations</li><li>Network provisioning/provider</li></ul><h1 id="0x08-人工情报-HUMINT"><a href="#0x08-人工情报-HUMINT" class="headerlink" title="0x08 人工情报(HUMINT)"></a>0x08 人工情报(HUMINT)</h1><p>Human intelligence complements the more passive gathering on the asset as it provides information that could not have been obtained otherwise, as well as add more “personal” perspectives to the intelligence picture (feelings, history, relationships between key individuals, “atmosphere”, etc…)</p><p>间谍活动补充了对资产的更被动的收集，因为它提供了其他方式无法获得的信息，并且为情报画面增加了更多的“个人”观点（感觉，历史，关键人物之间的关系，“气氛”等） …）</p><p>The methodology of obtaining human intelligence always involves direct interaction - whether physical, or verbal. Gathering should be done under an assumed identity, that would be created specifically to achieve optimal information exposure and cooperation from the asset in question.</p><p>获取人类智力的方法总是涉及直接互动-无论是身体上还是语言上的。 收集应该在假定的身份下进行，该身份应专门创建以实现有关资产的最佳信息曝光和合作。</p><p>Additionally, intelligence gathering on more sensitive targets can be performed by utilizing observation only - again, either physically on location, or through electronic/remote means (CCTV, webcams, etc…). This is usually done in order to establish behavioral patterns (such as frequency of visitations, dress code, access paths, key locations that may provide additional access such as coffee shops).</p><p>另外，可以仅通过利用观察来进行对更敏感目标的情报收集-再次在物理上或通过电子/远程手段（CCTV，网络摄像头等）进行。 通常这样做是为了建立行为模式（例如访问频率，着装要求，进出路径，可能提供其他出入的关键位置，例如咖啡店）。</p><h2 id="0x0800-结果-Results"><a href="#0x0800-结果-Results" class="headerlink" title="0x0800 结果(Results)"></a>0x0800 结果(Results)</h2><ul><li>Key Employees</li><li>Partners/Suppliers</li><li>Social Engineering</li></ul><h1 id="0x09-足迹-Footprinting"><a href="#0x09-足迹-Footprinting" class="headerlink" title="0x09 足迹(Footprinting)"></a>0x09 足迹(Footprinting)</h1><p>WHAT IT IS: External information gathering, also known as footprinting, is a phase of information gathering that consists of interaction with the target in order to gain information from a perspective external to the organization.</p><p>它是什么：外部信息收集（也称为足迹覆盖）是信息收集的一个阶段，该阶段包括与目标交互以从组织外部的角度获取信息。</p><p>WHY: Much information can be gathered by interacting with targets. By probing a service or device, you can often create scenarios in which it can be fingerprinted, or even more simply, a banner can be procured which will identify the device. This step is necessary to gather more information about your targets. Your goal, after this section, is a prioritized list of targets.</p><p>原因：与目标互动可以收集很多信息。 通过探测服务或设备，您通常可以创建可以对其进行指纹识别的场景，或者更简单地，可以购买可以识别设备的标语。 必须执行此步骤才能收集有关目标的更多信息。 在此部分之后，您的目标是目标的优先列表。</p><h2 id="0x0900-外部足迹-External-Footprinting"><a href="#0x0900-外部足迹-External-Footprinting" class="headerlink" title="0x0900 外部足迹(External Footprinting)"></a>0x0900 外部足迹(External Footprinting)</h2><h3 id="0x090000-识别客户外部范围-Identify-Customer-External-Ranges"><a href="#0x090000-识别客户外部范围-Identify-Customer-External-Ranges" class="headerlink" title="0x090000 识别客户外部范围(Identify Customer External Ranges)"></a>0x090000 识别客户外部范围(Identify Customer External Ranges)</h3><p>One of the major goals of intelligence gathering during a penetration test is to determine hosts which will be in scope. There are a number of techniques which can be used to identify systems, including using reverse DNS lookups, DNS bruting, WHOIS searches on the domains and the ranges. These techniques and others are documented below.</p><p>在渗透测试期间收集情报的主要目标之一是确定将在范围内的主机。 有许多技术可用于识别系统，包括使用反向DNS查找，DNS粗化，在域和范围上进行WHOIS搜索。 这些技术和其他技术记录在下面。</p><h3 id="0x090001-被动识别"><a href="#0x090001-被动识别" class="headerlink" title="0x090001 被动识别"></a>0x090001 被动识别</h3><h4 id="WHOIS查询"><a href="#WHOIS查询" class="headerlink" title="WHOIS查询"></a>WHOIS查询</h4><p>For external footprinting, we first need to determine which one of the WHOIS servers contains the information we’re after. Given that we should know the TLD for the target domain, we simply have to locate the Registrar that the target domain is registered with.</p><p>对于外部足迹，我们首先需要确定其中一个WHOIS服务器包含我们要获取的信息。 鉴于我们应该了解目标域的顶级域名（TLD），我们只需要找到注册目标域的注册服务商。</p><p>WHOIS information is based upon a tree hierarchy. ICANN (IANA) is the authoritative registry for all of the TLDs and is a great starting point for all manual WHOIS queries.</p><p>WHOIS信息基于树的层次结构。 ICANN（IANA）是所有TLD的权威注册机构，并且是所有手动WHOIS查询的良好起点。</p><ul><li>ICANN - <a href="http://www.icann.org/">http://www.icann.org</a></li><li>IANA - <a href="http://www.iana.com/">http://www.iana.com</a></li><li>NRO - <a href="http://www.nro.net/">http://www.nro.net</a></li><li>AFRINIC - <a href="http://www.afrinic.net/">http://www.afrinic.net</a></li><li>APNIC - <a href="http://www.apnic.net/">http://www.apnic.net</a></li><li>ARIN - <a href="http://ws.arin.net/">http://ws.arin.net</a></li><li>LACNIC - <a href="http://www.lacnic.net/">http://www.lacnic.net</a></li><li>RIPE - <a href="http://www.ripe.net/">http://www.ripe.net</a></li></ul><p>Once the appropriate Registrar was queried we can obtain the Registrant information. There are numerous sites that offer WHOIS information; however for accuracy in documentation, you need to use only the appropriate Registrar.</p><ul><li>InterNIC - <a href="http://www.internic.net/">http://www.internic.net/</a> <a href="http://www.internic.net/">http://www.internic.net</a>]</li></ul><p>Typically, a simple whois against ARIN will refer you to the correct registrar.</p><h4 id="BGP-looking-glasses"><a href="#BGP-looking-glasses" class="headerlink" title="BGP looking glasses"></a>BGP looking glasses</h4><p>It is possible to identify the Autonomous System Number (ASN) for networks that participate in Border Gateway Protocol (BGP). Since BGP route paths are advertised throughout the world we can find these by using a BGP4 and BGP6 looking glass.</p><ul><li>BGP4 - <a href="http://www.google.com/url?q=http://www.bgp4.as/looking-glasses&sa=D&sntz=1&usg=AFQjCNGJNLNRaL6xeGcya4mZ9NPyOFd8Tg">http://www.bgp4.as/looking-glasses</a></li><li>BPG6 - <a href="http://lg.he.net/">http://lg.he.net/</a></li></ul><h3 id="0x090002-主动足迹"><a href="#0x090002-主动足迹" class="headerlink" title="0x090002 主动足迹"></a>0x090002 主动足迹</h3><h4 id="端口扫描"><a href="#端口扫描" class="headerlink" title="端口扫描"></a>端口扫描</h4><p>Port scanning techniques will vary based on the amount of time available for the test, and the need to be stealthy. If there is zero knowledge of the systems, a fast ping scan can be used to identify systems. In addition, a quick scan without ping verification (-PN in nmap) should be run to detect the most common ports avialable. Once this is complete, a more comprehensive scan can be run. Some testers check for only open TCP ports, make sure to check UDP as well. The <a href="http://nmap.org/nmap_doc.html">http://nmap.org/nmap_doc.html</a> document details port scan types. Nmap (“Network Mapper”) is the de facto standard for network auditing/scanning. Nmap runs on both Linux and Windows.</p><p>端口扫描技术会根据测试可用的时间以及隐身的需求而有所不同。 如果对系统的了解为零，则可以使用快速ping扫描来识别系统。 此外，应运行没有ping验证的快速扫描（nmap中的-PN），以检测可用的最常见端口。 完成此操作后，即可运行更全面的扫描。 一些测试人员仅检查打开的TCP端口，并确保同时检查UDP。 <a href="http://nmap.org/nmap_doc.html%E6%96%87%E6%A1%A3%E8%AF%A6%E7%BB%86%E4%BB%8B%E7%BB%8D%E4%BA%86%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F%E7%B1%BB%E5%9E%8B%E3%80%82">http://nmap.org/nmap_doc.html文档详细介绍了端口扫描类型。</a> Nmap（“网络映射器”）是网络审核/扫描的事实上的标准。 Nmap可在Linux和Windows上运行。</p><p>You can find more information on the use of Nmap for this purpose in the <a href="http://www.pentest-standard.org/index.php/PTES_Technical_Guidelines#Nmap_.28Windows.2FLinux.29">PTES Technical Guideline</a></p><p>您可以在<a href="http://www.pentest-standard.org/index.php/PTES_Technical_Guidelines#Nmap_.28Windows.2FLinux.29">PTES Technical Guideline</a>中找到有关为此目的使用Nmap的更多信息。</p><p>Nmap has dozens of options available. Since this section is dealing with port scanning, we will focus on the commands required to perform this task. It is important to note that the commands utilized depend mainly on the time and number of hosts being scanned. The more hosts or less time that you have to perform this tasks, the less that we will interrogate the host. This will become evident as we continue to discuss the options.</p><p>Nmap有许多可用的选项。 由于本节涉及端口扫描，因此我们将重点介绍执行此任务所需的命令。 重要的是要注意，所使用的命令主要取决于扫描的主机的时间和数量。 执行此任务所需的主机越多或所需的时间越少，我们对主机的询问就越少。 随着我们继续讨论这些选项，这一点将变得显而易见。</p><p>IPv6 should also be tested.</p><p>IPv6也应进行测试。</p><h4 id="获取Banner"><a href="#获取Banner" class="headerlink" title="获取Banner"></a>获取Banner</h4><p>Banner Grabbing is an enumeration technique used to glean information about computer systems on a network and the services running its open ports. Banner grabbing is used to identify network the version of applications and operating system that the target host are running.</p><p>Banner Grabbing是一种枚举技术，用于收集有关网络上的计算机系统以及运行其开放端口的服务的信息。 标语抓取用于识别网络上目标主机正在运行的应用程序和操作系统的版本。</p><p>Banner grabbing is usually performed on Hyper Text Transfer Protocol (HTTP), File Transfer Protocol (FTP), and Simple Mail Transfer Protocol (SMTP); ports 80, 21, and 25 respectively. Tools commonly used to perform banner grabbing are Telnet, nmap, and Netcat.</p><p>横幅广告抓取通常在超文本传输协议（HTTP），文件传输协议（FTP）和简单邮件传输协议（SMTP）上执行； 端口80、21和25。 常用的执行横幅抓取的工具是Telnet，nmap和Netcat。</p><h4 id="SNMP扫描"><a href="#SNMP扫描" class="headerlink" title="SNMP扫描"></a>SNMP扫描</h4><p>SNMP sweeps are performed too as they offer tons of information about a specific system. The SNMP protocol is a stateless, datagram oriented protocol. Unfortunately SNMP servers don’t respond to requests with invalid community strings and the underlying UDP protocol does not reliably report closed UDP ports. This means that “no response” from a probed IP address can mean either of the following:</p><p>SNMP扫描也会执行，因为它们提供了有关特定系统的大量信息。 SNMP协议是无状态的，面向数据报的协议。 不幸的是，SNMP服务器无法使用无效的社区字符串来响应请求，并且基础UDP协议无法可靠地报告已关闭的UDP端口。 这意味着被探测的IP地址“无响应”可能表示以下任一情况：</p><ul><li>machine unreachable</li><li>SNMP server not running</li><li>invalid community string</li><li>the response datagram has not yet arrived</li></ul><h4 id="DNS区域转移"><a href="#DNS区域转移" class="headerlink" title="DNS区域转移"></a>DNS区域转移</h4><p>DNS zone transfer, also known as AXFR, is a type of DNS transaction. It is a mechanism designed to replicate the databases containing the DNS data across a set of DNS servers. Zone transfer comes in two flavors, full (AXFR) and incremental (IXFR). There are numerous tools available to test the ability to perform a DNS zone transfer. Tools commonly used to perform zone transfers are host, dig and nmap.</p><p>DNS区域传输，也称为AXFR，是一种DNS事务。 它是一种旨在跨一组DNS服务器复制包含DNS数据的数据库的机制。 区域传输有两种方式，完全（AXFR）和增量（IXFR）。 有许多工具可用来测试执行DNS区域传输的能力。 通常用于执行区域传输的工具是host，dig和nmap。</p><h4 id="SMTP反弹-SMTP-Bounce-Back"><a href="#SMTP反弹-SMTP-Bounce-Back" class="headerlink" title="SMTP反弹(SMTP Bounce Back )"></a>SMTP反弹(SMTP Bounce Back )</h4><p>SMTP bounce back, also called a Non-Delivery Report/Receipt (NDR), a (failed) Delivery Status Notification (DSN) message, a Non-Delivery Notification (NDN) or simply a bounce, is an automated electronic mail message from a mail system informing the sender of another message about a delivery problem. This can be used to assist an attacker in fingerprint the SMTP server as SMTP server information, including software and versions, may be included in a bounce message.</p><p>SMTP反弹，也称为未送达报告/收据（NDR），（失败）传递状态通知（DSN）消息，未送达通知（NDN）或简称为反弹，是来自 邮件系统，通知其他发送者有关传递问题的消息。 这可以用于协助攻击者对SMTP服务器进行指纹识别，因为退回消息中可能包含SMTP服务器信息（包括软件和版本）。</p><p>This can be done by simply creating a bogus address within the target’s domain. For instance, <a href="mailto:&#97;&#x73;&#68;&#x46;&#x41;&#68;&#83;&#70;&#95;&#103;&#97;&#114;&#98;&#x61;&#103;&#101;&#95;&#97;&#100;&#100;&#114;&#101;&#115;&#x73;&#x40;&#x74;&#x61;&#x72;&#103;&#101;&#116;&#46;&#99;&#x6f;&#109;">&#97;&#x73;&#68;&#x46;&#x41;&#68;&#83;&#70;&#95;&#103;&#97;&#114;&#98;&#x61;&#103;&#101;&#95;&#97;&#100;&#100;&#114;&#101;&#115;&#x73;&#x40;&#x74;&#x61;&#x72;&#103;&#101;&#116;&#46;&#99;&#x6f;&#109;</a> could be used to test target.com. Gmail provides full access to the headers, making it an easy choice for testers.</p><p>只需在目标域内创建伪地址即可完成此操作。 例如，asDFADSF_garbage_address @ target.com可用于测试target.com。 Gmail提供了对标头的完全访问权限，使测试人员可以轻松选择。</p><h4 id="DNS发现"><a href="#DNS发现" class="headerlink" title="DNS发现"></a>DNS发现</h4><p>DNS discovery can be performed by looking at the WHOIS records for the domain’s authoritative nameserver. Additionally, variations of the main domain name should be checked, and the website should be checked for references to other domains which could be under the target’s control.</p><p>可以通过查看域的权威名称服务器的WHOIS记录来执行DNS发现。 此外，应检查主域名的变体，并应检查网站上是否有对其他域名的引用，这些引用可能在目标的控制之下。</p><h4 id="正向-反向DNS"><a href="#正向-反向DNS" class="headerlink" title="正向/反向DNS"></a>正向/反向DNS</h4><p>Reverse DNS can be used to obtain valid server names in use within an organizational. There is a caveat that it must have a PTR (reverse) DNS record for it to resolve a name from a provided IP address. If it does resolve then the results are returned. This is usually performed by testing the server with various IP addresses to see if it returns any results.</p><p>反向DNS可以用于获取组织内使用的有效服务器名称。 需要注意的是，它必须具有PTR（反向）DNS记录，才能从提供的IP地址解析名称。 如果能够解决，则返回结果。 通常通过使用各种IP地址测试服务器以查看其是否返回任何结果来执行此操作。</p><h4 id="DNS暴力破解"><a href="#DNS暴力破解" class="headerlink" title="DNS暴力破解"></a>DNS暴力破解</h4><p>After identifying all the information that is associated with the client domain(s), it is now time to begin to query DNS. Since DNS is used to map IP addresses to hostnames, and vice versa we will want to see if it is insecurely configure. We will seek to use DNS to reveal additional information about the client. One of the most serious misconfigurations involving DNS is allowing Internet users to perform a DNS zone transfer. There are several tools that we can use to enumerate DNS to not only check for the ability to perform zone transfers, but to potentially discover additional host names that are not commonly known.</p><p>识别与客户端域关联的所有信息之后，现在该开始查询DNS了。 由于DNS用于将IP地址映射到主机名，反之亦然，我们将要查看它是否配置不安全。 我们将寻求使用DNS来揭示有关客户端的其他信息。 涉及DNS的最严重的错误配置之一是允许Internet用户执行DNS区域传输。 我们可以使用多种工具来枚举DNS，这些工具不仅可以检查执行区域传输的能力，而且还可以潜在地发现其他未知的主机名。</p><h4 id="Web应用发现"><a href="#Web应用发现" class="headerlink" title="Web应用发现"></a>Web应用发现</h4><p>Identifying weak web applications can be a particularly fruitful activity during a penetration test. Things to look for include OTS applications that have been misconfigured, OTS application which have plugin functionality (plugins often contain more vulnerable code than the base application), and custom applications. Web application fingerprinters such as WAFP can be used here to great effect.</p><p>在渗透测试期间，识别薄弱的Web应用程序可能会特别富有成果。 要寻找的内容包括配置错误的OTS应用程序，具有插件功能的OTS应用程序（插件通常比基本应用程序包含更多易受攻击的代码）以及自定义应用程序。 Web应用程序指纹识别器（例如WAFP）可以在这里发挥很大的作用。</p><h4 id="虚拟主机检测和枚举"><a href="#虚拟主机检测和枚举" class="headerlink" title="虚拟主机检测和枚举"></a>虚拟主机检测和枚举</h4><p>Web servers often host multiple “virtual” hosts to consolidate functionality on a single server. If multiple servers point to the same DNS address, they may be hosted on the same server. Tools such as MSN search can be used to map an ip address to a set of virtual hosts.</p><p>Web服务器通常托管多个“虚拟”主机，以在单个服务器上整合功能。 如果多个服务器指向相同的DNS地址，则它们可能位于同一服务器上。 可以使用诸如MSN搜索之类的工具将ip地址映射到一组虚拟主机。</p><h3 id="0x090003-建立外部目标清单-Establish-External-Target-List"><a href="#0x090003-建立外部目标清单-Establish-External-Target-List" class="headerlink" title="0x090003 建立外部目标清单(Establish External Target List)"></a>0x090003 建立外部目标清单(Establish External Target List)</h3><p>Once the activities above have been completed, a list of users, emails, domains, applications, hosts and services should be compiled.</p><p>完成以上活动后，应编译用户，电子邮件，域，应用程序，主机和服务的列表。</p><h4 id="映射版本"><a href="#映射版本" class="headerlink" title="映射版本"></a>映射版本</h4><p>Version checking is a quick way to identify application information. To some extent, versions of services can be fingerprinted using nmap, and versions of web applications can often be gathered by looking at the source of an arbitrary page.</p><p>版本检查是识别应用程序信息的快速方法。 在某种程度上，可以使用nmap对服务的版本进行指纹识别，并且通常可以通过查看任意页面的源来收集Web应用程序的版本。</p><h4 id="识别补丁程序级别"><a href="#识别补丁程序级别" class="headerlink" title="识别补丁程序级别"></a>识别补丁程序级别</h4><p>To identify the patch level of services internally, consider using software which will interrogate the system for differences between versions. Credentials may be used for this phase of the penetration test, provided the client has acquiesced. Vulnerability scanners are particularly effective at identifying patch levels remotely, without credentials.</p><p>要在内部确定服务的补丁程序级别，请考虑使用会询问系统版本之间差异的软件。 如果客户已默认，则可将证书用于渗透测试的此阶段。 漏洞扫描程序在没有凭据的情况下远程识别补丁程序级别特别有效。</p><h4 id="寻找脆弱的Web应用程序"><a href="#寻找脆弱的Web应用程序" class="headerlink" title="寻找脆弱的Web应用程序"></a>寻找脆弱的Web应用程序</h4><p>Identifying weak web applications can be a particularly fruitful activity during a penetration test. Things to look for include OTS applications that have been misconfigured, OTS application which have plugin functionality (plugins often contain more vulnerable code than the base application), and custom applications. Web application fingerprinters such as WAFP can be used here to great effect.</p><p>在渗透测试期间，识别薄弱的Web应用程序可能会特别富有成果。 要寻找的内容包括配置错误的OTS应用程序，具有插件功能的OTS应用程序（插件通常比基本应用程序包含更多易受攻击的代码）以及自定义应用程序。 Web应用程序指纹识别器（例如WAFP）可以在这里发挥很大的作用。</p><h4 id="识别锁定阈值"><a href="#识别锁定阈值" class="headerlink" title="识别锁定阈值"></a>识别锁定阈值</h4><p>Identifying the lockout threshold of an authentication service will allow you to ensure that your bruteforce attacks do not intentionally lock out valid users during your testing. Identify all disparate authentication services in the environment, and test a single, innocuous account for lockout. Often 5 - 10 tries of a valid account is enough to determine if the service will lock users out.</p><p>确定身份验证服务的锁定阈值将使您确保暴力测试不会在测试期间故意锁定有效用户。 识别环境中所有不同的身份验证服务，并测试单个无害帐户的锁定。 通常，尝试5到10次有效帐户就足以确定该服务是否会将用户拒之门外。</p><h2 id="0x0901-内部足迹-Internal-Footprinting"><a href="#0x0901-内部足迹-Internal-Footprinting" class="headerlink" title="0x0901 内部足迹(Internal Footprinting)"></a>0x0901 内部足迹(Internal Footprinting)</h2><h3 id="0x090100-被动识别-Passive-Reconnaissance"><a href="#0x090100-被动识别-Passive-Reconnaissance" class="headerlink" title="0x090100 被动识别(Passive Reconnaissance)"></a>0x090100 被动识别(Passive Reconnaissance)</h3><p>如果测试人员能够访问内部网络，则数据包嗅探可以提供大量的信息。使用诸如p0f中实现的技术来识别系统。</p><h3 id="0x090101-识别客户内部范围-Identify-Customer-Internal-Ranges"><a href="#0x090101-识别客户内部范围-Identify-Customer-Internal-Ranges" class="headerlink" title="0x090101 识别客户内部范围(Identify Customer Internal Ranges)"></a>0x090101 识别客户内部范围(Identify Customer Internal Ranges)</h3><p>When performing internal testing, first enumerate your local subnet, and you can often extrapolate from there to other subnets by modifying the address slightly. Also, a look a the routing table of an internal host can be particularly telling. Below are a number of techniques which can be used.</p><p>在执行内部测试时，首先枚举您的本地子网，然后经常可以通过稍微修改地址从本地子网推断到其他子网。 <strong>此外，从内部主机的路由表来看，这可能特别有用。</strong> 以下是可以使用的多种技术。</p><p>DHCP servers can be a potential source of not just local information, but also remote IP range and details of important hosts. Most DHCP servers will provide a local IP gateway address as well as the address of DNS and WINS servers. In Windows based networks, DNS servers tend to be Active Directory domain controllers, and thus targets of interest.</p><p>DHCP服务器不仅可以作为本地信息的来源，而且可以作为远程IP范围和重要主机的详细信息的潜在来源。 大多数DHCP服务器将提供本地IP网关地址以及DNS和WINS服务器的地址。 在基于Windows的网络中，DNS服务器往往是Active Directory域控制器，因此是目标对象。</p><h3 id="0x090102-主动侦察-Active-Reconnaissance"><a href="#0x090102-主动侦察-Active-Reconnaissance" class="headerlink" title="0x090102 主动侦察(Active Reconnaissance)"></a>0x090102 主动侦察(Active Reconnaissance)</h3><p>内部主动侦察应包含外部主动侦察的所有要素，此外还应关注内部网的功能，如:</p><ul><li>Directory services (Active Directory, Novell, Sun, etc…)</li><li>Intranet sites providing business functionality</li><li>Enterprise applications (ERP, CRM, Accounting, etc…)</li><li>Identification of sensitive network segments (accounting, R&amp;D, marketing, etc…)</li><li>Access mapping to production networks (datacenters)</li><li>VoIP infrastructure</li><li>Authentication provisioning (kerberos, cookie tokens, etc…)</li><li>Proxying and internet access management</li></ul><h1 id="0x0A-识别保护机制-Identify-Protection-Mechanisms"><a href="#0x0A-识别保护机制-Identify-Protection-Mechanisms" class="headerlink" title="0x0A 识别保护机制(Identify Protection Mechanisms)"></a>0x0A 识别保护机制(Identify Protection Mechanisms)</h1><p>应根据范围中的相关位置、组和人员来标识和映射以下元素。 这将使得在执行实际攻击时能够正确应用漏洞研究和利用，从而最大程度地提高了攻击效率，并最大程度地降低了检测率。</p><h2 id="0x0A00-基于网络的保护"><a href="#0x0A00-基于网络的保护" class="headerlink" title="0x0A00 基于网络的保护"></a>0x0A00 基于网络的保护</h2><ul><li>简单的包过滤</li><li>流量控制设备</li><li>DLP System(信息泄露防护系统)</li><li>加密/隧道</li></ul><h2 id="0x0A01-基于主机的保护"><a href="#0x0A01-基于主机的保护" class="headerlink" title="0x0A01 基于主机的保护"></a>0x0A01 基于主机的保护</h2><ul><li>堆栈保护</li><li>应用白名单</li><li>反病毒、过滤、行为分析</li><li>DLP System(信息泄露防护系统)</li></ul><h2 id="0x0A02-应用层保护"><a href="#0x0A02-应用层保护" class="headerlink" title="0x0A02 应用层保护"></a>0x0A02 应用层保护</h2><ul><li>识别应用层保护保护机制</li><li>编码选项</li><li>潜在的绕过途径</li><li>白名单页面</li></ul><h2 id="0x0A03-储存保护"><a href="#0x0A03-储存保护" class="headerlink" title="0x0A03 储存保护"></a>0x0A03 储存保护</h2><ul><li>HBA - Host Level</li><li>LUN Masking</li><li>Storage Controller</li><li>iSCSI CHAP Secret</li></ul><h2 id="0x0A04-用户保护"><a href="#0x0A04-用户保护" class="headerlink" title="0x0A04 用户保护"></a>0x0A04 用户保护</h2><ul><li>反病毒/垃圾邮件过滤软件<ul><li>限制可利用性的软件配置可以被视为反垃圾邮件/反病毒软件</li></ul></li></ul>]]></content>
    
    
    <categories>
      
      <category>渗透测试</category>
      
    </categories>
    
    
    <tags>
      
      <tag>渗透测试</tag>
      
      <tag>标准</tag>
      
      <tag>Google翻译</tag>
      
      <tag>情报搜集</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>一、前期交互</title>
    <link href="/2020/12/29/%E4%B8%80%E3%80%81%E5%89%8D%E6%9C%9F%E4%BA%A4%E4%BA%92/"/>
    <url>/2020/12/29/%E4%B8%80%E3%80%81%E5%89%8D%E6%9C%9F%E4%BA%A4%E4%BA%92/</url>
    
    <content type="html"><![CDATA[<h1 id="前期交互"><a href="#前期交互" class="headerlink" title="前期交互"></a>前期交互</h1><h1 id="0x00-概要"><a href="#0x00-概要" class="headerlink" title="0x00 概要"></a>0x00 概要</h1><p>渗透测试执行标准这一部分的目的是介绍和解释可用的工具和技术，这些工具和技术有助于渗透测试前期交互步骤的成功。本节中的信息是世界上一些最成功的渗透测试人员多年经验总结的结果。</p><p>如果您是寻求渗透测试的客户，我们强烈建议您阅读本文档的“一般问题”部分。它涵盖了在测试开始之前应该回答的主要问题。<strong>请记住，渗透测试不应该是对抗性的。也不应该是一个看看测试人员是否可以“破解”你的活动。</strong>它应该是识别与之相关的业务风险和攻击。</p><p>要获得最大价值，请确保涵盖本文档中的问题。此外，随着范围界定活动的开展，一个优秀的测试公司将开始提出为您的组织量身定制的其他问题。</p><h1 id="0x01-范围简介"><a href="#0x01-范围简介" class="headerlink" title="0x01 范围简介"></a>0x01 范围简介</h1><p>定义范围可以说是渗透测试中最重要的组成部分之一，但它也是最容易被忽视的组成部分之一。虽然已经写了许多关于可用于访问网络的不同工具和技术的书，但在渗透之前的主题：“准备阶段”上写的却很少。忽视正确完成前期交互活动有可能使渗透测试员（或他的公司）面临一些令人头疼的问题，包括范围蔓延，不满意的客户，甚至是法律问题。项目的范围专门定义了要测试的内容。如何进行测试的各个方面将在“规则约定”部分中介绍。</p><p>确定参与范围的一个关键组成部分是概述测试人员应该如何花时间。例如，客户要求以100,000美元的价格测试100个IP地址。这意味着客户每个IP地址提供1000美元的测试。但是，这种成本结构仅在该数量上仍然有效。一些测试人员常见的陷阱是在整个测试过程中保持线性成本。如果客户只要求以相同的定价结构（1,000美元）测试一个业务关键型应用程序，而测试人员仍然只攻击单个IP，则工作量会急剧增加。根据完成的工作改变成本非常重要。否则，公司很容易发现自己的服务收费不足，这促使他们做一份不完整的工作。</p><p>尽管拥有稳固的定价结构，但这个过程并非全是黑白分明。客户完全不知道他们需要测试的是什么并不罕见。客户也可能不知道如何有效地沟通他们对测试的期望。在前期交互阶段，测试人员可以作为客户在未知领域的指导，这一点非常重要。测试人员必须了解专注于具有严重强度(severe intensity)的单个应用程序的测试与客户端提供广泛的IP地址以进行测试的测试之间的区别，从而简单地找到测试方法。</p><h1 id="0x02-时间估计的度量标准"><a href="#0x02-时间估计的度量标准" class="headerlink" title="0x02 时间估计的度量标准"></a>0x02 时间估计的度量标准</h1><p>时间估计与某个领域的测试人员的经验直接相关。如果测试人员在某项测试中具有丰富的经验，他可能天生就能确定测试需要多长时间。如果测试人员在该领域的经验较少，重新阅读以前公司在类似测试中的电子邮件和扫描日志是估计当前参与的时间要求的一个很好的方法。一旦确定测试时间，添加20％的时间是谨慎的做法。</p><p>时间值后端的额外20％称为填充(padding)。在顾问圈之外，这也被称为顾问开销。填充是任何测试的绝对必要条件。如果测试中发生任何中断，它会提供缓冲。通常会发生许多事件并阻碍测试过程。例如，网络段可能会出现故障，或者可能会发现一个重大漏洞，这些都需要与许多级别的管理层进行多次会议才能解决。这两个事件都很耗时，并且如果填充不到位，则会显著影响原始时间估计。</p><p>如果20％的填充最终变得没有必要会发生什么？向客户收取未使用时间的费用将是非常不道德的，因此，如果达到参与时间限制，则由测试人员提供通常无法提供的额外价值。比如包括让公司安全团队走过利用漏洞的步骤，如果它不是原始可交付成果列表的一部分，则提供执行摘要，或者花费一些额外的时间来尝试破解初始测试期间难以捉摸的漏洞。</p><p>时间指标和测试的另一个组成部分是每个项目都需要有一个明确结束日期的最后期限。所有好的项目都有明确的开端和结束。如果您已达到测试结束的具体日期，或者在该日期之后要求您进行任何其他测试或工作，则需要签署一份工作声明，说明工作和所需的工作时间。有些测试人员很难做到这一点，因为他们觉得在成本和工作时间方面他们太痛苦了。然而，作者的经验是，如果您为主要测试提供卓越的价值，客户将不会拒绝为您支付额外的工作费用。</p><h1 id="0x03-范围会议"><a href="#0x03-范围会议" class="headerlink" title="0x03 范围会议"></a>0x03 范围会议</h1><p>在许多情况下，范围会议将在合同签订后进行。确实会发生这样的情况，其中许多与范围相关的主题可以在合同签署之前进行讨论，但它们很少而且难得一见。对于这些情况，建议在进行任何深入的范围界定讨论之前签署保密协议。</p><p>范围界定会议的目标是讨论将要测试的内容。本次会议不涉及参与规则和费用。这些主题中的每一个都应该在会议中处理，每一块都是会议的焦点。这样做是因为如果没有明确说明重点，讨论很容易混淆和混乱。充当主持人并保持讨论主题，防止切线并在必要时宣布更适合离线讨论的某些主题非常重要。</p><p>现在已经为项目建立了粗略的数量级（Rough Order of Magnitude-ROM）值，是时候与客户会面以验证假设。首先，需要明确确定IP范围的参与范围。对于客户来说，抵抗并且假设测试人员识别他们的网络并对其进行攻击是一种特权，以使测试尽可能真实，这种情况并不少见。这确实是一个理想的情况，但是，必须首先考虑可能的法律后果。因此，测试人员有责任向客户传达这些关注点，并向他们传授隐含范围的重要性。例如，在会议中，应验证客户是否拥有所有目标环境，包括：DNS服务器，电子邮件服务器，其Web服务器运行的实际硬件以及防火墙/ IDS / IPS解决方案。有许多公司将这些设备的管理外包给第三方。</p><p>此外，必须确定目标环境所在的国家、省和州。各地区的法律各不相同，测试很可能受到这些法律的影响。例如，众所周知，属于欧盟的国家对个人隐私有非常严格的法律，这可以显著改变执行社会工程参与的方式。</p><h1 id="0x04-基于小时费率的额外支持"><a href="#0x04-基于小时费率的额外支持" class="headerlink" title="0x04 基于小时费率的额外支持"></a>0x04 基于小时费率的额外支持</h1><p>任何未明确包含在约定范围内的事项都应谨慎处理。第一个原因是范围蔓延。随着范围的扩大，资源被消耗掉，为测试人员削减了利润，甚至可能给客户造成困惑和愤怒。还有一个问题，许多测试人员在特别的基础上进行额外的工作时没有想到：法律后果。许多特别请求没有得到适当的记录，因此在发生争议或法律诉讼时很难确定谁说了什么。此外，合同是一份法律文件，规定了要做的工作。它应该与允许测试备忘录紧密联系在一起。</p><p>任何超出原始范围的请求都应以工作说明的形式记录下来，该工作说明清楚地指明了要做的工作。我们还建议在合同中明确规定，额外工作将以每小时固定费用完成，并明确规定，在签署和反签署的工作说明书到位之前，不能完成额外工作。</p><h1 id="0x05-问卷调查"><a href="#0x05-问卷调查" class="headerlink" title="0x05 问卷调查"></a>0x05 问卷调查</h1><p>在与客户的初步沟通过程中，有几个问题需要客户回答，以便能够正确估计服务范围。这些问题旨在更好地了解客户希望从渗透测试中获得什么，客户为什么希望在其环境下进行渗透测试，以及他们是否希望在渗透测试期间执行某些类型的测试。以下是本阶段可能会提出的问题示例。</p><h2 id="0x0500-一般问题"><a href="#0x0500-一般问题" class="headerlink" title="0x0500 一般问题"></a>0x0500 一般问题</h2><h3 id="0x050001-网络渗透测试"><a href="#0x050001-网络渗透测试" class="headerlink" title="0x050001 网络渗透测试"></a>0x050001 网络渗透测试</h3><ol><li><p>为什么客户要对他们的环境进行渗透测试？</p></li><li><p>渗透测试是否需要特定的符合性要求？</p></li><li><p>客户希望什么时候进行渗透测试的活动部分(扫描、枚举、开发等？</p></li></ol><p>  a. 上班时间？</p><p>  b. 下班时间？</p><p>  c. 在周末？</p><ol start="4"><li>总共有多少个IP地址正在测试中？</li></ol><p>  a. 有多少内部IP地址，如果适用的话？</p><p>  b. 如果适用，有多少外部IP地址？</p><ol start="5"><li><p>是否有任何设备可能影响渗透测试的结果，如防火墙、入侵检测/防御系统、Web应用程序防火墙或负载均衡器？</p></li><li><p>如果系统被渗透，测试团队应该如何进行？</p></li></ol><p>  a. 对受损机器进行本地漏洞评估？</p><p>  b. 尝试获得最高权限（Unix计算机上的根用户、Windows上的系统或管理员机器）在受损机器上？</p><p>  c. 对获得的本地密码散列执行无、最小、字典或详尽的密码攻击(例如，Unix机器上的/etc/shadow)？</p><h3 id="0x050002-Web应用程序渗透测试"><a href="#0x050002-Web应用程序渗透测试" class="headerlink" title="0x050002 Web应用程序渗透测试"></a>0x050002 Web应用程序渗透测试</h3><ol><li><p>有多少web应用程序正在被评估?</p></li><li><p>正在评估多少登录系统?</p></li><li><p>要评估多少静态页面?(近似)</p></li><li><p>要评估多少动态页面?(近似)</p></li><li><p>源代码是否容易获得?</p></li><li><p>会有任何类型的文件吗?</p><p>a. 如果是，需要哪些文件?</p></li><li><p>将对该应用程序执行静态分析吗？</p></li><li><p>客户端是否希望针对此应用程序执行模糊处理？</p></li><li><p>客户端是否希望针对此应用程序执行基于角色的测试？</p></li><li><p>客户端是否需要对Web应用程序进行凭据扫描？</p></li></ol><h3 id="0x050003-无线网络渗透测试"><a href="#0x050003-无线网络渗透测试" class="headerlink" title="0x050003 无线网络渗透测试"></a>0x050003 无线网络渗透测试</h3><ol><li>有多少无线网络？</li><li>是否使用客人无线网络？ 如果是：<ol><li>客网是否需要认证？</li><li>在无线网络上使用什么类型的加密？</li><li>覆盖的面积是多少？</li><li>是否需要列举流氓设备？</li><li>团队会评估针对客户的无线攻击吗？</li><li>大约有多少客户将使用无线网络？</li></ol></li></ol><h3 id="0x050004-物理渗透测试"><a href="#0x050004-物理渗透测试" class="headerlink" title="0x050004 物理渗透测试"></a>0x050004 物理渗透测试</h3><ol><li> 正在评估多少个地点？</li><li>这个物理位置是共享设施吗？ 如果是：<ol><li> 有多少层在范围内？</li><li> 哪些楼层在范围内？</li></ol></li><li>是否有任何保安需要绕过？ 如果是：<ol><li> 保安人员是通过第三方雇用的吗？</li><li> 他们有武器吗？</li><li> 他们允许使用武力吗？</li></ol></li><li> 有多少个入口进入大楼？</li><li> 是否允许使用锁镐或凸键？ （也考虑当地法律）</li><li> 本测试的目的是验证是否符合现有政策和程序，还是进行审计？</li><li> 范围内的面积是多少？</li><li> 所有的物理安全措施都有记录吗？</li><li>摄像机被使用了吗？<ol><li>摄像机是客户所有的吗？ 如果是：<ol><li> 团队是否应该尝试访问存储摄像机数据的位置？</li></ol></li></ol></li><li>是否正在使用武装警报系统？ 如果是：<ol><li> 警报是无声警报吗？</li><li> 警报是由运动触发的吗？</li><li> 报警是否由打开门窗触发？</li></ol></li></ol><h3 id="0x050005-社会工程学"><a href="#0x050005-社会工程学" class="headerlink" title="0x050005 社会工程学"></a>0x050005 社会工程学</h3><ol><li>客户是否有一个电子邮件地址列表，他们希望对社会工程攻击进行攻击？</li><li>客户是否有一个电话号码列表，他们希望对社会工程进行攻击？</li><li>社会工程是否为获得未经授权的物理访问而批准？ 如果是：</li></ol><p>  a. 会有多少人成为目标？</p><p>应该指出，作为不同测试级别的一部分，可能不需要向业务单元经理、系统管理员和服务台人员提出问题。 然而，在这种情况下，有些问题是必要的，一些样本问题可以在下面找到。</p><h2 id="0x0501-业务部门经理的问题"><a href="#0x0501-业务部门经理的问题" class="headerlink" title="0x0501 业务部门经理的问题"></a>0x0501 业务部门经理的问题</h2><ol><li> 经理是否知道将要执行测试？</li><li> 如果暴露、损坏或删除，对组织造成最大风险的主要基准是什么？</li><li> 是否有测试和验证程序来验证业务应用程序是否正常运行？</li><li> 测试人员是否可以从应用程序首次开发时起访问质量保证测试程序？</li><li> 应用程序数据是否有灾后恢复程序？</li></ol><h2 id="0x0502-系统管理员的问题"><a href="#0x0502-系统管理员的问题" class="headerlink" title="0x0502 系统管理员的问题"></a>0x0502 系统管理员的问题</h2><ol><li> 是否有任何系统可以被描述为脆弱的？ （有崩溃倾向的系统，较旧的操作系统，或未修补的系统）</li><li> 网络上是否有客户端不拥有的系统，可能需要额外的批准才能测试？</li><li> 变更管理程序是否到位？</li><li> 修复系统中断的平均时间是多少？</li><li> 是否有系统监控软件到位？</li><li> 最关键的服务器和应用程序是什么？</li><li> 备份是否定期测试？</li><li> 上次恢复备份是什么时候？</li></ol><h1 id="0x06-范围蠕变"><a href="#0x06-范围蠕变" class="headerlink" title="0x06 范围蠕变"></a>0x06 范围蠕变</h1><p> 范围蠕变是使渗透测试公司退出业务的最有效的方法之一。 问题是，许多公司和经理几乎不知道如何识别它，或者如何重新定位  当它发生的时候。</p><p>在对抗范围蔓延时需要记住几件事。首先，如果客户对特定约定的工作感到满意，那么他们通常会请求额外的工作。把这看作是一种恭维，请毫不犹豫地要求提供额外资金，以补偿所花费的额外时间。如果客户拒绝支付额外的工作，几乎就不值得留下来做那些工作。</p><p>第二点更为关键。与现有客户打交道时，要注意保持较低的价格。利用有利条件哄抬价格，肯定能赶走回头客。考虑到可以降低价格，因为公司避免了获得客户的成本，如正式的RFP过程和寻找客户本身。此外，未来工作的最佳来源是通过现有的客户。善待他们，他们就会回来。</p><h1 id="0x07-指定开始日期和结束日期"><a href="#0x07-指定开始日期和结束日期" class="headerlink" title="0x07 指定开始日期和结束日期"></a>0x07 指定开始日期和结束日期</h1><p> 另一个阻止范围蔓延的关键因素是明确地说明开始和结束日期。这使得项目有明确的结局。范围渐变最常见的地方之一是在重新测试期间。在签订合同时，重新测试听起来总是一个好主意。这表明该公司是关心和勤奋的，努力确保客户是安全的。当人们忘记了工作在完成之前是没有报酬的时候，问题就开始了。这包括重新测试。</p><p> 为了减少这种风险，在合同中添加一个简单的声明，其中提到所有重新测试必须在最终报告交付后的一定时间内完成。 然后它就变成了责任  测试人员带头进行重新测试工作。 如果客户请求延期，始终允许这样做，条件是在最初指定的日期完成付款。 最后，  最重要的是，进行质量重测。 记住，未来工作的最佳来源是你现有的客户群。</p><h1 id="0x08-指定IP范围和域"><a href="#0x08-指定IP范围和域" class="headerlink" title="0x08 指定IP范围和域"></a>0x08 指定IP范围和域</h1><p>在开始渗透测试之前，必须确定所有目标。这些目标应该在最初的问卷调查阶段从顾客那里获得。目标可以由客户以特定IP地址、网络范围或域名的形式给出。在某些情况下，客户提供的唯一目标是组织的名称，并期望测试人员能够自己识别其余的部分。重要的是要定义在测试者和最终目标之间的系统，如防火墙、IDS/IPS或网络设备，是否也是范围的一部分。无论上游供应商和其他第三方供应商是否在范围内，都应该标识和定义其他元素。</p><h2 id="0x0800-验证范围"><a href="#0x0800-验证范围" class="headerlink" title="0x0800 验证范围"></a>0x0800 验证范围</h2><p><strong>至关重要的是，在开始攻击目标之前，必须验证目标实际上是您要执行测试的客户所拥有</strong>。 想一想，如果您开始攻击一台机器并成功侵入它，这可能会导致法律后果，只是后来才发现该机器实际上属于另一个组织（例如医院或政府机构）。</p><h1 id="0x09-与第三方打交道"><a href="#0x09-与第三方打交道" class="headerlink" title="0x09 与第三方打交道"></a>0x09 与第三方打交道</h1><p>在许多情况下，参与将包括测试由第三方托管的服务或应用程序。 近年来，随着云服务变得越来越流行，这种情况变得越来越普遍。 <strong>要记住的最重要的一点是，尽管客户可能已经授予了许可，但他们并不代表第三方提供商。</strong> 因此，还必须从他们那里获得许可才能测试托管系统。 与往常一样，未能获得适当的许可会带来违反法律的可能性，这可能会引起无休止的头痛。</p><h2 id="0x0900-云服务（Cloud-Services）"><a href="#0x0900-云服务（Cloud-Services）" class="headerlink" title="0x0900 云服务（Cloud Services）"></a>0x0900 云服务（Cloud Services）</h2><p>测试云服务的最大问题是，来自多个不同组织的数据存储在一个物理介质上。 通常，这些不同数据域之间的安全性非常宽松。 云服务提供商需要收到有关测试的警报，并且需要确认测试正在进行中，并授予测试组织进行测试的权限。 此外，在发现可能影响其他云客户的安全漏洞的情况下，需要在云服务提供商内部建立直接的安全联系以进行联系。 一些云提供商有针对渗透测试人员的特定程序，在开始测试之前，可能需要他们的请求表，时间表或明确的许可。</p><h2 id="0x0901-网络服务提供商（ISP）"><a href="#0x0901-网络服务提供商（ISP）" class="headerlink" title="0x0901 网络服务提供商（ISP）"></a>0x0901 网络服务提供商（ISP）</h2><p>与客户确认ISP服务条款。 在许多商业情况下，ISP将有特定的测试规定。 发起攻击之前，请仔细阅读这些条款。 在某些情况下，ISP会回避并阻止某些被认为是恶意的流量。 客户可以批准此风险，但是在开始之前必须始终明确告知它。 网络托管与所有其他第三方一样，测试的范围和时间必须与网络托管提供商明确沟通。 另外，与客户沟通时，请确保清楚说明测试仅是在搜索网络漏洞时进行的。 该测试不会发现底层基础结构中的漏洞，这些漏洞仍可能提供危害应用程序的途径。</p><h2 id="0x0902-托管安全服务提供商（MSSPs）"><a href="#0x0902-托管安全服务提供商（MSSPs）" class="headerlink" title="0x0902 托管安全服务提供商（MSSPs）"></a>0x0902 托管安全服务提供商（MSSPs）</h2><p>托管安全服务提供商也可能需要通知测试。 具体来说，在测试其拥有的系统和服务时将需要通知他们。 但是，在某些情况下不会通知MSSP。 如果确定MSSP的实际响应时间是测试的一部分，则通知MSSP当然不符合测试完整性的最大利益。 根据一般经验，每当测试MSSP明确拥有的设备或服务时，都需要通知它们。</p><h2 id="0x0903-服务器所在国家（Countries-Where-Servers-are-Hosted）"><a href="#0x0903-服务器所在国家（Countries-Where-Servers-are-Hosted）" class="headerlink" title="0x0903 服务器所在国家（Countries Where Servers are Hosted）"></a>0x0903 服务器所在国家（Countries Where Servers are Hosted）</h2><p>检验服务器所在的国家/地区也符合测试人员的最大利益。 验证国家/地区之后，请在开始测试之前查看特定国家/地区的法律。 不应假定公司的法律团队会为测试人员提供完整的当地法律摘要。 也不应假定该公司应对测试人员违反的任何法律承担法律责任。 在开始测试之前，每个测试人员都有责任验证其测试所在地区的法律，因为最终将由测试人员来应对任何违法行为。</p><h1 id="0x0A-定义可接受的社会工程托词"><a href="#0x0A-定义可接受的社会工程托词" class="headerlink" title="0x0A 定义可接受的社会工程托词"></a>0x0A 定义可接受的社会工程托词</h1><p>许多组织将希望以与当前攻击一致的方式测试其安全状态。 当今，许多攻击者广泛使用社会工程学和鱼叉式网络钓鱼攻击。 尽管大多数成功的攻击使用诸如性，毒品和摇滚乐（分别是色情，伟哥和免费iPod）之类的借口，但其中某些借口在公司环境中可能是不可接受的。 在开始测试之前，请确保以书面形式批准为测试选择的所有借口。</p><h1 id="0x0B-DoS测试"><a href="#0x0B-DoS测试" class="headerlink" title="0x0B DoS测试"></a>0x0B DoS测试</h1><p>在开始参与之前，应讨论压力测试或拒绝服务测试。由于测试的潜在破坏性质，这可能是许多组织不满意的话题。如果组织仅担心其数据的机密性或完整性，则可能不需要进行压力测试。但是，如果组织还担心其服务的可用性，则应在与生产环境相同的非生产环境中进行压力测试</p><h1 id="0x0C-付款条件"><a href="#0x0C-付款条件" class="headerlink" title="0x0C 付款条件"></a>0x0C 付款条件</h1><p>许多测试人员完全忘记的为测试做准备的另一方面是应如何付款。就像合同日期一样，应该有特定的付款日期和条件。大型组织尽可能延迟付款的情况并不罕见。以下是几种常见的付款方式。这些仅仅是示例。绝对建议每个组织创建和调整自己的定价结构，以更恰当地满足其客户和他们自己的需求。重要的是在测试开始之前一定要有某种结构。</p><h2 id="0x0C00-Net-30"><a href="#0x0C00-Net-30" class="headerlink" title="0x0C00 Net 30"></a>0x0C00 Net 30</h2><p>总金额应在提交最终报告后的30天内支付。这通常与每月不付款的百分比罚款有关。这可以是您希望授予客户的任何天数（即45或60）。</p><h2 id="0x0C01-预支付一半（Half-Upfront）"><a href="#0x0C01-预支付一半（Half-Upfront）" class="headerlink" title="0x0C01 预支付一半（Half Upfront）"></a>0x0C01 预支付一半（Half Upfront）</h2><p>在测试开始之前，要求先支付总账单的一半并不罕见。对于长期参与，这是很常见的。</p><h2 id="0x0C02-定期分期付款（Recurring）"><a href="#0x0C02-定期分期付款（Recurring）" class="headerlink" title="0x0C02 定期分期付款（Recurring）"></a>0x0C02 定期分期付款（Recurring）</h2><p>定期付款时间表通常用于长期参与。例如，某些活动可能长达一两年。让客户全年定期分期付款并不罕见。</p><h1 id="0x0D-目标（Goals）"><a href="#0x0D-目标（Goals）" class="headerlink" title="0x0D 目标（Goals）"></a>0x0D 目标（Goals）</h1><p>每个渗透测试都应以目标为导向。这就是说，测试的目的是确定导致损害客户业务或任务目标的特定漏洞。这与查找未修补的系统无关。这是关于确定将对组织产生不利影响的风险。</p><h2 id="0x0D00-主要目标（Primary）"><a href="#0x0D00-主要目标（Primary）" class="headerlink" title="0x0D00 主要目标（Primary）"></a>0x0D00 主要目标（Primary）</h2><p>测试的主要目标不应由合规性驱动。这种推理有许多不同的理由。首先，合规性不等于安全性。应该理解，许多组织由于合规性而接受测试，但这不应成为测试的主要目标。例如，作为PCI-DSS要求的一部分，可以雇用一家公司完成渗透测试。</p><p>不乏处理信用卡信息的公司。但是，如果目标组织被折衷，则会使目标组织在竞争激烈的市场中具有独特性和生存能力的特征将产生最大的影响。信用卡系统遭到入侵无疑将是一个严重的问题，但是信用卡号码以及所有相关的客户数据被泄漏将是灾难性的。</p><h2 id="0x0D01-次要目标（Secondary）"><a href="#0x0D01-次要目标（Secondary）" class="headerlink" title="0x0D01 次要目标（Secondary）"></a>0x0D01 次要目标（Secondary）</h2><p>次要目标与合规性直接相关。首要目标和次要目标密切相关并不少见。例如，在PCI-DSS驱动测试的示例中，获得信用卡是次要目标。将数据泄露与组织的业务或任务推动者联系在一起是主要目标。次要目标意味着合规性和/或IT。主要目标引起高层管理人员的注意。</p><h2 id="0x0D03-业务分析（Business-Analysis）"><a href="#0x0D03-业务分析（Business-Analysis）" class="headerlink" title="0x0D03 业务分析（Business Analysis）"></a>0x0D03 业务分析（Business Analysis）</h2><p>在执行渗透测试之前，确定客户安全状况的成熟度级别是有益的。有许多组织选择直接进入渗透测试，首先评估该成熟度。对于拥有非常不完善的安全程序的客户，通常最好先执行漏洞分析。</p><p>一些测试人员认为，漏洞分析（VA）工作存在污名。这些测试人员忘记了目标是确定目标组织中的风险，而不是追求所谓的“摇滚明星”生活方式。如果一家公司还没有准备好进行全面的渗透测试，那么从良好的VA中获得的价值将比渗透测试要多得多。</p><p>事先与客户建立有关他们将提供的系统的哪些信息。询问有关已记录的漏洞的信息也可能会有所帮助。通过不将测试发现与已知问题重叠，这将节省测试人员的时间并节省客户资金。同样，如果合规性并非绝对要求，则完全或部分白盒测试可能比黑盒测试为客户带来更多价值。</p><h1 id="0x0E-建立沟通渠道"><a href="#0x0E-建立沟通渠道" class="headerlink" title="0x0E 建立沟通渠道"></a>0x0E 建立沟通渠道</h1><p>任何渗透测试最重要的方面之一就是与客户的沟通。您与客户互动的频率以及与客户打交道的方式可以极大地改善客户的满意度。下面是一个交流框架，有助于使客户对测试活动感到满意。</p><h2 id="0x0E00-紧急联系信息"><a href="#0x0E00-紧急联系信息" class="headerlink" title="0x0E00 紧急联系信息"></a>0x0E00 紧急联系信息</h2><p>显然，在紧急情况下与客户或目标组织保持联系至关重要。可能会出现紧急情况，必须建立联系点以进行处理。创建紧急联系人列表。此列表应包括测试范围内所有各方的联系信息。创建后，紧急联系人列表应与列表中的所有联系人共享。请记住，目标组织可能不是客户。</p><p>收集有关每个紧急联系人的以下信息：</p><ol><li>全名</li><li>职称和运营责任</li><li>授权讨论测试活动的详细信息（如果尚未指定）</li><li>可能的两种24/7全天候联系方式，例如手机，寻呼机或家庭电话</li><li>一种安全的批量数据传输形式，例如SFTP或加密的电子邮件</li></ol><p>注意：诸如服务台或操作中心之类的组的号码可以代替一个紧急联系人，但前提是必须配备24/7的工作人员。每次渗透测试的性质都会影响应该在紧急联系人列表中的人员。不仅需要提供客户和目标的联系信息，而且在紧急情况下他们可能还需要联系测试人员。该列表最好应包括以下人员：</p><ol><li>参与测试的所有渗透测试人员</li><li>测试小组的经理</li><li>每个目标组织有两个技术联系人</li><li>客户的两个技术联系</li><li>与客户的一位高层管理人员或业务联系人</li></ol><p>上面的列表中可能会有些重叠。例如，目标组织可能是客户，测试小组的经理也可能正在执行渗透测试，或者客户的技术联系人可能在高层管理人员中。还建议每个参与方指定一个联系人，由其领导并代表该联系人负责。</p><h2 id="0x0E01-事件报告流程（Incident-Reporting-Process）"><a href="#0x0E01-事件报告流程（Incident-Reporting-Process）" class="headerlink" title="0x0E01 事件报告流程（Incident Reporting Process）"></a>0x0E01 事件报告流程（Incident Reporting Process）</h2><p>在参与之前，讨论组织当前的事件响应能力非常重要，这有几个原因。渗透测试的一部分不仅要测试组织已具备的安全性，还要测试其事件响应能力。</p><p>如果在目标的内部安全团队从未注意到的情况下可以完成整个交战，则表明安全态势存在重大差距。同样重要的是要确保在测试开始之前，目标组织中的某人知道何时进行测试，以便事件响应团队不会在半夜开始致电高层管理人员的每一个成员，因为他们认为受到攻击或妥协。</p><h2 id="0x0E02-事件定义（Incident-Definition）"><a href="#0x0E02-事件定义（Incident-Definition）" class="headerlink" title="0x0E02 事件定义（Incident Definition）"></a>0x0E02 事件定义（Incident Definition）</h2><p>美国国家标准技术研究院（NIST）对事件的定义如下：“违反或迫在眉睫的违反计算机安全策略，可接受的使用策略或标准安全惯例的行为。” （计算机安全事件处理指南-特殊出版物800-61 Rev 1）。事故也可能发生在物理层面上，其中人可以通过任何方式未经授权地物理访问该区域。目标组织对于不同类型的事件应具有不同的类别和级别。</p><h2 id="0x0E03-状态报告频率（Status-Report-Frequency）"><a href="#0x0E03-状态报告频率（Status-Report-Frequency）" class="headerlink" title="0x0E03 状态报告频率（Status Report Frequency）"></a>0x0E03 状态报告频率（Status Report Frequency）</h2><p>状态报告的频率差异很大。影响报告进度的一些因素包括测试的总时间，测试范围和目标的安全成熟度。有效的时间表可以使客户感到参与。被忽略的客户是前客户。</p><p>设置状态报告的频率和时间表后，就必须兑现。推迟或延迟状态报告可能是必要的，但不应成为长期报告。如有必要，可能会要求客户同意新的时间表。完全跳过状态报告是不专业的，应尽可能避免。</p><h2 id="0x0E04-PGP和其他替代品（PGP-and-Other-Alternatives）"><a href="#0x0E04-PGP和其他替代品（PGP-and-Other-Alternatives）" class="headerlink" title="0x0E04 PGP和其他替代品（PGP and Other Alternatives）"></a>0x0E04 PGP和其他替代品（PGP and Other Alternatives）</h2><p>加密不是可选的。与客户的沟通是任何渗透测试项目中必不可少的部分，由于该项目的敏感性，必须对敏感信息的通信进行加密，尤其是最终报告。在测试开始之前，必须与客户端建立一种安全的通信方式。几种常见的加密方法如下：</p><ol><li>PGP / GPG既可以用于通过电子邮件进行通信，也可以用于加密最终报告（请记住主题行以明文形式通过）</li><li>客户网络上托管的安全邮箱</li><li>电话</li><li>面对面会议</li><li>要提供最终报告，您还可以将报告存储在AES加密的存档文件中，但是请确保您的存档实用程序支持使用CBC进行AES加密。</li></ol><p>还要问哪些信息可以用书面形式写出，哪些应该仅以口头形式传达。一些组织有很好的理由来限制以书面形式向其发送哪些安全信息。</p><h1 id="0x0F-参与规则（Rules-of-Engagement）"><a href="#0x0F-参与规则（Rules-of-Engagement）" class="headerlink" title="0x0F 参与规则（Rules of Engagement）"></a>0x0F 参与规则（Rules of Engagement）</h1><p>范围定义了将要测试的内容，而参与规则则定义了如何进行测试。这是两个不同方面，需要彼此独立处理。</p><h2 id="0x0F00-时间线（Timeline）"><a href="#0x0F00-时间线（Timeline）" class="headerlink" title="0x0F00 时间线（Timeline）"></a>0x0F00 时间线（Timeline）</h2><p>应该为参与制定明确的时间表。范围定义了参与的开始和结束，而参与规则则定义了参与之间的一切。应该理解的是，时间表会随着测试的进行而改变。但是，制定严格的时间表并不是创建时间表的目标。相反，在测试开始时制定时间表将使每个参与人员都能更清楚地确定要完成的工作以及负责该工作的人员。 GANTT图表和工作分解结构通常用于定义工作以及每个特定工作所需的时间。查看以这种方式分解的时间表可以帮助那些参与人员确定需要在何处应用资源，还可以帮助客户确定在测试过程中可能遇到的障碍。</p><p>互联网上有许多免费的GANTT Chart工具。许多管理人员与这些工具密切相关。因此，它们是与目标组织的高层管理人员进行沟通的极佳媒介。</p><h2 id="0x0F01-地点（Locations）"><a href="#0x0F01-地点（Locations）" class="headerlink" title="0x0F01 地点（Locations）"></a>0x0F01 地点（Locations）</h2><p>任何给定参与度的重要参数是提前与客户建立联系，这是测试人员在测试期间需要前往的任何目的地。这可能与识别本地酒店一样简单，也可能与识别特定目标国家/地区的适用法律一样复杂。</p><p>一个组织在多个位置和地区开展业务并不罕见，并且需要选择一些选定的站点进行测试。在这种情况下，应避免前往每个客户位置，而是应确定到站点的VPN连接是否可用于远程测试。敏感信息的披露。</p><p>虽然给定参与的目标之一可能是获得对敏感信息的访问权，但实际上不应查看或下载某些信息。对于较新的测试人员来说，这似乎很奇怪，但是，在许多情况下，测试人员不应该拥有目标数据。例如，根据《健康保险可移植性和责任法案》（HIPAA）的个人健康信息（PHI），此数据必须受到保护。在某些情况下，目标系统可能没有保护它的防火墙或防病毒（AV）。在这种情况下，应绝对避免测试人员拥有任何和所有个人身份信息（PII）。</p><p>但是，如果无法通过物理或虚拟方式获取数据，那么如何证明测试人员确实可以访问信息呢？该问题已经以多种方式解决。有很多方法可以证明金库门是打开的而没有花任何钱。例如，只要在文件名中看不到PII，就可以截取数据库模式和文件权限的屏幕快照，或者可以显示文件本身而无需打开文件来显示内容。</p><p>测试人员在给定的约定上应有多谨慎，这是一个需要与客户讨论的参数，但是进行测试的公司应始终确保从法律角度保护自己，无论客户意见如何。无论假定暴露于敏感数据如何，每次参与之后，都应充分擦洗所有报告模板和测试仪机器。作为特别说明，如果测试人员发现了非法数据（例如儿童色情内容），则应立即通知适当的执法人员，然后通知客户。不要听从客户的指示。</p><h2 id="0x0F02-证据处理（Evidence-Handling）"><a href="#0x0F02-证据处理（Evidence-Handling）" class="headerlink" title="0x0F02 证据处理（Evidence Handling）"></a>0x0F02 证据处理（Evidence Handling）</h2><p>在处理测试证据和报告的不同阶段时，极其小心地对待数据非常重要。在每次测试之间，请始终使用加密并清理测试计算机。切勿在安全会议上分发带有测试报告的USB记忆棒。无论您做什么，都不要将其他客户参与的报告用作模板！在文档中保留对另一个组织的引用是非常不专业的。</p><h2 id="0x0F03-定期会议（Regular-Status-Meetings）"><a href="#0x0F03-定期会议（Regular-Status-Meetings）" class="headerlink" title="0x0F03 定期会议（Regular Status Meetings）"></a>0x0F03 定期会议（Regular Status Meetings）</h2><p>在整个测试过程中，与客户定期开会以告知他们测试的总体进度至关重要。这些会议应每天举行，并且应尽可能短。会议应遵循三个概念：计划，进度和问题。</p><p>通常讨论计划，以便在重大计划外变更或中断期间不进行测试。进展只是对客户的最新更新。在本次会议上也应该讨论问题，但是为了简洁起见，有关解决方案的对话几乎应该总是脱机进行。</p><h2 id="0x0F04-一天中的测试时间（Time-of-the-Day-to-Test）"><a href="#0x0F04-一天中的测试时间（Time-of-the-Day-to-Test）" class="headerlink" title="0x0F04 一天中的测试时间（Time of the Day to Test）"></a>0x0F04 一天中的测试时间（Time of the Day to Test）</h2><p>某些客户要求在工作时间以外进行所有测试。对于大多数测试人员而言，这可能意味着深夜。在开始测试之前，应与客户充分确定一天中的时间要求。</p><h2 id="0x0F05-回避处理（Dealing-with-Shunning）"><a href="#0x0F05-回避处理（Dealing-with-Shunning）" class="headerlink" title="0x0F05 回避处理（Dealing with Shunning）"></a>0x0F05 回避处理（Dealing with Shunning）</h2><p>有时回避是完全可以接受的，有时也可能不符合测试的精神。例如，如果您要进行全面的黑盒测试，则不仅要测试技术，还要测试目标组织的安全团队的功能，那么回避就可以了。但是，当您与目标组织的安全团队协作测试大量系统时，避开攻击可能并不符合测试的最大利益。</p><h2 id="0x0F06-测试授权（Permission-to-Test）"><a href="#0x0F06-测试授权（Permission-to-Test）" class="headerlink" title="0x0F06 测试授权（Permission to Test）"></a>0x0F06 测试授权（Permission to Test）</h2><p>渗透测试需要获得的最重要的文件之一是“测试许可”文件。本文档说明了范围，并包含一个签名，该签名确认了对测试人员活动的认识。此外，应明确指出测试可能导致系统不稳定，并且测试人员将采取一切适当的措施，以免使系统在此过程中崩溃。但是，由于测试可能导致不稳定，因此客户不应对测试仪对任何系统不稳定或崩溃负责。在客户签署本文档之前，不要开始测试是至关重要的。</p><p>另外，某些服务提供商在测试其系统之前需要事先通知和/或单独的许可。例如，亚马逊有一个必须填写的在线请求表，在扫描云上的任何主机之前，必须先批准该请求。如果需要，它应该是文档的一部分。</p><h2 id="0x0F07-法律考虑因素（Legal-Considerations）"><a href="#0x0F07-法律考虑因素（Legal-Considerations）" class="headerlink" title="0x0F07 法律考虑因素（Legal Considerations）"></a>0x0F07 法律考虑因素（Legal Considerations）</h2><p>渗透测试中常见的某些活动可能违反当地法律。因此，建议在要执行工作的位置检查常见的渗透测试任务的合法性。例如，在渗透测试过程中捕获的任何VOIP呼叫都可能在某些区域被视为窃听。</p><h1 id="0x10-到位的能力和技术"><a href="#0x10-到位的能力和技术" class="headerlink" title="0x10 到位的能力和技术"></a>0x10 到位的能力和技术</h1><p>良好的渗透测试不仅仅是检查未修补的系统。他们还测试目标组织的功能。为此，下面列出了您可以在测试时进行基准测试的事项：</p><p>  a. 能够检测和响应信息收集</p><p>  b. 能够检测并响应足印</p><p>  c. 能够检测并响应扫描和漏洞分析</p><p>  d. 能够检测并响应渗透（攻击）</p><p>  e. 能够检测和响应数据聚合</p><p>  f. 能够检测并响应数据过滤</p><p>在跟踪此信息时，请务必收集时间信息。例如，如果检测到扫描，则应通知您，并记下您当时正在执行的扫描级别。</p>]]></content>
    
    
    <categories>
      
      <category>渗透测试</category>
      
    </categories>
    
    
    <tags>
      
      <tag>渗透测试</tag>
      
      <tag>标准</tag>
      
      <tag>Google翻译</tag>
      
      <tag>前期交互</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>零-渗透测试执行标准</title>
    <link href="/2020/12/29/%E9%9B%B6-%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E6%89%A7%E8%A1%8C%E6%A0%87%E5%87%86/"/>
    <url>/2020/12/29/%E9%9B%B6-%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E6%89%A7%E8%A1%8C%E6%A0%87%E5%87%86/</url>
    
    <content type="html"><![CDATA[<h1 id="渗透测试执行标准"><a href="#渗透测试执行标准" class="headerlink" title="渗透测试执行标准"></a>渗透测试执行标准</h1><h2 id="标准的组织结构"><a href="#标准的组织结构" class="headerlink" title="标准的组织结构"></a>标准的组织结构</h2><p>渗透测试执行标准由7个主要部分组成。这些内容涵盖了与渗透测试相关的所有内容：从最初的沟通和背后的推理，到测试人员在幕后工作的情报收集和威胁建模阶段，以便测试人员的安全技术专业知识发挥作用，并与对业务的理解相结合，通过漏洞研究、利用和后期利用更好地了解被测组织，最后以一种对客户有意义的方式捕获整个过程并提供最有价值的报告。</p><p>这个版本可以被认为是v1.0，因为该标准的核心要素已经固化，并且已经通过行业进行了一年多的实际测试。 v2.0很快就会投入使用，它将提供更多关于“级别”的细粒度工作 ——就像在强度等级中可以执行渗透测试的每个元素一样。由于每个渗透测试都是不一样的，并且测试将包含从更普通的Web应用程序或网络测试，到全面的红队参与，所述级别将使组织能够定义他们期望他们的对手展示多少复杂性，并启用测试人员加强组织最需要的领域的强度。关于“级别”的一些初步工作可以在情报收集部分看到。</p><p>作为渗透测试执行的基础，以下是标准定义的主要部分：</p><ul><li><a href="http://www.metatron.top/2020/12/29/%E4%B8%80%E3%80%81%E5%89%8D%E6%9C%9F%E4%BA%A4%E4%BA%92/">前期交互</a></li><li><a href="http://www.metatron.top/2020/12/29/%E4%BA%8C%E3%80%81%E6%83%85%E6%8A%A5%E6%90%9C%E9%9B%86/">情报搜集</a></li><li><a href="http://www.metatron.top/2020/12/29/%E4%B8%89%E3%80%81%E5%A8%81%E8%83%81%E5%BB%BA%E6%A8%A1/">威胁建模</a></li><li><a href="http://www.metatron.top/2020/12/29/%E5%9B%9B%E3%80%81%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/">漏洞分析</a></li><li><a href="http://www.metatron.top/2020/12/29/%E4%BA%94%E3%80%81%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/">漏洞利用</a></li><li><a href="http://www.metatron.top/2020/12/29/%E5%85%AD%E3%80%81%E5%90%8E%E5%88%A9%E7%94%A8/">后利用</a></li><li><a href="http://www.metatron.top/2020/12/29/%E4%B8%83%E3%80%81%E6%8A%A5%E5%91%8A%E8%BE%93%E5%87%BA/">报告输出</a></li></ul><p>由于标准没有在如何执行实际的测试中提供任何技术指导，我们还创建了一个技术指南，以配合标准本身。可以通过以下链接访问技术指南：</p><ul><li><a href="http://www.pentest-standard.org/index.php/PTES_Technical_Guidelines">技术指南</a></li></ul><p>有关此标准的更多信息，请访问：</p><ul><li><a href="http://www.pentest-standard.org/index.php/FAQ">渗透测试执行标准：常见问题解答</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>渗透测试</category>
      
    </categories>
    
    
    <tags>
      
      <tag>渗透测试</tag>
      
      <tag>标准</tag>
      
      <tag>Google翻译</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Windows常用命令</title>
    <link href="/2020/12/03/Windows%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/"/>
    <url>/2020/12/03/Windows%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/</url>
    
    <content type="html"><![CDATA[<h1 id="一、操作系统相关"><a href="#一、操作系统相关" class="headerlink" title="一、操作系统相关"></a>一、操作系统相关</h1><h2 id="0x0000-systeminfo"><a href="#0x0000-systeminfo" class="headerlink" title="0x0000 systeminfo"></a>0x0000 systeminfo</h2><h3 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h3><p>该工具显示本地或远程机器(包括服务包级别)的操作系统配置的信息。一般用于查看当前计算机的详细信息，如：主机名、OS版本、系统启动时间和<strong>修补程序</strong>（补丁）等等。</p><h3 id="使用帮助"><a href="#使用帮助" class="headerlink" title="使用帮助"></a>使用帮助</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-built_in">PS</span> C:\Users\Security&gt; systeminfo /?<br>SYSTEMINFO [/<span class="hljs-type">S</span> <span class="hljs-type">system</span> [/<span class="hljs-type">U</span> <span class="hljs-type">username</span> [/<span class="hljs-type">P</span> [<span class="hljs-type">password</span>]]]] [/<span class="hljs-type">FO</span> <span class="hljs-type">format</span>] [/<span class="hljs-type">NH</span>]<br>描述:<br>    该工具显示本地或远程机器(包括服务包级别)的操作系统配置的信息。<br>参数列表:<br>    /S      system           指定要连接的远程系统。<br>    /U      [<span class="hljs-type">domain</span>\]user    指定应该在哪个用户上下文执行命令。<br>    /P      [<span class="hljs-type">password</span>]       指定给定用户上下文的密码。如果省略则<br>                             提示输入。<br>    /FO     format           指定显示结果的格式。<br>                             有效值: <span class="hljs-string">&quot;TABLE&quot;</span>、<span class="hljs-string">&quot;LIST&quot;</span>、<span class="hljs-string">&quot;CSV&quot;</span>。<br>    /NH                      指定“列标题”不应该在输出中显示。<br>                             只对 <span class="hljs-string">&quot;TABLE&quot;</span> 和 <span class="hljs-string">&quot;CSV&quot;</span> 格式有效。<br>    /?                       显示帮助消息。<br></code></pre></td></tr></table></figure><h3 id="使用示例"><a href="#使用示例" class="headerlink" title="使用示例"></a>使用示例</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs powershell">C:\Users\Security&gt;systeminfo<br><br>主机名:           DZH<br>OS 名称:          Microsoft Windows <span class="hljs-number">10</span> 企业版<br>OS 版本:          <span class="hljs-number">10.0</span>.<span class="hljs-number">19042</span> 暂缺 Build <span class="hljs-number">19042</span><br>OS 制造商:        Microsoft Corporation<br>OS 配置:          独立工作站<br>OS 构建类型:      Multiprocessor Free<br>注册的所有人:     Security<br>注册的组织:       暂缺<br>产品 ID:          <span class="hljs-number">00329</span><span class="hljs-literal">-10331</span><span class="hljs-literal">-44210</span><span class="hljs-literal">-AA707</span><br>初始安装日期:     <span class="hljs-number">2020</span>/<span class="hljs-number">9</span>/<span class="hljs-number">25</span>, <span class="hljs-number">17</span>:<span class="hljs-number">37</span>:<span class="hljs-number">05</span><br>系统启动时间:     <span class="hljs-number">2021</span>/<span class="hljs-number">2</span>/<span class="hljs-number">14</span>, <span class="hljs-number">2</span>:<span class="hljs-number">39</span>:<span class="hljs-number">21</span><br>系统制造商:       HUAWEI<br>系统型号:         HLYL<span class="hljs-literal">-WXX9</span><br>系统类型:         x64<span class="hljs-literal">-based</span> PC<br>处理器:           安装了 <span class="hljs-number">1</span> 个处理器。<br>                  [<span class="hljs-number">01</span>]: AMD64 Family <span class="hljs-number">23</span> Model <span class="hljs-number">96</span> Stepping <span class="hljs-number">1</span> AuthenticAMD ~<span class="hljs-number">3000</span> Mhz<br>BIOS 版本:        HUAWEI <span class="hljs-number">1.06</span>, <span class="hljs-number">2020</span>/<span class="hljs-number">10</span>/<span class="hljs-number">12</span><br>Windows 目录:     C:\WINDOWS<br>系统目录:         C:\WINDOWS\system32<br>启动设备:         \Device\HarddiskVolume1<br>系统区域设置:     zh<span class="hljs-literal">-cn</span>;中文(中国)<br>输入法区域设置:   zh<span class="hljs-literal">-cn</span>;中文(中国)<br>时区:             (UTC+<span class="hljs-number">08</span>:<span class="hljs-number">00</span>) 北京，重庆，香港特别行政区，乌鲁木齐<br>......<br></code></pre></td></tr></table></figure><h2 id="0x0001-wmic"><a href="#0x0001-wmic" class="headerlink" title="0x0001 wmic"></a>0x0001 wmic</h2><h3 id="描述-1"><a href="#描述-1" class="headerlink" title="描述"></a>描述</h3><p>查看硬件的信息</p><h3 id="使用帮助-1"><a href="#使用帮助-1" class="headerlink" title="使用帮助"></a>使用帮助</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs powershell">C:\Users\Security&gt;wmic /?<br><br>WMIC 已弃用。<br><br>[全局开关] &lt;命令&gt;<br><br>可以使用以下全局开关:<br>/NAMESPACE           别名在其上操作的命名空间的路径。<br>/ROLE                包含别名定义的角色的路径。<br>/NODE                别名在其上操作的服务器。<br>/IMPLEVEL            客户端模拟级别。<br>/AUTHLEVEL           客户端身份验证级别。<br>/LOCALE              客户端应使用的语言 ID。<br>/PRIVILEGES          启用或禁用所有权限。<br>/TRACE               将调试信息输出到 stderr。<br>/RECORD              记录所有输入命令和输出内容。<br>/INTERACTIVE         设置或重置交互模式。<br>/FAILFAST            设置或重置 FailFast 模式。<br>/USER                会话期间要使用的用户。<br>/PASSWORD            登录会话时要使用的密码。<br>/OUTPUT              指定输出重定向模式。<br>/APPEND              指定输出重定向模式。<br>/AGGREGATE           设置或重置聚合模式。<br>/AUTHORITY           指定连接的 &lt;授权类型&gt;。<br>/?[:&lt;<span class="hljs-type">BRIEF</span>|<span class="hljs-type">FULL</span>&gt;]    用法信息。<br><br>有关特定全局开关的详细信息，请键入: <span class="hljs-built_in">switch-name</span> /?<br></code></pre></td></tr></table></figure><h3 id="使用示例-1"><a href="#使用示例-1" class="headerlink" title="使用示例"></a>使用示例</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><br>例：wmic logicaldisk  // 查看计算机上各个盘的相关信息<br>例：wmic LogicalDisk <span class="hljs-built_in">where</span> <span class="hljs-string">&quot;Caption=&#x27;C:&#x27;&quot;</span> get FreeSpace,Size /value  // 获取C盘的剩余空间大小与总大小（单位：Byte）<br>例：wmic os get Caption,InstallDate,OSArchitecture /value // 获取当前os的Caption、安装日期以及系统架构信息<br><br>wmic查看进程信息<br>例：wmic <span class="hljs-keyword">process</span> <span class="hljs-built_in">where</span> Caption=<span class="hljs-string">&quot;buyticket.exe&quot;</span> get commandline,ExecutablePath,ProcessId,ThreadCount /value<br>// 查看名为<span class="hljs-string">&quot;buyticket.exe&quot;</span>所有进程命令行，exe全路径，PID及线程数<br><br>例：wmic <span class="hljs-keyword">process</span> <span class="hljs-built_in">where</span> Caption=<span class="hljs-string">&quot;buyticket.exe&quot;</span> get ExecutablePath,HandleCount /value  <br>// 查看名为<span class="hljs-string">&quot;buyticket.exe&quot;</span>所有进程的exe全路径及当前打开的句柄数<br><br>例：wmic <span class="hljs-keyword">process</span> <span class="hljs-built_in">where</span> Caption=<span class="hljs-string">&quot;buyticket.exe&quot;</span> get ExecutablePath,VirtualSize,WorkingSetSize /value  <br>// 查看名为<span class="hljs-string">&quot;buyticket.exe&quot;</span>所有进程的exe全路径、当前虚拟地址空间占用及物理内存工作集<br></code></pre></td></tr></table></figure><h2 id="0x0002-shutdown"><a href="#0x0002-shutdown" class="headerlink" title="0x0002 shutdown"></a>0x0002 shutdown</h2><h3 id="描述-2"><a href="#描述-2" class="headerlink" title="描述"></a>描述</h3><p>关闭、重启、注销、休眠计算机</p><h3 id="使用帮助-2"><a href="#使用帮助-2" class="headerlink" title="使用帮助"></a>使用帮助</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs powershell">C:\Users\Security&gt;shutdown /?<br>用法: shutdown [/<span class="hljs-type">i</span> | /<span class="hljs-type">l</span> | /<span class="hljs-type">s</span> | /<span class="hljs-type">sg</span> | /<span class="hljs-type">r</span> | /<span class="hljs-type">g</span> | /<span class="hljs-type">a</span> | /<span class="hljs-type">p</span> | /<span class="hljs-type">h</span> | /<span class="hljs-type">e</span> | /<span class="hljs-type">o</span>] [/<span class="hljs-type">hybrid</span>] [/<span class="hljs-type">soft</span>] [/<span class="hljs-type">fw</span>] [/<span class="hljs-type">f</span>]<br>    [/<span class="hljs-type">m</span> \\<span class="hljs-type">computer</span>][/<span class="hljs-type">t</span> <span class="hljs-type">xxx</span>][/<span class="hljs-type">d</span> [<span class="hljs-type">p</span>|<span class="hljs-type">u</span>:]<span class="hljs-type">xx</span>:<span class="hljs-type">yy</span> [/<span class="hljs-type">c</span> <span class="hljs-string">&quot;comment&quot;</span>]]<br><br>    没有参数   显示帮助。这与键入 /? 是一样的。<br>    /?         显示帮助。这与不键入任何选项是一样的。<br>    /i         显示图形用户界面(GUI)。<br>               这必须是第一个选项。<br>    /l         注销。这不能与 /m 或 /d 选项一起使用。<br>    /s         关闭计算机。<br>    /sg        关闭计算机。在下一次启动时，如果启用了<br>               自动重启登录，则将自动登录并锁定上次交互用户。<br>               登录后，重启任何已注册的应用程序。<br>    /<span class="hljs-built_in">r</span>         完全关闭并重启计算机。<br>    /g         完全关闭并重启计算机。重新启动系统后，<br>               如果启用了自动重启登录，则将自动登录并<br>               锁定上次交互用户。<br>               登录后，重启任何已注册的应用程序。<br>    /a         中止系统关闭。<br>               这只能在超时期间使用。<br>               与 /<span class="hljs-built_in">fw</span> 结合使用，以清除任何未完成的至固件的引导。<br>    /p         关闭本地计算机，没有超时或警告。<br>               可以与 /d 和 /f 选项一起使用。<br>    /<span class="hljs-built_in">h</span>         休眠本地计算机。<br>               可以与 /f 选项一起使用。<br>    /hybrid    执行计算机关闭并进行准备以快速启动。<br>               必须与 /s 选项一起使用。<br>    /<span class="hljs-built_in">fw</span>        与关闭选项结合使用，使下次启动转到<br>               固件用户界面。<br>    /e         记录计算机意外关闭的原因。<br>    /o         转到高级启动选项菜单并重新启动计算机。<br>               必须与 /<span class="hljs-built_in">r</span> 选项一起使用。<br>    /m \\computer 指定目标计算机。<br>    /t xxx     将关闭前的超时时间设置为 xxx 秒。<br>               有效范围是 <span class="hljs-number">0</span><span class="hljs-literal">-315360000</span> (<span class="hljs-number">10</span> 年)，默认值为 <span class="hljs-number">30</span>。<br>               如果超时时间大于 <span class="hljs-number">0</span>，则默示为<br>               /f 参数。<br>    /c <span class="hljs-string">&quot;comment&quot;</span> 有关重新启动或关闭的原因的注释。<br>               最多允许 <span class="hljs-number">512</span> 个字符。<br>    /f         强制关闭正在运行的应用程序而不事先警告用户。<br>               如果为 /t 参数指定大于 <span class="hljs-number">0</span> 的值，<br>               则默示为 /f 参数。<br>    /d [<span class="hljs-type">p</span>|<span class="hljs-type">u</span>:]xx:yy  提供重新启动或关闭的原因。<br>               p 指示重启或关闭是计划内的。<br>               u 指示原因是用户定义的。<br>               如果未指定 p 也未指定 u，则重新启动或关闭<br>               是计划外的。<br>               xx 是主要原因编号(小于 <span class="hljs-number">256</span> 的正整数)。<br>               yy 是次要原因编号(小于 <span class="hljs-number">65536</span> 的正整数)。<br><br></code></pre></td></tr></table></figure><h3 id="使用示例-2"><a href="#使用示例-2" class="headerlink" title="使用示例"></a>使用示例</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs powershell">shutdown /s                   <span class="hljs-comment"># 关闭计算机</span><br>shutdown /s /t <span class="hljs-number">3600</span>           <span class="hljs-comment"># 一小时后，关闭本地计算机</span><br>shutdown /a                   <span class="hljs-comment"># 终止系统关闭</span><br>shutdown /<span class="hljs-built_in">r</span>                   <span class="hljs-comment"># 关闭并重启本地计算机</span><br>shutdown /m <span class="hljs-number">192.168</span>.<span class="hljs-number">1.166</span> /<span class="hljs-built_in">r</span>  <span class="hljs-comment"># 关闭并重启ip为192.168.1.166的计算机</span><br></code></pre></td></tr></table></figure><h1 id="二、进程相关"><a href="#二、进程相关" class="headerlink" title="二、进程相关"></a>二、进程相关</h1><h2 id="0x0100-schtasks"><a href="#0x0100-schtasks" class="headerlink" title="0x0100 schtasks"></a>0x0100 schtasks</h2><h3 id="描述-3"><a href="#描述-3" class="headerlink" title="描述"></a>描述</h3><p>任务计划</p><p>使用帮助</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-built_in">PS</span> C:\Users\Security&gt; schtasks /?<br><br>SCHTASKS /<span class="hljs-keyword">parameter</span> [<span class="hljs-type">arguments</span>]<br><br>描述:<br>    允许管理员创建、删除、查询、更改、运行和中止本地或远程系统上的计划任<br>    务。<br><br>参数列表:<br>    /Create         创建新计划任务。<br><br>    /Delete         删除计划任务。<br><br>    /Query          显示所有计划任务。<br><br>    /Change         更改计划任务属性。<br><br>    /Run            按需运行计划任务。<br><br>    /<span class="hljs-keyword">End</span>            中止当前正在运行的计划任务。<br><br>    /ShowSid        显示与计划的任务名称相应的安全标识符。<br><br>    /?              显示此帮助消息。<br></code></pre></td></tr></table></figure><h3 id="使用示例-3"><a href="#使用示例-3" class="headerlink" title="使用示例"></a>使用示例</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><br></code></pre></td></tr></table></figure><h2 id="0x0101-tasklist"><a href="#0x0101-tasklist" class="headerlink" title="0x0101 tasklist"></a>0x0101 tasklist</h2><h3 id="描述-4"><a href="#描述-4" class="headerlink" title="描述"></a>描述</h3><p>tasklist     // 显示当前运行的进程信息（可查看PID）</p><h3 id="使用帮助-3"><a href="#使用帮助-3" class="headerlink" title="使用帮助"></a>使用帮助</h3> <figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell">tasklist // 显示当前运行的进程信息（可查看PID）<br></code></pre></td></tr></table></figure><h3 id="使用示例-4"><a href="#使用示例-4" class="headerlink" title="使用示例"></a>使用示例</h3> <figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><br></code></pre></td></tr></table></figure><h2 id="0x0102-taskkill"><a href="#0x0102-taskkill" class="headerlink" title="0x0102 taskkill"></a>0x0102 taskkill</h2><h3 id="描述-5"><a href="#描述-5" class="headerlink" title="描述"></a>描述</h3><p>结束指定的进程</p><h3 id="使用帮助-4"><a href="#使用帮助-4" class="headerlink" title="使用帮助"></a>使用帮助</h3>  <figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell">taskkill // 结束指定的进程<br></code></pre></td></tr></table></figure><h3 id="使用示例-5"><a href="#使用示例-5" class="headerlink" title="使用示例"></a>使用示例</h3>  <figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><br></code></pre></td></tr></table></figure><h1 id="三、安全相关"><a href="#三、安全相关" class="headerlink" title="三、安全相关"></a>三、安全相关</h1><h2 id="0x0200-reg"><a href="#0x0200-reg" class="headerlink" title="0x0200 reg"></a>0x0200 reg</h2><h3 id="描述-6"><a href="#描述-6" class="headerlink" title="描述"></a>描述</h3><p>reg 注册表操作命令</p><h3 id="使用帮助-5"><a href="#使用帮助-5" class="headerlink" title="使用帮助"></a>使用帮助</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell">reg 注册表相关操作<br></code></pre></td></tr></table></figure><h3 id="使用示例-6"><a href="#使用示例-6" class="headerlink" title="使用示例"></a>使用示例</h3><h1 id="四、网络通信"><a href="#四、网络通信" class="headerlink" title="四、网络通信"></a>四、网络通信</h1><h2 id="0x0300-net"><a href="#0x0300-net" class="headerlink" title="0x0300 net"></a>0x0300 net</h2><h3 id="描述-7"><a href="#描述-7" class="headerlink" title="描述"></a>描述</h3><h3 id="使用帮助-6"><a href="#使用帮助-6" class="headerlink" title="使用帮助"></a>使用帮助</h3> <figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs powershell">net <span class="hljs-built_in">start</span> // 查看已经启动的服务<br>net <span class="hljs-built_in">start</span> <span class="hljs-string">&quot;Task Scheduler&quot;</span>  // 开启任务计划服务<br>net stop <span class="hljs-string">&quot;Task Scheduler&quot;</span>  // 关闭任务计划服务<br></code></pre></td></tr></table></figure><h3 id="使用示例-7"><a href="#使用示例-7" class="headerlink" title="使用示例"></a>使用示例</h3> <figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><br></code></pre></td></tr></table></figure><h2 id="0x0301-Ping"><a href="#0x0301-Ping" class="headerlink" title="0x0301 Ping"></a>0x0301 Ping</h2><h3 id="描述-8"><a href="#描述-8" class="headerlink" title="描述"></a>描述</h3><p>Ping：网络连通性测试</p><h3 id="使用帮助-7"><a href="#使用帮助-7" class="headerlink" title="使用帮助"></a>使用帮助</h3> <figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-built_in">PS</span> C:\Users\Security&gt; ping /?<br><br>用法: ping [-<span class="hljs-type">t</span>] [-<span class="hljs-type">a</span>] [-<span class="hljs-type">n</span> <span class="hljs-type">count</span>] [-<span class="hljs-type">l</span> <span class="hljs-type">size</span>] [-<span class="hljs-type">f</span>] [-<span class="hljs-type">i</span> <span class="hljs-type">TTL</span>] [-<span class="hljs-type">v</span> <span class="hljs-type">TOS</span>]<br>            [-<span class="hljs-type">r</span> <span class="hljs-type">count</span>] [-<span class="hljs-type">s</span> <span class="hljs-type">count</span>] [[-<span class="hljs-type">j</span> <span class="hljs-type">host</span>-<span class="hljs-type">list</span>] | [-<span class="hljs-type">k</span> <span class="hljs-type">host</span>-<span class="hljs-type">list</span>]]<br>            [-<span class="hljs-type">w</span> <span class="hljs-type">timeout</span>] [-<span class="hljs-type">R</span>] [-<span class="hljs-type">S</span> <span class="hljs-type">srcaddr</span>] [-<span class="hljs-type">c</span> <span class="hljs-type">compartment</span>] [-<span class="hljs-type">p</span>]<br>            [-<span class="hljs-number">4</span>] [-<span class="hljs-number">6</span>] target_name<br><br>选项:<br>    <span class="hljs-literal">-t</span>             Ping 指定的主机，直到停止。<br>                   若要查看统计信息并继续操作，请键入 Ctrl+<span class="hljs-keyword">Break</span>；<br>                   若要停止，请键入 Ctrl+C。<br>    <span class="hljs-literal">-a</span>             将地址解析为主机名。<br>    <span class="hljs-literal">-n</span> count       要发送的回显请求数。<br>    <span class="hljs-literal">-l</span> size        发送缓冲区大小。<br>    <span class="hljs-operator">-f</span>             在数据包中设置“不分段”标记(仅适用于 IPv4)。<br>    <span class="hljs-literal">-i</span> TTL         生存时间。<br>    <span class="hljs-literal">-v</span> TOS         服务类型(仅适用于 IPv4。该设置已被弃用，<br>                   对 IP 标头中的服务类型字段没有任何<br>                   影响)。<br>    <span class="hljs-literal">-r</span> count       记录计数跃点的路由(仅适用于 IPv4)。<br>    <span class="hljs-literal">-s</span> count       计数跃点的时间戳(仅适用于 IPv4)。<br>    <span class="hljs-literal">-j</span> host<span class="hljs-literal">-list</span>   与主机列表一起使用的松散源路由(仅适用于 IPv4)。<br>    <span class="hljs-literal">-k</span> host<span class="hljs-literal">-list</span>    与主机列表一起使用的严格源路由(仅适用于 IPv4)。<br>    <span class="hljs-literal">-w</span> timeout     等待每次回复的超时时间(毫秒)。<br>    <span class="hljs-literal">-R</span>             同样使用路由标头测试反向路由(仅适用于 IPv6)。<br>                   根据 RFC <span class="hljs-number">5095</span>，已弃用此路由标头。<br>                   如果使用此标头，某些系统可能丢弃<br>                   回显请求。<br>    <span class="hljs-literal">-S</span> srcaddr     要使用的源地址。<br>    <span class="hljs-literal">-c</span> compartment 路由隔离舱标识符。<br>    <span class="hljs-literal">-p</span>             Ping Hyper<span class="hljs-literal">-V</span> 网络虚拟化提供程序地址。<br>    <span class="hljs-literal">-4</span>             强制使用 IPv4。<br>    <span class="hljs-literal">-6</span>             强制使用 IPv6。<br><br></code></pre></td></tr></table></figure><h3 id="使用示例-8"><a href="#使用示例-8" class="headerlink" title="使用示例"></a>使用示例</h3><h2 id="0x0302-nslookup"><a href="#0x0302-nslookup" class="headerlink" title="0x0302 nslookup"></a>0x0302 nslookup</h2><h3 id="描述-9"><a href="#描述-9" class="headerlink" title="描述"></a>描述</h3><p>nslookup：域名解析</p><h3 id="使用帮助-8"><a href="#使用帮助-8" class="headerlink" title="使用帮助"></a>使用帮助</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-built_in">PS</span> C:\Users\Security&gt; nslookup /?<br>用法:<br>   nslookup [-<span class="hljs-type">opt</span> <span class="hljs-type">...</span>]             <span class="hljs-comment"># 使用默认服务器的交互模式</span><br>   nslookup [-<span class="hljs-type">opt</span> <span class="hljs-type">...</span>] - server    <span class="hljs-comment"># 使用 &quot;server&quot; 的交互模式</span><br>   nslookup [-<span class="hljs-type">opt</span> <span class="hljs-type">...</span>] host        <span class="hljs-comment"># 仅查找使用默认服务器的 &quot;host&quot;</span><br>   nslookup [-<span class="hljs-type">opt</span> <span class="hljs-type">...</span>] host server <span class="hljs-comment"># 仅查找使用 &quot;server&quot; 的 &quot;host&quot;</span><br><br>   nslookup <span class="hljs-literal">-d</span> www.domain.com    <span class="hljs-comment"># 打印出www.cnblogs.com的域名解析所有记录</span><br></code></pre></td></tr></table></figure><h3 id="使用示例-9"><a href="#使用示例-9" class="headerlink" title="使用示例"></a>使用示例</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><br></code></pre></td></tr></table></figure><h2 id="0x0303-netstat"><a href="#0x0303-netstat" class="headerlink" title="0x0303 netstat"></a>0x0303 netstat</h2><h3 id="描述-10"><a href="#描述-10" class="headerlink" title="描述"></a>描述</h3><p>显示协议统计信息和当前 TCP/IP 网络连接。</p><h3 id="使用示例-10"><a href="#使用示例-10" class="headerlink" title="使用示例"></a>使用示例</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs powershell">C:\Users\Security&gt;netstat /?<br><br>显示协议统计信息和当前 TCP/IP 网络连接。<br><br>NETSTAT [-<span class="hljs-type">a</span>] [-<span class="hljs-type">b</span>] [-<span class="hljs-type">e</span>] [-<span class="hljs-type">f</span>] [-<span class="hljs-type">n</span>] [-<span class="hljs-type">o</span>] [-<span class="hljs-type">p</span> <span class="hljs-type">proto</span>] [-<span class="hljs-type">r</span>] [-<span class="hljs-type">s</span>] [-<span class="hljs-type">t</span>] [-<span class="hljs-type">x</span>] [-<span class="hljs-type">y</span>] [<span class="hljs-built_in">int</span><span class="hljs-type">erval</span>]<br><br>  <span class="hljs-literal">-a</span>            显示所有连接和侦听端口。<br>  <span class="hljs-literal">-b</span>            显示在创建每个连接或侦听端口时涉及的<br>                可执行文件。在某些情况下，已知可执行文件托管<br>                多个独立的组件，此时会<br>                显示创建连接或侦听端口时<br>                涉及的组件序列。在此情况下，可执行文件的<br>                名称位于底部 [] 中，它调用的组件位于顶部，<br>                直至达到 TCP/IP。注意，此选项<br>                可能很耗时，并且可能因为你没有足够的<br>                权限而失败。<br>  <span class="hljs-literal">-e</span>            显示以太网统计信息。此选项可以与 <span class="hljs-literal">-s</span> 选项<br>                结合使用。<br>  <span class="hljs-operator">-f</span>            显示外部地址的完全限定<br>                域名(FQDN)。<br>  <span class="hljs-literal">-n</span>            以数字形式显示地址和端口号。<br>  <span class="hljs-literal">-o</span>            显示拥有的与每个连接关联的进程 ID。<br>  <span class="hljs-literal">-p</span> proto      显示 proto 指定的协议的连接；proto<br>                可以是下列任何一个: TCP、UDP、TCPv6 或 UDPv6。如果与 <span class="hljs-literal">-s</span><br>                选项一起用来显示每个协议的统计信息，proto 可以是下列任何一个:<br>                IP、IPv6、ICMP、ICMPv6、TCP、TCPv6、UDP 或 UDPv6。<br>  <span class="hljs-literal">-q</span>            显示所有连接、侦听端口和绑定的<br>                非侦听 TCP 端口。绑定的非侦听端口<br>                不一定与活动连接相关联。<br>  <span class="hljs-literal">-r</span>            显示路由表。<br>  <span class="hljs-literal">-s</span>            显示每个协议的统计信息。默认情况下，<br>                显示 IP、IPv6、ICMP、ICMPv6、TCP、TCPv6、UDP 和 UDPv6 的统计信息；<br>                <span class="hljs-literal">-p</span> 选项可用于指定默认的子网。<br>  <span class="hljs-literal">-t</span>            显示当前连接卸载状态。<br>  <span class="hljs-literal">-x</span>            显示 NetworkDirect 连接、侦听器和共享<br>                终结点。<br>  <span class="hljs-literal">-y</span>            显示所有连接的 TCP 连接模板。<br>                无法与其他选项结合使用。<br>  interval      重新显示选定的统计信息，各个显示间暂停的<br>                间隔秒数。按 CTRL+C 停止重新显示<br>                统计信息。如果省略，则 netstat 将打印当前的<br>                配置信息一次。<br></code></pre></td></tr></table></figure><h3 id="使用帮助-9"><a href="#使用帮助-9" class="headerlink" title="使用帮助"></a>使用帮助</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs powershell">netstat <span class="hljs-literal">-a</span>  // 查看开启了哪些端口<br>netstat <span class="hljs-literal">-n</span> // 查看端口的网络连接情况<br>netstat <span class="hljs-literal">-v</span>  // 查看正在进行的工作<br>netstat <span class="hljs-literal">-p</span> tcp // 查看tcp协议的使用情况<br></code></pre></td></tr></table></figure><h1 id="X、杂七杂八"><a href="#X、杂七杂八" class="headerlink" title="X、杂七杂八"></a>X、杂七杂八</h1><h2 id="特殊符号命令"><a href="#特殊符号命令" class="headerlink" title="特殊符号命令"></a>特殊符号命令</h2><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs powershell">&amp;  顺序执行多条命令，而不管命令是否执行成功<br>&amp;&amp;  顺序执行多条命令，当碰到执行出错的命令后将不执行后面的命令<br>||  顺序执行多条命令，当碰到执行正确的命令后将不执行后面的命令<br>|  管道命令<br></code></pre></td></tr></table></figure><h2 id="中断命令执行"><a href="#中断命令执行" class="headerlink" title="中断命令执行"></a>中断命令执行</h2><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell">Ctrl + Z<br></code></pre></td></tr></table></figure><h2 id="目录查看"><a href="#目录查看" class="headerlink" title="目录查看"></a>目录查看</h2><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-built_in">cd</span>  切换目录<br><span class="hljs-built_in">dir</span> 显示目录中的内容<br>tree 显示目录结构<br></code></pre></td></tr></table></figure><h2 id="文件查看"><a href="#文件查看" class="headerlink" title="文件查看"></a>文件查看</h2> <figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-built_in">type</span> 显示文本文件内容<br>more 逐屏的显示文本文件内容<br>findstr 文件中搜索字符串<br></code></pre></td></tr></table></figure><h2 id="注销登录：logoff"><a href="#注销登录：logoff" class="headerlink" title="注销登录：logoff"></a>注销登录：logoff</h2><h3 id="描述-11"><a href="#描述-11" class="headerlink" title="描述"></a>描述</h3><p>终止会话。</p><h3 id="使用帮助-10"><a href="#使用帮助-10" class="headerlink" title="使用帮助"></a>使用帮助</h3> <figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-built_in">PS</span> C:\Users\Security&gt; logoff /?<br>终止会话。<br><br>LOGOFF [<span class="hljs-type">sessionname</span> | <span class="hljs-type">sessionid</span>] [/<span class="hljs-type">SERVER</span>:<span class="hljs-type">servername</span>] [/<span class="hljs-type">V</span>] [/<span class="hljs-type">VM</span>]<br><br>  sessionname         会话名。<br>  sessionid           会话 ID。<br>  /SERVER:servername  指定含有要注销的用户会话的远程桌面服务器<br>                      (默认值是当前值)。<br>  /V                  显示有关所执行操作的信息。<br>  /VM                 注销服务器上或虚拟机中的会话。需要指定该会话的唯一 ID。<br></code></pre></td></tr></table></figure><h3 id="使用示例-11"><a href="#使用示例-11" class="headerlink" title="使用示例"></a>使用示例</h3> <figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell">没有......<br></code></pre></td></tr></table></figure><h2 id="系统信息"><a href="#系统信息" class="headerlink" title="系统信息"></a>系统信息</h2> <figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs powershell">ver             显示当前windows系统的版本号<br>winver     弹框显示当前windows系统信息<br>vol             显示当前分区的卷标<br>label           显示当前分区的卷标，同时提示输入新卷标<br>label c:system 设置c盘的卷标为system<br>time            显示或设置当前时间<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>杂记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Windows</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
